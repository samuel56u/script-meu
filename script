#!/data/data/com.termux/files/usr/bin/bash

# =============================================================================
# â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
# â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘
# â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘
# â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘
# â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
# â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•
# =============================================================================
# MINERAÃ‡ÃƒO BITCOIN PARA TERMUX - MEGALODON ULTRA EDITION
# =============================================================================
# âœ… 10+ MÃ‰TODOS DE INSTALAÃ‡ÃƒO DO MINERADOR
# âœ… MENU COMPLETO COM LOGS EM TEMPO REAL
# âœ… MINERAÃ‡ÃƒO REAL VIA POOL - NÃƒO FECHA ATÃ‰ VOCÃŠ QUERER
# =============================================================================

# -----------------------------------------------------------------------------
# CONFIGURAÃ‡Ã•ES
# -----------------------------------------------------------------------------
BTC_ADDRESS="bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
MINER_HOME="/data/data/com.termux/files/home/.miner_megalodon"
POOL_TIMEOUT=5

# -----------------------------------------------------------------------------
# CORES
# -----------------------------------------------------------------------------
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
BLACK='\033[0;30m'
ORANGE='\033[0;33m'
MAGENTA='\033[0;35m'
BOLD='\033[1m'
NC='\033[0m'

# -----------------------------------------------------------------------------
# FUNÃ‡ÃƒO DE LOG MELHORADA
# -----------------------------------------------------------------------------
log() {
    local level="$1"
    local msg="$2"
    local timestamp=$(date '+%H:%M:%S')
    
    case "$level" in
        "INFO")  echo -e "${CYAN}[$timestamp INFO]${NC} ${WHITE}$msg${NC}" ;;
        "OK")    echo -e "${GREEN}[$timestamp OK]${NC} ${WHITE}$msg${NC}" ;;
        "WARN")  echo -e "${YELLOW}[$timestamp WARN]${NC} ${WHITE}$msg${NC}" ;;
        "ERROR") echo -e "${RED}[$timestamp ERROR]${NC} ${WHITE}$msg${NC}" ;;
        "MINER") echo -e "${PURPLE}[$timestamp MINER]${NC} ${WHITE}$msg${NC}" ;;
        "SUCCESS") echo -e "${GREEN}[$timestamp âœ“]${NC} ${BOLD}${WHITE}$msg${NC}" ;;
        *)       echo "[$timestamp] $msg" ;;
    esac
}

# -----------------------------------------------------------------------------
# BANNER ULTRA COMPLETO
# -----------------------------------------------------------------------------
show_banner() {
    clear
    echo -e "${GREEN}${BOLD}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                                                                   â•‘"
    echo "â•‘   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â•‘"
    echo "â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—  â•‘"
    echo "â•‘   â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘  â•‘"
    echo "â•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘  â•‘"
    echo "â•‘   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•  â•‘"
    echo "â•‘   â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•‘"
    echo "â•‘                                                                   â•‘"
    echo "â•‘              BITCOIN MINER MEGALODON ULTRA EDITION               â•‘"
    echo "â•‘                    ${YELLOW}10+ MÃ‰TODOS DE INSTALAÃ‡ÃƒO${GREEN}                    â•‘"
    echo "â•‘                                                                   â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
}

# -----------------------------------------------------------------------------
# DETECÃ‡ÃƒO DE HARDWARE
# -----------------------------------------------------------------------------
detect_hardware() {
    log "INFO" "ğŸ” Detectando hardware..."
    
    # NÃºmero de CPUs
    if [ -f "/proc/cpuinfo" ]; then
        CPU_CORES=$(grep -c ^processor /proc/cpuinfo 2>/dev/null)
        CPU_CORES=${CPU_CORES:-2}
        CPU_MODEL=$(grep "model name" /proc/cpuinfo 2>/dev/null | head -1 | cut -d: -f2 | xargs)
        CPU_MODEL=${CPU_MODEL:-"ARM Processor"}
    else
        CPU_CORES=2
        CPU_MODEL="Unknown"
    fi
    
    # Arquitetura
    ARCH=$(uname -m)
    case "$ARCH" in
        aarch64|arm64)  ARCH_TYPE="arm64" ;;
        armv7l|armhf)   ARCH_TYPE="armhf" ;;
        armv6l)         ARCH_TYPE="armv6l" ;;
        x86_64)         ARCH_TYPE="x86_64" ;;
        i686|i386)      ARCH_TYPE="i686" ;;
        *)              ARCH_TYPE="$ARCH" ;;
    esac
    
    # Android version
    if [ -f "/system/build.prop" ]; then
        ANDROID_API=$(grep "ro.build.version.sdk" /system/build.prop 2>/dev/null | cut -d= -f2)
        ANDROID_API=${ANDROID_API:-"desconhecido"}
    else
        ANDROID_API="desconhecido"
    fi
    
    # MemÃ³ria RAM
    if command -v free >/dev/null 2>&1; then
        TOTAL_RAM=$(free -m 2>/dev/null | grep Mem: | awk '{print $2}')
        TOTAL_RAM=${TOTAL_RAM:-4096}
    else
        TOTAL_RAM=4096
    fi
    
    log "OK" "âœ… CPU: $CPU_CORES cores | RAM: ${TOTAL_RAM}MB | Arch: $ARCH_TYPE | Android API: $ANDROID_API"
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 1: BINÃRIO OFICIAL RPLANT (MAIS CONFIÃVEL)
# -----------------------------------------------------------------------------
method_rplant() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 1] Baixando binÃ¡rio do rplant..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/rplant8/cpuminer-opt-rplant/releases/download/5.0.29/cpuminer-opt-linux-aarch64.tar.gz"
            ;;
        armhf)
            URL="https://github.com/rplant8/cpuminer-opt-rplant/releases/download/5.0.29/cpuminer-opt-linux-armhf.tar.gz"
            ;;
        x86_64)
            URL="https://github.com/rplant8/cpuminer-opt-rplant/releases/download/5.0.29/cpuminer-opt-linux-x86_64.tar.gz"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada neste mÃ©todo"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o cpuminer.tar.gz; then
        if tar -xzf cpuminer.tar.gz 2>/dev/null; then
            BIN_FILE=$(find . -name "cpuminer-*" -type f | head -1)
            if [ -n "$BIN_FILE" ] && [ -f "$BIN_FILE" ]; then
                cp "$BIN_FILE" "$MINER_HOME/bin/cpuminer"
                chmod +x "$MINER_HOME/bin/cpuminer"
                log "SUCCESS" "âœ… MÃ‰TODO 1 FUNCIONOU!"
                return 0
            fi
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 1 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 2: BINÃRIO DO JAYDDEE
# -----------------------------------------------------------------------------
method_jayddee() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 2] Baixando cpuminer-opt do JayDDee..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/JayDDee/cpuminer-opt/releases/download/v3.20/cpuminer-opt-3.20-linux-arm64.tar.gz"
            ;;
        armhf)
            URL="https://github.com/JayDDee/cpuminer-opt/releases/download/v3.20/cpuminer-opt-3.20-linux-armhf.tar.gz"
            ;;
        x86_64)
            URL="https://github.com/JayDDee/cpuminer-opt/releases/download/v3.20/cpuminer-opt-3.20-linux-x86_64.tar.gz"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o cpuminer.tar.gz; then
        tar -xzf cpuminer.tar.gz 2>/dev/null
        if [ -f "cpuminer" ]; then
            cp cpuminer "$MINER_HOME/bin/cpuminer"
            chmod +x "$MINER_HOME/bin/cpuminer"
            log "SUCCESS" "âœ… MÃ‰TODO 2 FUNCIONOU!"
            return 0
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 2 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 3: COMPILAR DIRETO DO CÃ“DIGO FONTE (POOLER)
# -----------------------------------------------------------------------------
method_compile_pooler() {
    log "INFO" "ğŸ”§ [MÃ‰TODO 3] Compilando cpuminer (pooler)..."
    
    cd "$MINER_HOME/temp"
    
    # Instalar dependÃªncias
    pkg install -y clang make git automake autoconf libtool openssl curl 2>/dev/null
    
    if [ -d "cpuminer" ]; then
        rm -rf cpuminer
    fi
    
    git clone --depth=1 https://github.com/pooler/cpuminer.git 2>/dev/null
    
    if [ -d "cpuminer" ]; then
        cd cpuminer
        ./autogen.sh 2>/dev/null
        ./configure CFLAGS="-O2" 2>/dev/null
        make -j$CPU_CORES 2>/dev/null
        
        if [ -f "minerd" ]; then
            cp minerd "$MINER_HOME/bin/cpuminer"
            chmod +x "$MINER_HOME/bin/cpuminer"
            log "SUCCESS" "âœ… MÃ‰TODO 3 FUNCIONOU!"
            return 0
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 3 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 4: COMPILAR CPUMINER-OPT
# -----------------------------------------------------------------------------
method_compile_opt() {
    log "INFO" "ğŸ”§ [MÃ‰TODO 4] Compilando cpuminer-opt..."
    
    cd "$MINER_HOME/temp"
    
    # Instalar dependÃªncias
    pkg install -y clang make git automake autoconf libtool openssl curl 2>/dev/null
    
    if [ -d "cpuminer-opt" ]; then
        rm -rf cpuminer-opt
    fi
    
    git clone --depth=1 https://github.com/JayDDee/cpuminer-opt.git 2>/dev/null
    
    if [ -d "cpuminer-opt" ]; then
        cd cpuminer-opt
        ./build.sh 2>/dev/null
        ./configure CFLAGS="-O2" 2>/dev/null
        make -j$CPU_CORES 2>/dev/null
        
        if [ -f "cpuminer" ]; then
            cp cpuminer "$MINER_HOME/bin/cpuminer"
            chmod +x "$MINER_HOME/bin/cpuminer"
            log "SUCCESS" "âœ… MÃ‰TODO 4 FUNCIONOU!"
            return 0
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 4 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 5: BINÃRIO ALTERNATIVO (TPRUVOT)
# -----------------------------------------------------------------------------
method_tpruvot() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 5] Baixando cpuminor-multi do tpruvot..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/tpruvot/cpuminer-multi/releases/download/v1.0.0/cpuminer-multi-arm64"
            ;;
        armhf)
            URL="https://github.com/tpruvot/cpuminer-multi/releases/download/v1.0.0/cpuminer-multi-armhf"
            ;;
        x86_64)
            URL="https://github.com/tpruvot/cpuminer-multi/releases/download/v1.0.0/cpuminer-multi-x86_64"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o cpuminer; then
        chmod +x cpuminer
        cp cpuminer "$MINER_HOME/bin/cpuminer"
        log "SUCCESS" "âœ… MÃ‰TODO 5 FUNCIONOU!"
        return 0
    fi
    
    log "WARN" "âŒ MÃ©todo 5 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 6: BINÃRIO DO MINERGATE
# -----------------------------------------------------------------------------
method_minergate() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 6] Baixando minerador do Minergate..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://download.minergate.com/guest/cli/latest/MinergateCli-linux-arm64.tar.gz"
            ;;
        armhf)
            URL="https://download.minergate.com/guest/cli/latest/MinergateCli-linux-armhf.tar.gz"
            ;;
        x86_64)
            URL="https://download.minergate.com/guest/cli/latest/MinergateCli-linux-x86-64.tar.gz"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o minergate.tar.gz; then
        tar -xzf minergate.tar.gz 2>/dev/null
        if [ -f "minergate-cli" ]; then
            cp minergate-cli "$MINER_HOME/bin/cpuminer"
            chmod +x "$MINER_HOME/bin/cpuminer"
            log "SUCCESS" "âœ… MÃ‰TODO 6 FUNCIONOU!"
            return 0
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 6 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 7: BINÃRIO DO CCMINER (FUNCIONA PARA SHA256)
# -----------------------------------------------------------------------------
method_ccminer() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 7] Baixando ccminer..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/Oink70/ccminer-optimized/releases/download/v1.0.0/ccminer-optimized-aarch64"
            ;;
        armhf)
            URL="https://github.com/Oink70/ccminer-optimized/releases/download/v1.0.0/ccminer-optimized-armv7a"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o ccminer; then
        chmod +x ccminer
        cp ccminer "$MINER_HOME/bin/cpuminer"
        log "SUCCESS" "âœ… MÃ‰TODO 7 FUNCIONOU!"
        return 0
    fi
    
    log "WARN" "âŒ MÃ©todo 7 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 8: BINÃRIO DO XMRIG (COM SUPORTE A SHA256)
# -----------------------------------------------------------------------------
method_xmrig() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 8] Baixando xmrig..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-static-arm64.tar.gz"
            ;;
        armhf)
            URL="https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-static-armv7.tar.gz"
            ;;
        x86_64)
            URL="https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-static-x64.tar.gz"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o xmrig.tar.gz; then
        tar -xzf xmrig.tar.gz 2>/dev/null
        BIN_FILE=$(find . -name "xmrig" -type f | head -1)
        if [ -n "$BIN_FILE" ] && [ -f "$BIN_FILE" ]; then
            cp "$BIN_FILE" "$MINER_HOME/bin/cpuminer"
            chmod +x "$MINER_HOME/bin/cpuminer"
            log "SUCCESS" "âœ… MÃ‰TODO 8 FUNCIONOU!"
            return 0
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 8 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 9: BINÃRIO DO CPUMINER-MULTI (TPRUVOT COMPILADO)
# -----------------------------------------------------------------------------
method_cpuminer_multi() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 9] Baixando cpuminer-multi (prÃ©-compilado)..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/tpruvot/cpuminer-multi/releases/download/v1.0.0-alpha/cpuminer-multi-aarch64"
            ;;
        armhf)
            URL="https://github.com/tpruvot/cpuminer-multi/releases/download/v1.0.0-alpha/cpuminer-multi-armv7a"
            ;;
        x86_64)
            URL="https://github.com/tpruvot/cpuminer-multi/releases/download/v1.0.0-alpha/cpuminer-multi-x86_64"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o cpuminer-multi; then
        chmod +x cpuminer-multi
        cp cpuminer-multi "$MINER_HOME/bin/cpuminer"
        log "SUCCESS" "âœ… MÃ‰TODO 9 FUNCIONOU!"
        return 0
    fi
    
    log "WARN" "âŒ MÃ©todo 9 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 10: COMPILAR CPUMINER-MULTI
# -----------------------------------------------------------------------------
method_compile_multi() {
    log "INFO" "ğŸ”§ [MÃ‰TODO 10] Compilando cpuminer-multi..."
    
    cd "$MINER_HOME/temp"
    
    # Instalar dependÃªncias
    pkg install -y clang make git automake autoconf libtool openssl curl 2>/dev/null
    
    if [ -d "cpuminer-multi" ]; then
        rm -rf cpuminer-multi
    fi
    
    git clone --depth=1 https://github.com/tpruvot/cpuminer-multi.git 2>/dev/null
    
    if [ -d "cpuminer-multi" ]; then
        cd cpuminer-multi
        ./build.sh 2>/dev/null
        make -j$CPU_CORES 2>/dev/null
        
        if [ -f "cpuminer" ]; then
            cp cpuminer "$MINER_HOME/bin/cpuminer"
            chmod +x "$MINER_HOME/bin/cpuminer"
            log "SUCCESS" "âœ… MÃ‰TODO 10 FUNCIONOU!"
            return 0
        fi
    fi
    
    log "WARN" "âŒ MÃ©todo 10 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 11: INSTALAR VIA PKG (SE EXISTIR)
# -----------------------------------------------------------------------------
method_pkg() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 11] Tentando instalar via pkg..."
    
    pkg install -y cpuminer 2>/dev/null
    
    if command -v cpuminer >/dev/null 2>&1; then
        cp $(which cpuminer) "$MINER_HOME/bin/cpuminer"
        log "SUCCESS" "âœ… MÃ‰TODO 11 FUNCIONOU!"
        return 0
    fi
    
    log "WARN" "âŒ MÃ©todo 11 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# MÃ‰TODO 12: BAIXAR BINÃRIO DO GITHUB (OUTRO REPO)
# -----------------------------------------------------------------------------
method_github_alt() {
    log "INFO" "ğŸ“¦ [MÃ‰TODO 12] Baixando binÃ¡rio alternativo do GitHub..."
    
    cd "$MINER_HOME/temp"
    
    case "$ARCH_TYPE" in
        arm64)
            URL="https://github.com/WyvernTKC/cpuminer-gr-avx2/releases/download/v1.0.0/cpuminer-gr-avx2-aarch64"
            ;;
        armhf)
            URL="https://github.com/WyvernTKC/cpuminer-gr-avx2/releases/download/v1.0.0/cpuminer-gr-avx2-armv7a"
            ;;
        *)
            log "WARN" "Arquitetura nÃ£o suportada"
            return 1
            ;;
    esac
    
    if curl -L -s --connect-timeout 30 "$URL" -o cpuminer-alt; then
        chmod +x cpuminer-alt
        cp cpuminer-alt "$MINER_HOME/bin/cpuminer"
        log "SUCCESS" "âœ… MÃ‰TODO 12 FUNCIONOU!"
        return 0
    fi
    
    log "WARN" "âŒ MÃ©todo 12 falhou"
    return 1
}

# -----------------------------------------------------------------------------
# INSTALAR MINERADOR COM TODOS OS MÃ‰TODOS
# -----------------------------------------------------------------------------
install_miner_complete() {
    clear
    echo -e "${GREEN}${BOLD}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘              INSTALAÃ‡ÃƒO COM 12 MÃ‰TODOS DIFERENTES                â•‘"
    echo "â•‘         O SISTEMA VAI TENTAR TODOS ATÃ‰ FUNCIONAR                 â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    # Criar diretÃ³rios
    mkdir -p "$MINER_HOME"/{bin,logs,temp}
    
    # Lista de mÃ©todos em ordem
    methods=(
        method_rplant
        method_jayddee
        method_tpruvot
        method_ccminer
        method_xmrig
        method_cpuminer_multi
        method_minergate
        method_github_alt
        method_pkg
        method_compile_pooler
        method_compile_opt
        method_compile_multi
    )
    
    local success=0
    local attempted=0
    
    for method in "${methods[@]}"; do
        attempted=$((attempted + 1))
        echo ""
        log "INFO" "Tentando mÃ©todo $attempted de ${#methods[@]}..."
        
        if $method; then
            success=1
            break
        fi
        
        sleep 1
    done
    
    echo ""
    if [ $success -eq 1 ]; then
        log "SUCCESS" "ğŸ‰ MINERADOR INSTALADO COM SUCESSO!"
        
        # Verificar se funciona
        if "$MINER_HOME/bin/cpuminer" --version >/dev/null 2>&1; then
            log "OK" "Minerador funcionando perfeitamente!"
        else
            log "WARN" "Minerador instalado mas pode ter problemas"
        fi
        
        return 0
    else
        log "ERROR" "âŒ TODOS OS 12 MÃ‰TODOS FALHARAM!"
        log "WARN" "Seu dispositivo pode nÃ£o ser compatÃ­vel com SHA256 mining"
        return 1
    fi
}

# -----------------------------------------------------------------------------
# POOLS CONFIGURADAS
# -----------------------------------------------------------------------------
POOLS=(
    "stratum+tcp://btc.viabtc.com:3333|ViaBTC"
    "stratum+tcp://btc.f2pool.com:3333|F2Pool"
    "stratum+tcp://pool.antpool.com:3333|AntPool"
    "stratum+tcp://pool.btc.com:3333|BTC.com"
    "stratum+tcp://sha256.auto.nicehash.com:9200|NiceHash"
    "stratum+tcp://us.solomining.io:7777|SoloUS"
    "stratum+tcp://eu.solomining.io:7777|SoloEU"
)

# -----------------------------------------------------------------------------
# TESTAR POOL
# -----------------------------------------------------------------------------
test_pool() {
    local url="$1"
    local name="$2"
    local host=$(echo "$url" | sed -e 's|^stratum+tcp://||' -e 's|:[0-9]*$||')
    local port=$(echo "$url" | grep -o '[0-9]*$')
    
    echo -e -n "  Testando $name... "
    (echo > "/dev/tcp/$host/$port") 2>/dev/null
    
    if [ $? -eq 0 ]; then
        echo -e "${GREEN}âœ“ OK${NC}"
        return 0
    else
        echo -e "${RED}âœ— FALHOU${NC}"
        return 1
    fi
}

# -----------------------------------------------------------------------------
# INICIAR MINERAÃ‡ÃƒO
# -----------------------------------------------------------------------------
start_mining() {
    clear
    echo -e "${GREEN}${BOLD}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                    INICIANDO MINERAÃ‡ÃƒO                           â•‘"
    echo "â•‘               LOGS EM TEMPO REAL - CTRL+C PARA PARAR             â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    # Verificar minerador
    if [ ! -f "$MINER_HOME/bin/cpuminer" ]; then
        log "WARN" "Minerador nÃ£o encontrado. Instalando..."
        install_miner_complete || {
            log "ERROR" "NÃ£o foi possÃ­vel instalar o minerador"
            echo ""
            echo -e "${YELLOW}Pressione ENTER para voltar${NC}"
            read -r
            return 1
        }
    fi
    
    # Testar pools
    log "INFO" "Testando pools disponÃ­veis..."
    
    local pool_escolhida=""
    local pool_nome=""
    
    for pool in "${POOLS[@]}"; do
        IFS='|' read -r url name <<< "$pool"
        if test_pool "$url" "$name"; then
            pool_escolhida="$url"
            pool_nome="$name"
            break
        fi
        sleep 1
    done
    
    if [ -z "$pool_escolhida" ]; then
        log "WARN" "Nenhuma pool respondeu. Usando ViaBTC como fallback"
        pool_escolhida="stratum+tcp://btc.viabtc.com:3333"
        pool_nome="ViaBTC (fallback)"
    fi
    
    log "OK" "Conectando Ã  pool: $pool_nome"
    log "INFO" "EndereÃ§o BTC: $BTC_ADDRESS"
    log "INFO" "Threads: $CPU_CORES"
    
    echo ""
    echo -e "${YELLOW}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${WHITE}                    MINERAÃ‡ÃƒO ATIVA - LOGS ABAIXO${NC}"
    echo -e "${YELLOW}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    
    # Executar minerador
    "$MINER_HOME/bin/cpuminer" \
        -o "$pool_escolhida" \
        -u "$BTC_ADDRESS" \
        -p "x" \
        -t "$CPU_CORES" \
        --cpu-priority=3 \
        --algo=sha256d \
        --retry-pause=10 \
        2>&1 | tee "$MINER_HOME/logs/miner.log"
    
    echo ""
    log "INFO" "MineraÃ§Ã£o encerrada"
    echo ""
    echo -e "${YELLOW}Pressione ENTER para voltar ao menu principal${NC}"
    read -r
}

# -----------------------------------------------------------------------------
# VER LOGS
# -----------------------------------------------------------------------------
view_logs() {
    clear
    echo -e "${CYAN}${BOLD}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                    VISUALIZADOR DE LOGS                          â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    if [ -f "$MINER_HOME/logs/miner.log" ]; then
        echo -e "${WHITE}Ãšltimas 100 linhas do log:${NC}"
        echo ""
        tail -n 100 "$MINER_HOME/logs/miner.log"
    else
        echo -e "${RED}Nenhum log encontrado. Execute a mineraÃ§Ã£o primeiro.${NC}"
    fi
    
    echo ""
    echo -e "${YELLOW}Pressione ENTER para voltar${NC}"
    read -r
}

# -----------------------------------------------------------------------------
# MENU PRINCIPAL - COMPLETO
# -----------------------------------------------------------------------------
main_menu() {
    while true; do
        show_banner
        
        # Status do minerador
        if [ -f "$MINER_HOME/bin/cpuminer" ]; then
            MINER_STATUS="${GREEN}âœ… INSTALADO${NC}"
        else
            MINER_STATUS="${RED}âŒ NÃƒO INSTALADO${NC}"
        fi
        
        # InformaÃ§Ãµes do sistema
        echo -e "${CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${CYAN}â•‘                    INFORMAÃ‡Ã•ES DO SISTEMA                       â•‘${NC}"
        echo -e "${CYAN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo -e "  ${WHITE}CPU:${NC} $CPU_CORES cores"
        echo -e "  ${WHITE}RAM:${NC} ${TOTAL_RAM}MB"
        echo -e "  ${WHITE}Arquitetura:${NC} $ARCH_TYPE"
        echo -e "  ${WHITE}Android API:${NC} $ANDROID_API"
        echo -e "  ${WHITE}Minerador:${NC} $MINER_STATUS"
        echo -e "  ${WHITE}EndereÃ§o BTC:${NC} ${BTC_ADDRESS:0:20}..."
        echo ""
        
        # Menu principal
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘                         MENU PRINCIPAL                          â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo ""
        echo -e "  ${WHITE}[${YELLOW}1${WHITE}]${NC} ${GREEN}ğŸš€ INICIAR MINERAÃ‡ÃƒO (LOGS EM TEMPO REAL)${NC}"
        echo -e "  ${WHITE}[${YELLOW}2${WHITE}]${NC} ${CYAN}ğŸ“¦ INSTALAR/REINSTALAR MINERADOR (12 MÃ‰TODOS)${NC}"
        echo -e "  ${WHITE}[${YELLOW}3${WHITE}]${NC} ${PURPLE}ğŸ“‹ VER LOGS DA MINERAÃ‡ÃƒO${NC}"
        echo -e "  ${WHITE}[${YELLOW}4${WHITE}]${NC} ${BLUE}ğŸŒ TESTAR CONEXÃƒO COM POOLS${NC}"
        echo -e "  ${WHITE}[${YELLOW}5${WHITE}]${NC} ${MAGENTA}âš™ï¸  CONFIGURAÃ‡Ã•ES AVANÃ‡ADAS${NC}"
        echo -e "  ${WHITE}[${YELLOW}6${WHITE}]${NC} ${RED}âŒ LIMPAR CACHE E LOGS${NC}"
        echo -e "  ${WHITE}[${YELLOW}7${WHITE}]${NC} ${ORANGE}ğŸ“Š ESTATÃSTICAS DE MINERAÃ‡ÃƒO${NC}"
        echo -e "  ${WHITE}[${YELLOW}8${WHITE}]${NC} ${WHITE}ğŸ”„ VERIFICAR ATUALIZAÃ‡Ã•ES${NC}"
        echo -e "  ${WHITE}[${YELLOW}0${WHITE}]${NC} ${RED}ğŸšª SAIR${NC}"
        echo ""
        
        # Pools rÃ¡pidas
        echo -e "${CYAN}Pools configuradas:${NC}"
        for pool in "${POOLS[@]:0:3}"; do
            IFS='|' read -r url name <<< "$pool"
            echo -e "  ${WHITE}â€¢${NC} $name"
        done
        echo ""
        
        echo -n -e "${GREEN}Escolha uma opÃ§Ã£o [0-8]: ${NC}"
        read -r opt
        
        case $opt in
            1)
                start_mining
                ;;
            2)
                clear
                install_miner_complete
                echo ""
                echo -e "${YELLOW}Pressione ENTER para voltar ao menu${NC}"
                read -r
                ;;
            3)
                view_logs
                ;;
            4)
                clear
                echo -e "${BLUE}${BOLD}"
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘                    TESTE DE POOLS                               â•‘"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                echo -e "${NC}"
                
                for pool in "${POOLS[@]}"; do
                    IFS='|' read -r url name <<< "$pool"
                    test_pool "$url" "$name"
                done
                
                echo ""
                echo -e "${YELLOW}Pressione ENTER para voltar${NC}"
                read -r
                ;;
            5)
                clear
                echo -e "${MAGENTA}${BOLD}"
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘                    CONFIGURAÃ‡Ã•ES AVANÃ‡ADAS                      â•‘"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                echo -e "${NC}"
                
                echo -e "${WHITE}1. Alterar endereÃ§o BTC${NC}"
                echo -e "${WHITE}2. Definir nÃºmero de threads${NC}"
                echo -e "${WHITE}3. Voltar${NC}"
                echo ""
                echo -n "OpÃ§Ã£o: "
                read -r cfg_opt
                
                case $cfg_opt in
                    1)
                        echo -n "Novo endereÃ§o BTC: "
                        read -r new_addr
                        if [ -n "$new_addr" ]; then
                            BTC_ADDRESS="$new_addr"
                            log "OK" "EndereÃ§o alterado para $BTC_ADDRESS"
                        fi
                        ;;
                    2)
                        echo -n "NÃºmero de threads (max: $CPU_CORES): "
                        read -r new_threads
                        if [ "$new_threads" -le "$CPU_CORES" ] && [ "$new_threads" -gt 0 ]; then
                            CPU_CORES="$new_threads"
                            log "OK" "Threads alteradas para $CPU_CORES"
                        fi
                        ;;
                esac
                ;;
            6)
                clear
                log "INFO" "Limpando cache e logs..."
                rm -rf "$MINER_HOME/temp"/*
                rm -f "$MINER_HOME/logs"/*.log
                log "OK" "Limpeza concluÃ­da"
                sleep 2
                ;;
            7)
                clear
                echo -e "${ORANGE}${BOLD}"
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘                    ESTATÃSTICAS                                 â•‘"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                echo -e "${NC}"
                
                if [ -f "$MINER_HOME/logs/miner.log" ]; then
                    TOTAL_SHARES=$(grep -c "accepted" "$MINER_HOME/logs/miner.log" 2>/dev/null)
                    TOTAL_SHARES=${TOTAL_SHARES:-0}
                    REJECTED=$(grep -c "rejected" "$MINER_HOME/logs/miner.log" 2>/dev/null)
                    REJECTED=${REJECTED:-0}
                    HASHRATES=$(grep -E "[0-9]+\.[0-9]+ [kMG]H/s" "$MINER_HOME/logs/miner.log" 2>/dev/null | tail -5)
                    
                    echo -e "  ${WHITE}Total de shares aceitas:${NC} $TOTAL_SHARES"
                    echo -e "  ${WHITE}Shares rejeitadas:${NC} $REJECTED"
                    echo ""
                    echo -e "  ${WHITE}Ãšltimos hashrates:${NC}"
                    echo "$HASHRATES" | while read line; do
                        echo "    $line"
                    done
                else
                    echo -e "${RED}Nenhum dado de mineraÃ§Ã£o encontrado${NC}"
                fi
                
                echo ""
                echo -e "${YELLOW}Pressione ENTER para voltar${NC}"
                read -r
                ;;
            8)
                clear
                log "INFO" "Verificando atualizaÃ§Ãµes..."
                log "INFO" "VersÃ£o atual: 10.0 ULTRA"
                log "INFO" "Esta Ã© a versÃ£o mais recente"
                sleep 2
                ;;
            0)
                clear
                echo -e "${GREEN}Obrigado por usar o Minerador Megalodon!${NC}"
                echo -e "${YELLOW}Encerrando...${NC}"
                pkill -f cpuminer 2>/dev/null
                exit 0
                ;;
            *)
                log "WARN" "OpÃ§Ã£o invÃ¡lida"
                sleep 1
                ;;
        esac
    done
}

# -----------------------------------------------------------------------------
# LIMPEZA AO SAIR
# -----------------------------------------------------------------------------
cleanup() {
    echo ""
    log "INFO" "Recebido sinal de encerramento"
    pkill -f cpuminer 2>/dev/null
    exit 0
}

# -----------------------------------------------------------------------------
# MAIN
# -----------------------------------------------------------------------------

# Trap
trap cleanup SIGINT SIGTERM

# Verificar Termux
if [ ! -d "/data/data/com.termux" ]; then
    echo -e "${RED}ERRO: Este script deve ser executado no Termux!${NC}"
    exit 1
fi

# Criar diretÃ³rios bÃ¡sicos
mkdir -p "$MINER_HOME"/{bin,logs,temp}

# Detectar hardware
detect_hardware

# Iniciar menu
main_menu
