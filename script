#!/data/data/com.termux/files/usr/bin/bash

# ============================================================================
# NICEHASH MINER TERMUX - ULTIMATE GOD MODE
# ============================================================================
# SISTEMA COMPLETO COM SUA CARTEIRA NICEHASH + WEBHOOK DISCORD
# ============================================================================

clear
echo ""
echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—"
echo "â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘"
echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘"
echo "â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘"
echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘"
echo "â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•"
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                 NICEHASH MINER TERMUX - ULTIMATE GOD MODE                   â•‘"
echo "â•‘           Sistema Completo com Sua Carteira NiceHash Integrada             â•‘"
echo "â•‘                  Pagamentos Diretos para sua Carteira                      â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "âœ… CONFIGURAÃ‡ÃƒO DETECTADA:"
echo "   ğŸ‘› Carteira: bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
echo "   ğŸ“¨ Webhook: Configurado para seu Discord"
echo "   âš¡ Sistema: NiceHash Ultimate"
echo ""
echo "================================================================================"
echo ""

# ============================================================================
# CONFIGURAÃ‡ÃƒO DO SISTEMA
# ============================================================================

# SUAS CONFIGURAÃ‡Ã•ES PESSOAIS
export YOUR_NICEHASH_WALLET="bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
export YOUR_DISCORD_WEBHOOK="https://discord.com/api/webhooks/1470009252063088661/1j4kNu2sDcGQmFCywnbd_p1BEbb1DTcN_VXt5OYpX8_FsQI2YKB3tCjS2Okp_msUX9Mh"

# InformaÃ§Ãµes do Sistema
export SYSTEM_VERSION="3.0.0"
export SYSTEM_NAME="NiceHash Miner Ultimate"
export SYSTEM_BUILD="$(date +%Y%m%d%H%M%S)"
export START_TIME=$(date +%s)

# DiretÃ³rios do Sistema
export MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner"
export MINER_BIN="$MINER_ROOT/bin"
export MINER_CONFIG="$MINER_ROOT/config"
export MINER_LOGS="$MINER_ROOT/logs"
export MINER_STATS="$MINER_ROOT/stats"
export MINER_SCRIPTS="$MINER_ROOT/scripts"
export MINER_TEMP="$MINER_ROOT/temp"
export MINER_BACKUP="$MINER_ROOT/backup"

# ConfiguraÃ§Ãµes de Hardware
export CPU_THREADS=$(($(nproc 2>/dev/null || echo 1) - 1))
[ $CPU_THREADS -lt 1 ] && CPU_THREADS=1
export CPU_PRIORITY=5
export CPU_MAX=95

# Pools NiceHash (Todas as regiÃµes)
export POOLS_NICEHASH=(
    # RandomX (Monero) - Pagamento em BTC
    "randomxmonero.auto.nicehash.com:9200"
    "randomxmonero.eu.nicehash.com:9200"
    "randomxmonero.usa.nicehash.com:9200"
    "randomxmonero.br.nicehash.com:9200"
    "randomxmonero.jp.nicehash.com:9200"
    
    # KawPow (Ravencoin) - Pagamento em BTC
    "kawpow.auto.nicehash.com:9200"
    "kawpow.eu.nicehash.com:9200"
    "kawpow.usa.nicehash.com:9200"
    
    # Etchash (Ethereum Classic) - Pagamento em BTC
    "etchash.auto.nicehash.com:9200"
    "etchash.eu.nicehash.com:9200"
    "etchash.usa.nicehash.com:9200"
    
    # Octopus (Conflux) - Pagamento em BTC
    "octopus.auto.nicehash.com:9200"
    "octopus.eu.nicehash.com:9200"
    
    # Autolykos2 (Ergo) - Pagamento em BTC
    "autolykos2.auto.nicehash.com:9200"
)

# ============================================================================
# SISTEMA DE CORES
# ============================================================================

NC='\033[0m'
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
ORANGE='\033[38;5;208m'
LIME='\033[38;5;154m'
GOLD='\033[38;5;220m'
PINK='\033[38;5;213m'
TEAL='\033[38;5;123m'

# Cores temÃ¡ticas
COLOR_TITLE="${PURPLE}${BOLD}"
COLOR_SATOSHI="${GOLD}${BOLD}"
COLOR_BITCOIN="${YELLOW}${BOLD}"
COLOR_HASHRATE="${LIME}${BOLD}"
COLOR_TEMP="${ORANGE}${BOLD}"
COLOR_PROFIT="${GREEN}${BOLD}"
COLOR_ERROR="${RED}${BOLD}"
COLOR_WARNING="${YELLOW}${BOLD}"
COLOR_SUCCESS="${GREEN}${BOLD}"
COLOR_INFO="${CYAN}${BOLD}"
COLOR_MENU="${BLUE}${BOLD}"
COLOR_TIME="${WHITE}"
COLOR_NICEHASH="${TEAL}${BOLD}"

# ============================================================================
# SISTEMA DE LOGS ULTRA DETALHADO
# ============================================================================

init_log_system() {
    mkdir -p "$MINER_LOGS"
    
    # Criar arquivos de log categorizados
    touch "$MINER_LOGS/system_master.log"
    touch "$MINER_LOGS/mining_detailed.log"
    touch "$MINER_LOGS/bitcoin_earnings.log"
    touch "$MINER_LOGS/hashrate_history.log"
    touch "$MINER_LOGS/temperature_log.log"
    touch "$MINER_LOGS/shares_accepted.log"
    touch "$MINER_LOGS/shares_rejected.log"
    touch "$MINER_LOGS/pool_connections.log"
    touch "$MINER_LOGS/error_detailed.log"
    touch "$MINER_LOGS/discord_notifications.log"
    touch "$MINER_LOGS/cpu_usage.log"
    touch "$MINER_LOGS/memory_usage.log"
    touch "$MINER_LOGS/network_stats.log"
    touch "$MINER_LOGS/session_summary.log"
    touch "$MINER_LOGS/daily_profit.log"
    touch "$MINER_LOGS/hourly_profit.log"
    touch "$MINER_LOGS/minute_by_minute.log"
    touch "$MINER_LOGS/satoshi_per_minute.log"
    touch "$MINER_LOGS/worker_performance.log"
    touch "$MINER_LOGS/algorithm_stats.log"
}

log_system() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [SYSTEM] $1"
    echo "$log_entry" >> "$MINER_LOGS/system_master.log"
    echo -e "${COLOR_INFO}[SYSTEM]${NC} $1"
}

log_mining() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [MINING] $1"
    echo "$log_entry" >> "$MINER_LOGS/mining_detailed.log"
    echo "$log_entry" >> "$MINER_LOGS/minute_by_minute.log"
    echo -e "${COLOR_NICEHASH}[MINING]${NC} $1"
}

log_bitcoin() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [BITCOIN] $1"
    echo "$log_entry" >> "$MINER_LOGS/bitcoin_earnings.log"
    echo "$log_entry" >> "$MINER_LOGS/daily_profit.log"
    echo -e "${COLOR_BITCOIN}[BITCOIN]${NC} $1"
}

log_hashrate() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [HASHRATE] $1"
    echo "$log_entry" >> "$MINER_LOGS/hashrate_history.log"
    echo -e "${COLOR_HASHRATE}[HASHRATE]${NC} $1"
}

log_temperature() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [TEMP] $1"
    echo "$log_entry" >> "$MINER_LOGS/temperature_log.log"
    echo -e "${COLOR_TEMP}[TEMP]${NC} $1"
}

log_share() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [SHARE] $1"
    echo "$log_entry" >> "$MINER_LOGS/shares_accepted.log"
    echo -e "${COLOR_SUCCESS}[SHARE]${NC} $1"
}

log_error() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [ERROR] $1"
    echo "$log_entry" >> "$MINER_LOGS/error_detailed.log"
    echo -e "${COLOR_ERROR}[ERROR]${NC} $1"
}

log_success() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [SUCCESS] $1"
    echo "$log_entry" >> "$MINER_LOGS/system_master.log"
    echo -e "${COLOR_SUCCESS}[SUCCESS]${NC} $1"
}

log_warning() {
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    local log_entry="${timestamp} [WARNING] $1"
    echo "$log_entry" >> "$MINER_LOGS/system_master.log"
    echo -e "${COLOR_WARNING}[WARNING]${NC} $1"
}

# LOG DETALHADO DE SATOSHIS (APARECE SEMPRE QUE MINERA)
log_satoshi_detailed() {
    local satoshis="$1"
    local hashrate="$2"
    local temperature="$3"
    local total_sats="$4"
    local usd_per_hour="$5"
    local algorithm="$6"
    
    local timestamp="$(date '+%H:%M:%S')"
    
    # Log para arquivo detalhado
    echo "========================================" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "TIMESTAMP: $timestamp" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "SATOSHIS: $satoshis" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "HASHRATE: $hashrate H/s" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "TEMPERATURE: ${temperature}Â°C" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "ALGORITHM: $algorithm" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "TOTAL SATS: $total_sats" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "USD/HOUR: \$$usd_per_hour" >> "$MINER_LOGS/satoshi_per_minute.log"
    echo "========================================" >> "$MINER_LOGS/satoshi_per_minute.log"
    
    # Log para arquivo de resumo
    echo "$(date '+%Y-%m-%d %H:%M:%S'),$satoshis,$hashrate,$temperature,$algorithm,$total_sats,$usd_per_hour" >> "$MINER_LOGS/daily_profit.log"
    
    # Exibir na tela (formato igual Ã  sua imagem)
    echo -e "${COLOR_SATOSHI}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                    ğŸ“Š SATOSHI MINERADOS                         â•‘"
    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "â•‘                                                                  â•‘"
    echo "â•‘  Hora: ${timestamp}                                             â•‘"
    echo "â•‘  Hashrate Atual: ${hashrate} H/s                                â•‘"
    echo "â•‘  Temperatura: ${temperature}Â°C                                  â•‘"
    echo "â•‘  Satoshis Minerados: ${satoshis} sats                           â•‘"
    echo "â•‘  Algoritmo: ${algorithm}                                        â•‘"
    echo "â•‘                                                                  â•‘"
    echo "â•‘  Total Acumulado: ${total_sats} satoshis                       â•‘"
    echo "â•‘  Estimativa USD/hora: \$${usd_per_hour}                         â•‘"
    echo "â•‘                                                                  â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    # Log para console tambÃ©m
    log_bitcoin "ğŸ’° ${satoshis} satoshis minerados via ${algorithm} | ${hashrate} H/s | ${temperature}Â°C"
}

# ============================================================================
# SISTEMA DE DISCORD ULTRA DETALHADO
# ============================================================================

discord_send() {
    local message="$1"
    local color="$2"
    local title="$3"
    local fields="$4"
    
    if [ -z "$YOUR_DISCORD_WEBHOOK" ] || [ "$YOUR_DISCORD_WEBHOOK" = "" ]; then
        log_warning "Webhook do Discord nÃ£o configurado"
        return 1
    fi
    
    # Log local da notificaÃ§Ã£o
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S')]"
    echo "${timestamp} [DISCORD] ${title}: ${message}" >> "$MINER_LOGS/discord_notifications.log"
    
    # Limitar tamanho da mensagem
    message=$(echo "$message" | cut -c1-1900)
    
    # Construir JSON payload
    local json_payload=$(cat << EOF
{
  "embeds": [{
    "title": "$title",
    "description": "$message",
    "color": $color,
    "timestamp": "$(date -u +'%Y-%m-%dT%H:%M:%S.000Z')",
    "footer": {
      "text": "NiceHash Miner Ultimate â€¢ $(date '+%H:%M:%S')"
    }
  }]
}
EOF
    )
    
    # Enviar para Discord
    local response=$(curl -s -w "%{http_code}" -o /tmp/discord_response.txt \
        -H "Content-Type: application/json" \
        -X POST \
        -d "$json_payload" \
        "$YOUR_DISCORD_WEBHOOK" 2>/dev/null)
    
    if [ "$response" -eq 204 ] || [ "$response" -eq 200 ]; then
        log_success "NotificaÃ§Ã£o enviada para Discord: $title"
        return 0
    else
        log_error "Falha ao enviar para Discord (HTTP $response)"
        return 1
    fi
}

# NotificaÃ§Ã£o de inÃ­cio de mineraÃ§Ã£o
discord_mining_start() {
    local worker_name="$1"
    local algorithm="$2"
    discord_send "ğŸš€ **MINERAÃ‡ÃƒO INICIADA NA NICEHASH!**\n\n**Worker:** $worker_name\n**Carteira:** ${YOUR_NICEHASH_WALLET:0:12}...\n**Algoritmo:** $algorithm\n**Threads:** $CPU_THREADS\n**Prioridade:** $CPU_PRIORITY" "3066993" "ğŸš€ MINERAÃ‡ÃƒO INICIADA"
}

# NotificaÃ§Ã£o de satoshi minerado
discord_satoshi_notification() {
    local satoshis="$1"
    local hashrate="$2"
    local temperature="$3"
    local total_sats="$4"
    local usd_per_hour="$5"
    local algorithm="$6"
    
    discord_send "ğŸ’° **SATOSHI MINERADO!**\n\n**Quantidade:** ${satoshis} satoshis\n**Hashrate:** ${hashrate} H/s\n**Temperatura:** ${temperature}Â°C\n**Algoritmo:** ${algorithm}\n**Total Acumulado:** ${total_sats} satoshis\n**USD/Hora:** \$${usd_per_hour}\n\n*SerÃ¡ depositado na sua carteira NiceHash*" "16753920" "ğŸ’° SATOSHI MINERADO"
}

# NotificaÃ§Ã£o de share aceito
discord_share_notification() {
    local share_num="$1"
    local difficulty="$2"
    local hashrate="$3"
    discord_send "âœ… **SHARE ACEITO NA NICEHASH!**\n\n**Share #:** ${share_num}\n**Dificuldade:** ${difficulty}\n**Hashrate:** ${hashrate} H/s\n\n*Contribuindo para seus ganhos em Bitcoin*" "5763719" "âœ… SHARE ACEITO"
}

# NotificaÃ§Ã£o de erro
discord_error_notification() {
    local error_msg="$1"
    discord_send "âŒ **ERRO NO SISTEMA!**\n\n**Detalhes:**\n\`\`\`$error_msg\`\`\`" "15158332" "âŒ ERRO NO SISTEMA"
}

# NotificaÃ§Ã£o de mudanÃ§a de pool
discord_pool_change() {
    local old_pool="$1"
    local new_pool="$2"
    discord_send "ğŸ”„ **POOL ALTERADA!**\n\n**De:** $old_pool\n**Para:** $new_pool\n\n*Otimizando conexÃ£o para melhor lucratividade*" "3447003" "ğŸ”„ POOL ALTERADA"
}

# RelatÃ³rio horÃ¡rio
discord_hourly_report() {
    local sats_this_hour="$1"
    local shares_this_hour="$2"
    local avg_hashrate="$3"
    local avg_temp="$4"
    
    discord_send "â° **RELATÃ“RIO POR HORA**\n\n**Satoshis (Ãºltima hora):** ${sats_this_hour} sats\n**Shares (Ãºltima hora):** ${shares_this_hour}\n**Hashrate MÃ©dio:** ${avg_hashrate} H/s\n**Temperatura MÃ©dia:** ${avg_temp}Â°C\n\n*Continuando mineraÃ§Ã£o...*" "2123412" "â° RELATÃ“RIO POR HORA"
}

# RelatÃ³rio diÃ¡rio
discord_daily_report() {
    local total_sats="$1"
    local total_shares="$2"
    local total_hours="$3"
    local estimated_btc="$4"
    local estimated_usd="$5"
    
    discord_send "ğŸ“ˆ **RELATÃ“RIO DIÃRIO**\n\n**Satoshis Minerados:** ${total_sats} sats\n**Shares Aceitos:** ${total_shares}\n**Tempo Ativo:** ${total_hours} horas\n**BTC Estimado:** ${estimated_btc} BTC\n**USD Estimado:** \$${estimated_usd}\n\n*Pagamento serÃ¡ feito para: ${YOUR_NICEHASH_WALLET:0:12}...*" "15844367" "ğŸ“ˆ RELATÃ“RIO DIÃRIO"
}

# ============================================================================
# INSTALAÃ‡ÃƒO DO XMRIG (30 MÃ‰TODOS DIFERENTES)
# ============================================================================

install_xmrig_complete() {
    log_system "Iniciando instalaÃ§Ã£o do XMRig (30 mÃ©todos disponÃ­veis)..."
    
    mkdir -p "$MINER_TEMP"
    cd "$MINER_TEMP"
    
    # Tentar todos os mÃ©todos atÃ© um funcionar
    local method_success=false
    
    # MÃ©todo 1: GitHub Release oficial (ARM64)
    log_system "MÃ©todo 1: GitHub Release ARM64"
    if wget -q --timeout=30 --tries=3 "https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz" -O xmrig_1.tar.gz; then
        if extract_and_install xmrig_1.tar.gz; then
            method_success=true
            log_success "Instalado via MÃ©todo 1 (GitHub ARM64)"
        fi
    fi
    
    # MÃ©todo 2: GitHub Release (ARMHF)
    if [ "$method_success" = false ]; then
        log_system "MÃ©todo 2: GitHub Release ARMHF"
        if wget -q --timeout=30 --tries=3 "https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-armhf.tar.gz" -O xmrig_2.tar.gz; then
            if extract_and_install xmrig_2.tar.gz; then
                method_success=true
                log_success "Instalado via MÃ©todo 2 (GitHub ARMHF)"
            fi
        fi
    fi
    
    # MÃ©todo 3: GitHub Latest API
    if [ "$method_success" = false ]; then
        log_system "MÃ©todo 3: GitHub Latest API"
        local latest_url=$(curl -s https://api.github.com/repos/xmrig/xmrig/releases/latest 2>/dev/null | grep -o "https://.*linux-static-arm64.tar.gz" | head -1)
        if [ -n "$latest_url" ]; then
            if wget -q --timeout=30 --tries=3 "$latest_url" -O xmrig_3.tar.gz; then
                if extract_and_install xmrig_3.tar.gz; then
                    method_success=true
                    log_success "Instalado via MÃ©todo 3 (GitHub Latest)"
                fi
            fi
        fi
    fi
    
    # MÃ©todo 4-30: VÃ¡rios mirrors e mÃ©todos alternativos
    local mirrors=(
        "https://xmrig.com/download/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://mirror.ghproxy.com/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://download.fastgit.org/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://kgithub.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://hub.fastgit.xyz/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://github.91chi.fun/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.20.0/xmrig-6.20.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.19.0/xmrig-6.19.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.18.0/xmrig-6.18.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.17.0/xmrig-6.17.0-linux-arm64.tar.gz"
    )
    
    local method_num=4
    for mirror in "${mirrors[@]}"; do
        if [ "$method_success" = false ]; then
            log_system "MÃ©todo $method_num: Mirror alternativo"
            if wget -q --timeout=30 --tries=3 "$mirror" -O "xmrig_${method_num}.tar.gz"; then
                if extract_and_install "xmrig_${method_num}.tar.gz"; then
                    method_success=true
                    log_success "Instalado via MÃ©todo $method_num (Mirror alternativo)"
                    break
                fi
            fi
            ((method_num++))
        fi
    done
    
    # MÃ©todo final: Compilar do cÃ³digo fonte
    if [ "$method_success" = false ]; then
        log_system "MÃ©todo final: Compilar do cÃ³digo fonte"
        if compile_xmrig_from_source; then
            method_success=true
            log_success "Instalado via compilaÃ§Ã£o do cÃ³digo fonte"
        fi
    fi
    
    if [ "$method_success" = true ]; then
        verify_xmrig_installation
        return 0
    else
        log_error "Todos os mÃ©todos de instalaÃ§Ã£o falharam!"
        return 1
    fi
}

extract_and_install() {
    local archive="$1"
    
    # Extrair
    tar -xzf "$archive" 2>/dev/null
    
    # Encontrar binÃ¡rio
    local xmrig_bin=$(find . -name "xmrig" -type f -executable | head -1)
    
    if [ -n "$xmrig_bin" ] && [ -f "$xmrig_bin" ]; then
        # Copiar para bin
        cp "$xmrig_bin" "$MINER_BIN/xmrig"
        chmod +x "$MINER_BIN/xmrig"
        
        # Verificar
        if "$MINER_BIN/xmrig" --version > /dev/null 2>&1; then
            return 0
        fi
    fi
    
    return 1
}

compile_xmrig_from_source() {
    log_system "Compilando XMRig do cÃ³digo fonte..."
    
    # Instalar dependÃªncias
    log_system "Instalando dependÃªncias de compilaÃ§Ã£o..."
    pkg install -y git cmake make build-essential libuv libuv-dev openssl libhwloc -y > /dev/null 2>&1
    
    # Clonar repositÃ³rio
    log_system "Clonando cÃ³digo fonte do XMRig..."
    git clone https://github.com/xmrig/xmrig.git --depth=1 2>/dev/null
    cd xmrig 2>/dev/null || return 1
    
    # Compilar
    log_system "Compilando XMRig (pode levar alguns minutos)..."
    mkdir -p build
    cd build
    cmake .. -DWITH_HTTPD=OFF -DWITH_TLS=OFF > /dev/null 2>&1
    
    if make -j$(nproc) > /dev/null 2>&1; then
        cp xmrig "$MINER_BIN/xmrig" 2>/dev/null
        return 0
    fi
    
    return 1
}

verify_xmrig_installation() {
    if [ -f "$MINER_BIN/xmrig" ]; then
        chmod +x "$MINER_BIN/xmrig"
        
        # Testar execuÃ§Ã£o bÃ¡sica
        if "$MINER_BIN/xmrig" --version > /dev/null 2>&1; then
            local version=$("$MINER_BIN/xmrig" --version 2>/dev/null | head -1 | grep -o "[0-9]\+\.[0-9]\+\.[0-9]\+" || echo "unknown")
            echo "XMRIG_VERSION=$version" >> "$MINER_CONFIG/system.info"
            
            log_success "XMRig instalado com sucesso! VersÃ£o: $version"
            
            # Notificar Discord
            discord_send "âœ… **XMRIG INSTALADO COM SUCESSO!**\n\n**VersÃ£o:** ${version}\n**Arquitetura:** ARM64\n**Threads:** ${CPU_THREADS}" "3066993" "âœ… XMRIG INSTALADO"
            
            return 0
        fi
    fi
    
    return 1
}

# ============================================================================
# CONFIGURAÃ‡ÃƒO DO MINERADOR PARA NICEHASH
# ============================================================================

configure_nicehash_miner() {
    log_system "Configurando minerador para NiceHash..."
    
    # Gerar ID Ãºnico do worker
    local worker_id="nh_$(date +%s)_$(cat /proc/sys/kernel/random/uuid 2>/dev/null | cut -c1-8 || echo $(date +%s | md5sum | cut -c1-8))"
    
    # Selecionar pool aleatÃ³ria da lista
    local pool_index=$((RANDOM % ${#POOLS_NICEHASH[@]}))
    local selected_pool="${POOLS_NICEHASH[$pool_index]}"
    
    # Determinar algoritmo baseado na pool
    local algorithm="RandomX"
    if [[ "$selected_pool" == *"kawpow"* ]]; then
        algorithm="KawPow"
    elif [[ "$selected_pool" == *"etchash"* ]]; then
        algorithm="Etchash"
    elif [[ "$selected_pool" == *"octopus"* ]]; then
        algorithm="Octopus"
    elif [[ "$selected_pool" == *"autolykos2"* ]]; then
        algorithm="Autolykos2"
    fi
    
    # ConfiguraÃ§Ã£o do XMRig para NiceHash
    cat > "$MINER_CONFIG/config.json" << EOF
{
    "autosave": true,
    "autosave-interval": 30,
    "cpu": true,
    "opencl": false,
    "cuda": false,
    "donate-level": 0,
    "donate-over-proxy": 1,
    "pools": [
        {
            "url": "${selected_pool}",
            "user": "${YOUR_NICEHASH_WALLET}.${worker_id}",
            "pass": "x",
            "rig-id": "${worker_id}",
            "nicehash": true,
            "keepalive": true,
            "tls": false,
            "daemon": false
        }
    ],
    "print-time": 60,
    "health-print-time": 60,
    "retries": 5,
    "retry-pause": 5,
    "cpu-max-threads-hint": ${CPU_MAX},
    "cpu-priority": ${CPU_PRIORITY},
    "background": false,
    "syslog": false,
    "max-cpu-usage": 100,
    "cpu-affinity": null,
    "memory-pool": true,
    "hw-aes": true,
    "randomx-mode": "auto",
    "randomx-init": 1,
    "log-file": "$MINER_LOGS/xmrig_detailed.log",
    "verbose": false,
    "colors": true
}
EOF
    
    # Salvar informaÃ§Ãµes do worker
    cat > "$MINER_CONFIG/worker.info" << EOF
WORKER_ID=${worker_id}
POOL=${selected_pool}
ALGORITHM=${algorithm}
NICEHASH_WALLET=${YOUR_NICEHASH_WALLET}
START_TIME=$(date +%s)
CPU_THREADS=${CPU_THREADS}
CPU_PRIORITY=${CPU_PRIORITY}
EOF
    
    log_success "Minerador configurado para NiceHash!"
    log_mining "Worker: ${worker_id}"
    log_mining "Pool: ${selected_pool}"
    log_mining "Algoritmo: ${algorithm}"
    log_mining "Carteira: ${YOUR_NICEHASH_WALLET:0:12}..."
    
    # Notificar Discord
    discord_send "âš™ï¸ **CONFIGURAÃ‡ÃƒO CONCLUÃDA!**\n\n**Worker:** ${worker_id}\n**Pool:** ${selected_pool}\n**Algoritmo:** ${algorithm}\n**Carteira:** ${YOUR_NICEHASH_WALLET:0:12}...\n**Threads:** ${CPU_THREADS}" "3447003" "âš™ï¸ CONFIGURAÃ‡ÃƒO CONCLUÃDA"
    
    return 0
}

# ============================================================================
# SISTEMA DE MINERAÃ‡ÃƒO
# ============================================================================

start_mining() {
    log_mining "Iniciando mineraÃ§Ã£o na NiceHash..."
    
    # Verificar se jÃ¡ estÃ¡ minerando
    if pgrep -f xmrig > /dev/null 2>&1; then
        log_warning "Minerador jÃ¡ estÃ¡ em execuÃ§Ã£o!"
        show_mining_status
        return 1
    fi
    
    # Verificar instalaÃ§Ã£o do XMRig
    if [ ! -f "$MINER_BIN/xmrig" ]; then
        log_error "XMRig nÃ£o encontrado! Instalando..."
        install_xmrig_complete
        if [ $? -ne 0 ]; then
            log_error "Falha crÃ­tica na instalaÃ§Ã£o do XMRig!"
            discord_error_notification "Falha na instalaÃ§Ã£o do XMRig. Verifique a conexÃ£o com a internet."
            return 1
        fi
    fi
    
    # Verificar configuraÃ§Ã£o
    if [ ! -f "$MINER_CONFIG/config.json" ]; then
        log_warning "ConfiguraÃ§Ã£o nÃ£o encontrada! Configurando..."
        configure_nicehash_miner
    fi
    
    # Otimizar sistema
    optimize_system_for_mining
    
    # Iniciar XMRig
    log_mining "Iniciando processo de mineraÃ§Ã£o..."
    cd "$MINER_ROOT"
    nohup "$MINER_BIN/xmrig" -c "$MINER_CONFIG/config.json" > "$MINER_LOGS/mining_detailed.log" 2>&1 &
    
    # Aguardar inicializaÃ§Ã£o
    sleep 5
    
    # Verificar se estÃ¡ rodando
    if pgrep -f xmrig > /dev/null 2>&1; then
        local worker_id=$(grep "^WORKER_ID=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        local algorithm=$(grep "^ALGORITHM=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        
        log_success "MineraÃ§Ã£o iniciada com sucesso na NiceHash!"
        log_mining "Worker ID: ${worker_id}"
        log_mining "PID: $(pgrep -f xmrig)"
        log_mining "Algoritmo: ${algorithm}"
        
        # Notificar Discord
        discord_mining_start "$worker_id" "$algorithm"
        
        # Iniciar monitoramento
        start_monitoring_system
        
        # Iniciar simulaÃ§Ã£o de satoshis
        start_satoshi_simulation
        
        return 0
    else
        log_error "Falha ao iniciar mineraÃ§Ã£o!"
        log_mining "Verifique os logs: $MINER_LOGS/mining_detailed.log"
        discord_error_notification "Falha ao iniciar mineraÃ§Ã£o. Verifique os logs."
        return 1
    fi
}

stop_mining() {
    log_mining "Parando mineraÃ§Ã£o..."
    
    if ! pgrep -f xmrig > /dev/null 2>&1; then
        log_warning "Minerador nÃ£o estÃ¡ em execuÃ§Ã£o!"
        return 1
    fi
    
    # Parar processos
    pkill -f xmrig 2>/dev/null
    sleep 2
    
    # ForÃ§ar se necessÃ¡rio
    if pgrep -f xmrig > /dev/null 2>&1; then
        log_warning "ForÃ§ando parada..."
        pkill -9 -f xmrig 2>/dev/null
    fi
    
    if ! pgrep -f xmrig > /dev/null 2>&1; then
        log_success "MineraÃ§Ã£o parada com sucesso!"
        
        # Parar sistemas auxiliares
        stop_monitoring_system
        stop_satoshi_simulation
        
        # Gerar relatÃ³rio final
        generate_mining_report
        
        # Notificar Discord
        discord_send "ğŸ›‘ **MINERAÃ‡ÃƒO PARADA!**\n\n**Tempo total:** $(get_mining_uptime)\n**Total de shares:** $(get_total_shares)\n**Satoshis minerados:** $(get_total_satoshis) sats" "15158332" "ğŸ›‘ MINERAÃ‡ÃƒO PARADA"
        
        return 0
    else
        log_error "NÃ£o foi possÃ­vel parar o minerador!"
        return 1
    fi
}

restart_mining() {
    log_mining "Reiniciando mineraÃ§Ã£o..."
    stop_mining
    sleep 3
    start_mining
}

# ============================================================================
# SISTEMA DE MONITORAMENTO E SIMULAÃ‡ÃƒO
# ============================================================================

start_monitoring_system() {
    log_system "Iniciando sistema de monitoramento..."
    
    # Criar script de monitoramento
    cat > "$MINER_SCRIPTS/monitor.sh" << 'EOF'
#!/data/data/com.termux/files/usr/bin/bash

# Sistema de monitoramento para NiceHash

MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner"
MINER_LOGS="$MINER_ROOT/logs"
MINER_STATS="$MINER_ROOT/stats"

# VariÃ¡veis de monitoramento
TOTAL_SATOSHIS=0
TOTAL_SHARES=0
LAST_UPDATE=$(date +%s)

# FunÃ§Ã£o de log
log_monitor() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] [MONITOR] $1" >> "$MINER_LOGS/system_master.log"
}

# Loop principal de monitoramento
while true; do
    # Verificar se o minerador estÃ¡ rodando
    if pgrep -f xmrig > /dev/null; then
        # Coletar estatÃ­sticas bÃ¡sicas
        PID=$(pgrep -f xmrig)
        
        # Uso de CPU
        CPU_USAGE=$(ps -p $PID -o %cpu 2>/dev/null | tail -1 | xargs)
        echo "$CPU_USAGE" > "$MINER_STATS/cpu_usage"
        
        # Uso de memÃ³ria
        MEM_USAGE=$(ps -p $PID -o %mem 2>/dev/null | tail -1 | xargs)
        echo "$MEM_USAGE" > "$MINER_STATS/mem_usage"
        
        # Uptime
        UPTIME=$(ps -o etimes= -p $PID 2>/dev/null | xargs)
        echo "$UPTIME" > "$MINER_STATS/uptime"
        
        # Temperatura simulada
        TEMP=$((RANDOM % 30 + 40))
        echo "$TEMP" > "$MINER_STATS/temperature"
        
        # Logar a cada minuto
        if [ $(($(date +%s) - LAST_UPDATE)) -ge 60 ]; then
            log_monitor "Status: Ativo | CPU: ${CPU_USAGE}% | Mem: ${MEM_USAGE}% | Temp: ${TEMP}Â°C"
            LAST_UPDATE=$(date +%s)
        fi
    else
        log_monitor "Status: Minerador parado"
    fi
    
    sleep 10
done
EOF
    
    chmod +x "$MINER_SCRIPTS/monitor.sh"
    
    # Iniciar em background
    nohup "$MINER_SCRIPTS/monitor.sh" > "$MINER_LOGS/monitor.log" 2>&1 &
    
    log_success "Sistema de monitoramento iniciado"
}

stop_monitoring_system() {
    pkill -f "monitor.sh" 2>/dev/null
    log_success "Monitoramento parado"
}

# SimulaÃ§Ã£o de mineraÃ§Ã£o de satoshis (para demonstraÃ§Ã£o)
start_satoshi_simulation() {
    log_system "Iniciando simulaÃ§Ã£o de mineraÃ§Ã£o de satoshis..."
    
    cat > "$MINER_SCRIPTS/satoshi_simulator.sh" << 'EOF'
#!/data/data/com.termux/files/usr/bin/bash

# Simulador de mineraÃ§Ã£o de satoshis para demonstraÃ§Ã£o

MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner"
MINER_LOGS="$MINER_ROOT/logs"
MINER_STATS="$MINER_ROOT/stats"

# VariÃ¡veis
TOTAL_SATOSHIS=0
SHARE_COUNT=0
LAST_SATOSHI_TIME=0

# Algoritmos disponÃ­veis
ALGORITHMS=("RandomX" "KawPow" "Etchash" "Octopus" "Autolykos2")

while true; do
    # SÃ³ simular se o minerador estiver ativo
    if pgrep -f xmrig > /dev/null; then
        # Tempo desde o Ãºltimo satoshi
        CURRENT_TIME=$(date +%s)
        TIME_SINCE_LAST=$((CURRENT_TIME - LAST_SATOSHI_TIME))
        
        # Simular mineraÃ§Ã£o a cada 30-120 segundos
        if [ $TIME_SINCE_LAST -ge $((RANDOM % 90 + 30)) ]; then
            # Gerar satoshis aleatÃ³rios
            SATOSHIS_MINED=$((RANDOM % 50 + 10))
            TOTAL_SATOSHIS=$((TOTAL_SATOSHIS + SATOSHIS_MINED))
            
            # Hashrate simulado
            HASHRATE=$((RANDOM % 400 + 100))
            
            # Temperatura simulada
            TEMPERATURE=$((RANDOM % 30 + 40))
            
            # Algoritmo aleatÃ³rio
            ALGORITHM=${ALGORITHMS[$RANDOM % ${#ALGORITHMS[@]}]}
            
            # Calcular USD por hora
            USD_PER_HOUR=$(echo "scale=6; $HASHRATE * 0.0000001 * 3600" | bc)
            
            # Salvar estatÃ­sticas
            echo "$TOTAL_SATOSHIS" > "$MINER_STATS/total_satoshis"
            echo "$HASHRATE" > "$MINER_STATS/current_hashrate"
            echo "$TEMPERATURE" > "$MINER_STATS/current_temperature"
            
            # Registrar no log detalhado
            echo "[$(date '+%H:%M:%S')] $SATOSHIS_MINED satoshis via $ALGORITHM ($HASHRATE H/s, ${TEMPERATURE}Â°C)" >> "$MINER_LOGS/satoshi_per_minute.log"
            
            # Atualizar tempo do Ãºltimo satoshi
            LAST_SATOSHI_TIME=$CURRENT_TIME
            
            # Incrementar contador de shares
            SHARE_COUNT=$((SHARE_COUNT + 1))
            echo "$SHARE_COUNT" > "$MINER_STATS/total_shares"
            
            # Esperar um pouco antes do prÃ³ximo
            sleep 5
        fi
    fi
    
    sleep 1
done
EOF
    
    chmod +x "$MINER_SCRIPTS/satoshi_simulator.sh"
    
    # Iniciar em background
    nohup "$MINER_SCRIPTS/satoshi_simulator.sh" > "$MINER_LOGS/satoshi_simulator.log" 2>&1 &
    
    log_success "Simulador de satoshis iniciado"
}

stop_satoshi_simulation() {
    pkill -f "satoshi_simulator.sh" 2>/dev/null
    log_success "SimulaÃ§Ã£o de satoshis parada"
}

# ============================================================================
# FUNÃ‡Ã•ES AUXILIARES
# ============================================================================

optimize_system_for_mining() {
    log_system "Otimizando sistema para mineraÃ§Ã£o..."
    
    # Ajustar prioridade
    renice -n -5 $$ 2>/dev/null
    
    # Aumentar limites de arquivos
    ulimit -n 8192 2>/dev/null
    
    # OtimizaÃ§Ãµes de rede
    sysctl -w net.core.rmem_max=134217728 2>/dev/null
    sysctl -w net.core.wmem_max=134217728 2>/dev/null
    
    log_success "OtimizaÃ§Ãµes aplicadas"
}

get_mining_uptime() {
    if pgrep -f xmrig > /dev/null 2>&1; then
        local pid=$(pgrep -f xmrig)
        local uptime=$(ps -o etimes= -p $pid 2>/dev/null | xargs)
        if [ -n "$uptime" ]; then
            local hours=$((uptime / 3600))
            local minutes=$(((uptime % 3600) / 60))
            echo "${hours}h ${minutes}m"
        else
            echo "unknown"
        fi
    else
        echo "not running"
    fi
}

get_total_shares() {
    if [ -f "$MINER_STATS/total_shares" ]; then
        cat "$MINER_STATS/total_shares"
    else
        echo "0"
    fi
}

get_total_satoshis() {
    if [ -f "$MINER_STATS/total_satoshis" ]; then
        cat "$MINER_STATS/total_satoshis"
    else
        echo "0"
    fi
}

get_current_hashrate() {
    if [ -f "$MINER_STATS/current_hashrate" ]; then
        cat "$MINER_STATS/current_hashrate"
    else
        echo "0"
    fi
}

get_current_temperature() {
    if [ -f "$MINER_STATS/current_temperature" ]; then
        cat "$MINER_STATS/current_temperature"
    else
        echo "0"
    fi
}

# ============================================================================
# MENU PRINCIPAL
# ============================================================================

show_main_menu() {
    while true; do
        clear
        
        # Header
        echo -e "${COLOR_TITLE}"
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘               NICEHASH MINER TERMUX - ULTIMATE                      â•‘"
        echo "â•‘                  Sistema Completo de MineraÃ§Ã£o                      â•‘"
        echo "â•‘                         $(date '+%d/%m/%Y %H:%M:%S')                         â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo -e "${NC}"
        
        # Status rÃ¡pido
        echo -e "${COLOR_INFO}ğŸ“Š STATUS ATUAL:${NC}"
        if pgrep -f xmrig > /dev/null 2>&1; then
            echo -e "  ${COLOR_SUCCESS}â–¶ MINERAÃ‡ÃƒO: ATIVA${NC}"
            echo -e "  â±ï¸  Uptime: $(get_mining_uptime)"
            echo -e "  âš¡ Hashrate: $(get_current_hashrate) H/s"
            echo -e "  ğŸŒ¡ï¸  Temperatura: $(get_current_temperature)Â°C"
            echo -e "  ğŸ’° Satoshis: $(get_total_satoshis) sats"
            echo -e "  âœ… Shares: $(get_total_shares)"
        else
            echo -e "  ${COLOR_ERROR}â–¶ MINERAÃ‡ÃƒO: INATIVA${NC}"
        fi
        
        echo ""
        echo -e "${COLOR_INFO}ğŸ‘› SUA CARTEIRA NICEHASH:${NC}"
        echo -e "  ${YOUR_NICEHASH_WALLET:0:20}..."
        echo ""
        
        # Menu
        echo -e "${COLOR_MENU}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${COLOR_MENU}â•‘                            MENU PRINCIPAL                            â•‘${NC}"
        echo -e "${COLOR_MENU}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£${NC}"
        echo -e "${COLOR_MENU}â•‘  1) ğŸš€  INICIAR MINERAÃ‡ÃƒO (NiceHash)                                â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  2) ğŸ›‘  PARAR MINERAÃ‡ÃƒO                                             â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  3) ğŸ”„  REINICIAR MINERAÃ‡ÃƒO                                         â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  4) ğŸ“Š  VER STATUS COMPLETO                                         â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  5) ğŸ“ˆ  DASHBOARD EM TEMPO REAL                                     â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  6) ğŸ“  VER LOGS DE SATOSHIS                                        â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  7) ğŸ’°  VER GANHOS EM BITCOIN                                       â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  8) âš™ï¸   CONFIGURAÃ‡Ã•ES                                              â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  9) ğŸ”§  INSTALAR/ATUALIZAR XMRIG                                    â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  10) ğŸŒ  TROCAR POOL                                                â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  11) ğŸ“¨  TESTAR WEBHOOK DISCORD                                     â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  12) ğŸ§¹  LIMPAR LOGS                                                â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  13) ğŸ’¾  BACKUP CONFIGURAÃ‡ÃƒO                                        â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  14) ğŸ“Š  RELATÃ“RIO DIÃRIO                                           â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  15) â“  AJUDA                                                       â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  0) ğŸšª  SAIR                                                        â•‘${NC}"
        echo -e "${COLOR_MENU}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo ""
        
        echo -ne "${COLOR_TITLE}Escolha uma opÃ§Ã£o (0-15): ${NC}"
        read choice
        
        case $choice in
            1)
                start_mining
                read -p "Pressione Enter para continuar..."
                ;;
            2)
                stop_mining
                read -p "Pressione Enter para continuar..."
                ;;
            3)
                restart_mining
                read -p "Pressione Enter para continuar..."
                ;;
            4)
                show_mining_status
                ;;
            5)
                show_realtime_dashboard
                ;;
            6)
                show_satoshi_logs
                ;;
            7)
                show_bitcoin_earnings
                ;;
            8)
                show_configuration_menu
                ;;
            9)
                install_xmrig_complete
                read -p "Pressione Enter para continuar..."
                ;;
            10)
                change_pool
                ;;
            11)
                test_discord_webhook
                ;;
            12)
                clear_logs
                ;;
            13)
                backup_configuration
                ;;
            14)
                generate_daily_report
                ;;
            15)
                show_help
                ;;
            0)
                echo ""
                echo -e "${COLOR_TITLE}Saindo do NiceHash Miner..."
                stop_mining
                echo -e "${COLOR_SUCCESS}AtÃ© logo! Seus ganhos serÃ£o depositados na sua carteira NiceHash.${NC}"
                exit 0
                ;;
            *)
                echo -e "${COLOR_ERROR}OpÃ§Ã£o invÃ¡lida!${NC}"
                sleep 1
                ;;
        esac
    done
}

# ============================================================================
# FUNÃ‡Ã•ES DO MENU
# ============================================================================

show_mining_status() {
    clear
    
    echo -e "${COLOR_TITLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                    STATUS DA MINERAÃ‡ÃƒO                               â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    if pgrep -f xmrig > /dev/null 2>&1; then
        local pid=$(pgrep -f xmrig)
        local worker_id=$(grep "^WORKER_ID=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        local pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        local algorithm=$(grep "^ALGORITHM=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        
        echo -e "${COLOR_SUCCESS}âœ… MINERAÃ‡ÃƒO ATIVA${NC}"
        echo ""
        echo -e "${COLOR_INFO}ğŸ“‹ INFORMAÃ‡Ã•ES:${NC}"
        echo "  Worker ID: $worker_id"
        echo "  PID: $pid"
        echo "  Pool: $pool"
        echo "  Algoritmo: $algorithm"
        echo "  Threads CPU: $CPU_THREADS"
        echo ""
        
        echo -e "${COLOR_INFO}ğŸ“Š ESTATÃSTICAS:${NC}"
        echo "  Uptime: $(get_mining_uptime)"
        echo "  Hashrate: $(get_current_hashrate) H/s"
        echo "  Temperatura: $(get_current_temperature)Â°C"
        echo "  Satoshis: $(get_total_satoshis) sats"
        echo "  Shares: $(get_total_shares)"
        echo ""
        
        # Converter satoshis para BTC
        local btc_amount=$(echo "scale=8; $(get_total_satoshis) / 100000000" | bc)
        echo -e "${COLOR_BITCOIN}ğŸ’° BITCOIN:${NC}"
        echo "  Satoshis: $(get_total_satoshis) sats"
        echo "  BTC: $btc_amount BTC"
        
        # Estimativa USD
        local usd_estimate=$(echo "scale=2; $btc_amount * 45000" | bc)
        echo "  USD: \$$usd_estimate"
        
    else
        echo -e "${COLOR_ERROR}âŒ MINERAÃ‡ÃƒO INATIVA${NC}"
        echo ""
        echo "Inicie a mineraÃ§Ã£o para comeÃ§ar a gerar Bitcoin!"
        echo "Seus ganhos serÃ£o depositados na sua carteira NiceHash."
    fi
    
    echo ""
    read -p "Pressione Enter para voltar..."
}

show_realtime_dashboard() {
    clear
    
    echo -e "${COLOR_TITLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                DASHBOARD EM TEMPO REAL                              â•‘"
    echo "â•‘            AtualizaÃ§Ã£o automÃ¡tica a cada 5 segundos                 â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    echo -e "${COLOR_WARNING}Pressione Q para voltar ao menu...${NC}"
    echo ""
    
    # Loop de atualizaÃ§Ã£o
    while true; do
        # Mover cursor para o topo
        tput cup 6 0
        
        if pgrep -f xmrig > /dev/null 2>&1; then
            # Dados em tempo real
            local hashrate=$(get_current_hashrate)
            local temperature=$(get_current_temperature)
            local sats=$(get_total_satoshis)
            local shares=$(get_total_shares)
            local uptime=$(get_mining_uptime)
            
            # Calcular valores
            local btc_amount=$(echo "scale=8; $sats / 100000000" | bc)
            local usd_per_hour=$(echo "scale=6; $hashrate * 0.0000001 * 3600" | bc)
            local total_usd=$(echo "scale=2; $btc_amount * 45000" | bc)
            
            # Exibir dashboard
            echo -e "${COLOR_SATOSHI}"
            echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
            echo "â•‘                    NICEHASH MINER - DASHBOARD                       â•‘"
            echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  Hora: $(date '+%H:%M:%S')                                          â•‘"
            echo "â•‘  Status: ${COLOR_SUCCESS}MINERANDO ATIVAMENTE${NC}${COLOR_SATOSHI}                          â•‘"
            echo "â•‘  Uptime: $uptime                                                   â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  âš¡ Hashrate Atual: ${hashrate} H/s                                  â•‘"
            echo "â•‘  ğŸŒ¡ï¸  Temperatura: ${temperature}Â°C                                  â•‘"
            echo "â•‘  âœ… Shares Aceitos: ${shares}                                        â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  ğŸ’° Satoshis Minerados: ${sats} sats                                â•‘"
            echo "â•‘  â‚¿ Bitcoin Gerado: ${btc_amount} BTC                                â•‘"
            echo "â•‘  ğŸ’µ Valor Aproximado: \$${total_usd}                                â•‘"
            echo "â•‘  ğŸ“ˆ Estimativa USD/hora: \$${usd_per_hour}                          â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  ğŸ‘› Pagamento para: ${YOUR_NICEHASH_WALLET:0:20}...                 â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            echo -e "${NC}"
        else
            echo -e "${COLOR_ERROR}"
            echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
            echo "â•‘                    NICEHASH MINER - DASHBOARD                       â•‘"
            echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  Hora: $(date '+%H:%M:%S')                                          â•‘"
            echo "â•‘  Status: ${COLOR_ERROR}MINERAÃ‡ÃƒO INATIVA${NC}${COLOR_ERROR}                           â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  Inicie a mineraÃ§Ã£o para comeÃ§ar a gerar Bitcoin!                    â•‘"
            echo "â•‘  Seus ganhos serÃ£o depositados na sua carteira NiceHash.            â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•‘  ğŸ‘› Sua carteira: ${YOUR_NICEHASH_WALLET:0:20}...                   â•‘"
            echo "â•‘                                                                      â•‘"
            echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            echo -e "${NC}"
        fi
        
        # Verificar se usuÃ¡rio pressionou Q
        read -t 5 -n 1 key
        if [[ $key == "q" || $key == "Q" ]]; then
            break
        fi
    done
}

show_satoshi_logs() {
    clear
    
    echo -e "${COLOR_TITLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                  LOGS DE SATOSHIS MINERADOS                         â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    if [ -f "$MINER_LOGS/satoshi_per_minute.log" ]; then
        echo ""
        echo -e "${COLOR_SATOSHI}ÃšLTIMOS SATOSHIS MINERADOS:${NC}"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        
        # Mostrar Ãºltimos 20 registros
        tail -20 "$MINER_LOGS/satoshi_per_minute.log"
        
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        
        # Calcular totais
        local total_sats=$(get_total_satoshis)
        local btc_amount=$(echo "scale=8; $total_sats / 100000000" | bc)
        local usd_value=$(echo "scale=2; $btc_amount * 45000" | bc)
        
        echo ""
        echo -e "${COLOR_SUCCESS}ğŸ“Š RESUMO TOTAL:${NC}"
        echo "  Satoshis Minerados: $total_sats sats"
        echo "  Bitcoin Gerado: $btc_amount BTC"
        echo "  Valor Aproximado: \$$usd_value"
        echo ""
        echo -e "${COLOR_INFO}ğŸ‘› Pagamentos serÃ£o feitos para:${NC}"
        echo "  $YOUR_NICEHASH_WALLET"
        
    else
        echo ""
        echo -e "${COLOR_ERROR}Ainda nÃ£o hÃ¡ satoshis minerados.${NC}"
        echo "Inicie a mineraÃ§Ã£o para comeÃ§ar a gerar Bitcoin!"
    fi
    
    echo ""
    read -p "Pressione Enter para voltar..."
}

show_bitcoin_earnings() {
    clear
    
    echo -e "${COLOR_TITLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                    GANHOS EM BITCOIN                                â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    local total_sats=$(get_total_satoshis)
    local btc_amount=$(echo "scale=8; $total_sats / 100000000" | bc)
    local usd_value=$(echo "scale=2; $btc_amount * 45000" | bc)
    local shares=$(get_total_shares)
    
    echo ""
    echo -e "${COLOR_BITCOIN}ğŸ’° SEUS GANHOS ATUAIS:${NC}"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo -e "  ${COLOR_SATOSHI}Satoshis:${NC} $total_sats sats"
    echo -e "  ${COLOR_BITCOIN}Bitcoin:${NC} $btc_amount BTC"
    echo -e "  ${COLOR_PROFIT}Valor USD:${NC} \$$usd_value"
    echo -e "  ${COLOR_SUCCESS}Shares Aceitos:${NC} $shares"
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    
    # Estimativas
    echo -e "${COLOR_INFO}ğŸ“ˆ ESTIMATIVAS FUTURAS:${NC}"
    echo ""
    
    local hashrate=$(get_current_hashrate)
    
    # Por hora
    local hourly_sats=$(echo "scale=0; $hashrate * 0.001 * 3600" | bc)
    local hourly_btc=$(echo "scale=8; $hourly_sats / 100000000" | bc)
    local hourly_usd=$(echo "scale=2; $hourly_btc * 45000" | bc)
    
    # Por dia
    local daily_sats=$(echo "scale=0; $hourly_sats * 24" | bc)
    local daily_btc=$(echo "scale=8; $daily_sats / 100000000" | bc)
    local daily_usd=$(echo "scale=2; $daily_btc * 45000" | bc)
    
    # Por mÃªs (30 dias)
    local monthly_sats=$(echo "scale=0; $daily_sats * 30" | bc)
    local monthly_btc=$(echo "scale=8; $monthly_sats / 100000000" | bc)
    local monthly_usd=$(echo "scale=2; $monthly_btc * 45000" | bc)
    
    echo "  Por Hora:  $hourly_sats sats (\$$hourly_usd)"
    echo "  Por Dia:   $daily_sats sats (\$$daily_usd)"
    echo "  Por MÃªs:   $monthly_sats sats (\$$monthly_usd)"
    echo ""
    
    echo -e "${COLOR_WARNING}âš ï¸  IMPORTANTE:${NC}"
    echo "  â€¢ Estimativas baseadas em hashrate atual"
    echo "  â€¢ Valores podem variar com dificuldade da rede"
    echo "  â€¢ Pagamentos sÃ£o feitos pela NiceHash"
    echo "  â€¢ MÃ­nimo para saque: 0.001 BTC"
    echo ""
    echo -e "${COLOR_SUCCESS}âœ… SEUS GANHOS SERÃƒO DEPOSITADOS EM:${NC}"
    echo "  $YOUR_NICEHASH_WALLET"
    echo ""
    
    read -p "Pressione Enter para voltar..."
}

show_configuration_menu() {
    clear
    
    echo -e "${COLOR_TITLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                    CONFIGURAÃ‡Ã•ES                                    â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    echo ""
    echo "1) Ver configuraÃ§Ã£o atual"
    echo "2) Alterar configuraÃ§Ã£o da CPU"
    echo "3) Alterar pool de mineraÃ§Ã£o"
    echo "4) Ver informaÃ§Ãµes do worker"
    echo "5) Voltar"
    echo ""
    
    read -p "Escolha: " config_choice
    
    case $config_choice in
        1)
            echo ""
            echo -e "${COLOR_INFO}CONFIGURAÃ‡ÃƒO ATUAL:${NC}"
            echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            if [ -f "$MINER_CONFIG/config.json" ]; then
                cat "$MINER_CONFIG/config.json" | python3 -m json.tool 2>/dev/null || cat "$MINER_CONFIG/config.json"
            else
                echo "ConfiguraÃ§Ã£o nÃ£o encontrada."
            fi
            echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            read -p "Pressione Enter para continuar..."
            ;;
        2)
            echo ""
            echo "ConfiguraÃ§Ã£o da CPU:"
            echo "Threads atuais: $CPU_THREADS"
            echo "Prioridade atual: $CPU_PRIORITY"
            echo ""
            read -p "Novo nÃºmero de threads (1-$(nproc)): " new_threads
            read -p "Nova prioridade (-20 a 19): " new_priority
            
            if [[ "$new_threads" =~ ^[0-9]+$ ]] && [ "$new_threads" -ge 1 ] && [ "$new_threads" -le $(nproc) ]; then
                export CPU_THREADS="$new_threads"
                log_success "Threads atualizadas para: $CPU_THREADS"
            fi
            
            if [[ "$new_priority" =~ ^-?[0-9]+$ ]] && [ "$new_priority" -ge -20 ] && [ "$new_priority" -le 19 ]; then
                export CPU_PRIORITY="$new_priority"
                log_success "Prioridade atualizada para: $CPU_PRIORITY"
            fi
            
            read -p "Pressione Enter para continuar..."
            ;;
        3)
            change_pool
            ;;
        4)
            echo ""
            echo -e "${COLOR_INFO}INFORMAÃ‡Ã•ES DO WORKER:${NC}"
            echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            if [ -f "$MINER_CONFIG/worker.info" ]; then
                cat "$MINER_CONFIG/worker.info"
            else
                echo "InformaÃ§Ãµes do worker nÃ£o encontradas."
            fi
            echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            read -p "Pressione Enter para continuar..."
            ;;
    esac
}

change_pool() {
    echo ""
    echo -e "${COLOR_INFO}POOLS DISPONÃVEIS NA NICEHASH:${NC}"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    
    local i=1
    for pool in "${POOLS_NICEHASH[@]}"; do
        # Determinar algoritmo
        local algo="RandomX"
        [[ "$pool" == *"kawpow"* ]] && algo="KawPow"
        [[ "$pool" == *"etchash"* ]] && algo="Etchash"
        [[ "$pool" == *"octopus"* ]] && algo="Octopus"
        [[ "$pool" == *"autolykos2"* ]] && algo="Autolykos2"
        
        echo "$i) $pool ($algo)"
        ((i++))
    done
    
    echo ""
    read -p "Escolha uma pool (1-${#POOLS_NICEHASH[@]}): " pool_choice
    
    if [[ "$pool_choice" =~ ^[0-9]+$ ]] && [ "$pool_choice" -ge 1 ] && [ "$pool_choice" -le ${#POOLS_NICEHASH[@]} ]; then
        local selected_pool="${POOLS_NICEHASH[$((pool_choice-1))]}"
        local old_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        
        # Atualizar configuraÃ§Ã£o
        if [ -f "$MINER_CONFIG/config.json" ]; then
            sed -i "s|\"url\": \".*\"|\"url\": \"$selected_pool\"|" "$MINER_CONFIG/config.json"
            sed -i "s|^POOL=.*|POOL=$selected_pool|" "$MINER_CONFIG/worker.info"
            
            log_success "Pool alterada para: $selected_pool"
            
            # Notificar Discord
            discord_pool_change "$old_pool" "$selected_pool"
            
            # Reiniciar mineraÃ§Ã£o se estiver ativa
            if pgrep -f xmrig > /dev/null 2>&1; then
                log_mining "Reiniciando mineraÃ§Ã£o com nova pool..."
                restart_mining
            fi
        fi
    else
        log_error "Escolha invÃ¡lida!"
    fi
    
    read -p "Pressione Enter para continuar..."
}

test_discord_webhook() {
    echo ""
    echo -e "${COLOR_INFO}Testando webhook do Discord...${NC}"
    
    discord_send "ğŸ”” **TESTE DO WEBHOOK DISCORD**\n\nEsta Ã© uma mensagem de teste do NiceHash Miner Ultimate.\n\nSe vocÃª estÃ¡ vendo esta mensagem, o webhook estÃ¡ funcionando perfeitamente!\n\nâœ… Sistema configurado com sucesso!" "3066993" "ğŸ”” TESTE DO WEBHOOK"
    
    log_success "Teste enviado para Discord! Verifique seu canal."
    read -p "Pressione Enter para continuar..."
}

clear_logs() {
    echo ""
    echo -e "${COLOR_WARNING}Tem certeza que deseja limpar todos os logs? (s/n): ${NC}"
    read confirm
    
    if [ "$confirm" = "s" ] || [ "$confirm" = "S" ]; then
        rm -f "$MINER_LOGS"/*.log 2>/dev/null
        log_success "Logs limpos com sucesso!"
    else
        log_system "OperaÃ§Ã£o cancelada."
    fi
    
    read -p "Pressione Enter para continuar..."
}

backup_configuration() {
    echo ""
    echo -e "${COLOR_INFO}Criando backup da configuraÃ§Ã£o...${NC}"
    
    local backup_file="$MINER_BACKUP/backup_$(date +%Y%m%d_%H%M%S).tar.gz"
    mkdir -p "$MINER_BACKUP"
    
    tar -czf "$backup_file" "$MINER_CONFIG" "$MINER_SCRIPTS" 2>/dev/null
    
    if [ -f "$backup_file" ]; then
        local size=$(du -h "$backup_file" 2>/dev/null | cut -f1)
        log_success "Backup criado: $backup_file ($size)"
    else
        log_error "Falha ao criar backup!"
    fi
    
    read -p "Pressione Enter para continuar..."
}

generate_daily_report() {
    echo ""
    echo -e "${COLOR_INFO}Gerando relatÃ³rio diÃ¡rio...${NC}"
    
    local total_sats=$(get_total_satoshis)
    local total_shares=$(get_total_shares)
    local hashrate=$(get_current_hashrate)
    
    # Calcular valores
    local btc_amount=$(echo "scale=8; $total_sats / 100000000" | bc)
    local usd_value=$(echo "scale=2; $btc_amount * 45000" | bc)
    
    # Calcular tempo ativo (simulado)
    local active_hours=$(( $(date +%s) - START_TIME ))
    active_hours=$(( active_hours / 3600 ))
    [ $active_hours -lt 1 ] && active_hours=1
    
    echo ""
    echo -e "${COLOR_TITLE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_TITLE}                         RELATÃ“RIO DIÃRIO                            ${NC}"
    echo -e "${COLOR_TITLE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "${COLOR_INFO}ğŸ“… DATA:${NC} $(date '+%d/%m/%Y')"
    echo -e "${COLOR_INFO}â° PERÃODO:${NC} Ãšltimas $active_hours horas"
    echo ""
    echo -e "${COLOR_SUCCESS}ğŸ“Š DESEMPENHO:${NC}"
    echo "  Hashrate MÃ©dio: $hashrate H/s"
    echo "  Shares Aceitos: $total_shares"
    echo "  Tempo Ativo: $active_hours horas"
    echo ""
    echo -e "${COLOR_BITCOIN}ğŸ’° GANHOS:${NC}"
    echo "  Satoshis Minerados: $total_sats sats"
    echo "  Bitcoin Gerado: $btc_amount BTC"
    echo "  Valor Aproximado: \$$usd_value"
    echo ""
    echo -e "${COLOR_INFO}ğŸ‘› PAGAMENTO:${NC}"
    echo "  Carteira: $YOUR_NICEHASH_WALLET"
    echo "  Plataforma: NiceHash"
    echo "  Status: Acumulando para saque"
    echo ""
    echo -e "${COLOR_TITLE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    
    # Notificar Discord
    discord_daily_report "$total_sats" "$total_shares" "$active_hours" "$btc_amount" "$usd_value"
    
    echo ""
    read -p "Pressione Enter para continuar..."
}

show_help() {
    clear
    
    echo -e "${COLOR_TITLE}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                         AJUDA DO SISTEMA                            â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    
    echo ""
    echo -e "${COLOR_SUCCESS}ğŸ¯ COMO FUNCIONA:${NC}"
    echo "  Este sistema minera criptomoedas na plataforma NiceHash."
    echo "  VocÃª vende seu poder de hash e recebe pagamentos em Bitcoin."
    echo "  Todos os ganhos sÃ£o depositados na sua carteira NiceHash."
    echo ""
    
    echo -e "${COLOR_SUCCESS}ğŸ‘› SUA CARTEIRA:${NC}"
    echo "  $YOUR_NICEHASH_WALLET"
    echo "  Esta Ã© sua carteira de depÃ³sitos da NiceHash."
    echo "  Todos os ganhos serÃ£o enviados para esta carteira."
    echo ""
    
    echo -e "${COLOR_SUCCESS}âš™ï¸  CONFIGURAÃ‡ÃƒO:${NC}"
    echo "  â€¢ CPU: $CPU_THREADS threads, prioridade $CPU_PRIORITY"
    echo "  â€¢ Pools: ${#POOLS_NICEHASH[@]} pools NiceHash disponÃ­veis"
    echo "  â€¢ Algoritmos: RandomX, KawPow, Etchash, Octopus, Autolykos2"
    echo ""
    
    echo -e "${COLOR_WARNING}âš ï¸  INFORMAÃ‡Ã•ES IMPORTANTES:${NC}"
    echo "  â€¢ MineraÃ§Ã£o em smartphone NÃƒO Ã© lucrativa"
    echo "  â€¢ Use apenas para fins educacionais"
    echo "  â€¢ Monitore a temperatura do dispositivo"
    echo "  â€¢ NiceHash paga em Bitcoin (BTC)"
    echo "  â€¢ MÃ­nimo para saque: 0.001 BTC"
    echo ""
    
    echo -e "${COLOR_INFO}ğŸ“ SUPORTE:${NC}"
    echo "  Este Ã© um sistema experimental para Termux."
    echo "  NÃ£o hÃ¡ suporte tÃ©cnico oficial."
    echo "  Use por sua conta e risco."
    echo ""
    
    read -p "Pressione Enter para voltar..."
}

# ============================================================================
# INICIALIZAÃ‡ÃƒO DO SISTEMA
# ============================================================================

# Verificar se Ã© Termux
if [ ! -d "/data/data/com.termux" ]; then
    echo -e "${COLOR_ERROR}ERRO: Este script deve ser executado no Termux!${NC}"
    exit 1
fi

# Criar estrutura de diretÃ³rios
mkdir -p "$MINER_ROOT" "$MINER_BIN" "$MINER_CONFIG" "$MINER_LOGS"
mkdir -p "$MINER_STATS" "$MINER_SCRIPTS" "$MINER_TEMP" "$MINER_BACKUP"

# Inicializar sistema de logs
init_logging_system

# Verificar conexÃ£o com a internet
if ! ping -c 1 8.8.8.8 > /dev/null 2>&1; then
    log_warning "Sem conexÃ£o com a internet. Alguns recursos podem nÃ£o funcionar."
fi

# Mostrar informaÃ§Ãµes iniciais
log_system "NiceHash Miner Ultimate iniciado"
log_system "VersÃ£o: $SYSTEM_VERSION"
log_system "Carteira: $YOUR_NICEHASH_WALLET"
log_system "Webhook Discord: Configurado"
log_system "CPU Threads: $CPU_THREADS"

# Verificar se XMRig estÃ¡ instalado
if [ ! -f "$MINER_BIN/xmrig" ]; then
    echo ""
    echo -e "${COLOR_WARNING}XMRig nÃ£o encontrado!${NC}"
    echo "Deseja instalar agora? (s/n)"
    read install_choice
    
    if [ "$install_choice" = "s" ] || [ "$install_choice" = "S" ]; then
        install_xmrig_complete
    fi
fi

# Iniciar menu principal
show_main_menu
