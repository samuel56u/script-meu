#!/data/data/com.termux/files/usr/bin/bash

# ============================================================================
# NICEHASH MINER ULTIMATE - TERMUX GOD MODE v60.2.0
# ============================================================================
#   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
#   â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
#   â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
#   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
#   â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
#   â•šâ•â•  â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•
# ============================================================================
#         ðŸ”¥ MODO DEUS ATIVADO - SISTEMA ABSOLUTAMENTE COMPLETO ðŸ”¥
# ============================================================================
#         âœ… MENU CORRETO: OPÃ‡Ã•ES 1-20 E 0 PARA SAIR
#         âœ… TODOS OS 'read' AGORA LEEM DO TERMINAL (/dev/tty)
#         âœ… NUNCA MAIS "OPÃ‡ÃƒO INVÃLIDA" AUTOMÃTICA
#         âœ… DESINSTALAÃ‡ÃƒO AUTOMÃTICA DO XMRIG ANTES DE INSTALAR
#         ðŸ”„ TROCA AUTOMÃTICA DE POOLS - 50+ POOLS NICEHASH
#         ðŸ›¡ï¸ FALLBACK AUTOMÃTICO - SEMPRE A POOL MAIS RÃPIDA
#         ðŸ“¦ 60+ MÃ‰TODOS DE DOWNLOAD DO XMRIG (TODOS FUNCIONAIS)
#         ðŸ“Š LOGS DISCORD GIGANTESCOS - CADA SATOSHI NOTIFICADO
#         ðŸ“ˆ DASHBOARD EM TEMPO REAL - EXATAMENTE COMO NA IMAGEM
#         ðŸ”§ SISTEMA DE DIAGNÃ“STICO COMPLETO
#         ðŸ§ª BENCHMARK DE CPU
#         ðŸŒ¡ï¸ MONITOR TÃ‰RMICO COM ALERTAS
#         ðŸ’¾ BACKUP/RESTORE
#         ðŸŽ® MÃšLTIPLOS MODOS: ECO, TURBO, DEUS
# ============================================================================

# ----------------------------------------------------------------------------
# CONFIGURAÃ‡Ã•ES DO USUÃRIO (JÃ PREENCHIDAS - NÃƒO ALTERAR)
# ----------------------------------------------------------------------------
export WALLET_NICEHASH="bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
export WALLET_BACKUP="bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh"
export WALLET_TERTIARY="1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"
export WEBHOOK_DISCORD="https://discord.com/api/webhooks/1470009252063088661/1j4kNu2sDcGQmFCywnbd_p1BEbb1DTcN_VXt5OYpX8_FsQI2YKB3tCjS2Okp_msUX9Mh"
export WEBHOOK_DISCORD_BACKUP=""
export WEBHOOK_TELEGRAM=""
export WEBHOOK_SLACK=""

# ----------------------------------------------------------------------------
# VARIÃVEIS GLOBAIS DO SISTEMA (MEGA ESTRUTURA)
# ----------------------------------------------------------------------------
SYSTEM_VERSION="60.2.0"
SYSTEM_BUILD="$(date +%Y%m%d_%H%M%S)"
START_TIME=$(date +%s)
SCRIPT_NAME="NiceHash Miner Ultimate - God Mode"
SCRIPT_AUTHOR="Termux God"
SCRIPT_DESCRIPTION="Sistema completo de mineraÃ§Ã£o NiceHash com troca automÃ¡tica de pools e 60+ funcionalidades"

# DiretÃ³rios raiz
MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner_god"
MINER_BIN="$MINER_ROOT/bin"
MINER_CONFIG="$MINER_ROOT/config"
MINER_LOGS="$MINER_ROOT/logs"
MINER_STATS="$MINER_ROOT/stats"
MINER_SCRIPTS="$MINER_ROOT/scripts"
MINER_TEMP="$MINER_ROOT/temp"
MINER_BACKUP="$MINER_ROOT/backup"
MINER_CACHE="$MINER_ROOT/cache"
MINER_REPORTS="$MINER_ROOT/reports"
MINER_ANALYTICS="$MINER_ROOT/analytics"
MINER_HISTORY="$MINER_ROOT/history"
MINER_DISCORD="$MINER_ROOT/discord"
MINER_TELEGRAM="$MINER_ROOT/telegram"
MINER_DIAG="$MINER_ROOT/diagnostics"
MINER_BENCH="$MINER_ROOT/benchmark"
MINER_POOLS="$MINER_ROOT/pools"
MINER_WALLETS="$MINER_ROOT/wallets"
MINER_WORKERS="$MINER_ROOT/workers"
MINER_ALGOS="$MINER_ROOT/algorithms"
MINER_PERF="$MINER_ROOT/performance"
MINER_SECURITY="$MINER_ROOT/security"
MINER_NETWORK="$MINER_ROOT/network"
MINER_HARDWARE="$MINER_ROOT/hardware"
MINER_PLUGINS="$MINER_ROOT/plugins"
MINER_MODULES="$MINER_ROOT/modules"
MINER_CRYPTO="$MINER_ROOT/crypto"
MINER_PAYMENTS="$MINER_ROOT/payments"
MINER_UPDATES="$MINER_ROOT/updates"
MINER_CRASH="$MINER_ROOT/crash"
MINER_DEBUG="$MINER_ROOT/debug"
MINER_PROFILE="$MINER_ROOT/profile"
MINER_TUNING="$MINER_ROOT/tuning"
MINER_AI="$MINER_ROOT/ai"
MINER_ML="$MINER_ROOT/machine_learning"
MINER_GOD="$MINER_ROOT/god_mode"
MINER_ECO="$MINER_ROOT/eco_mode"
MINER_TURBO="$MINER_ROOT/turbo_mode"
MINER_BENCHMARK="$MINER_ROOT/benchmark_results"
MINER_CERTIFICATES="$MINER_ROOT/certificates"
MINER_ENCRYPTION="$MINER_ROOT/encryption"
MINER_KEYS="$MINER_ROOT/keys"
MINER_SIGNATURES="$MINER_ROOT/signatures"
MINER_FIREWALL="$MINER_ROOT/firewall"
MINER_PROXY="$MINER_ROOT/proxy"
MINER_VPN="$MINER_ROOT/vpn"
MINER_TOR="$MINER_ROOT/tor"
MINER_I2P="$MINER_ROOT/i2p"
MINER_DNS="$MINER_ROOT/dns"
MINER_NTP="$MINER_ROOT/ntp"
MINER_UPTIME="$MINER_ROOT/uptime"
MINER_LOAD="$MINER_ROOT/load"
MINER_IRQ="$MINER_ROOT/irq"
MINER_SCHED="$MINER_ROOT/scheduler"
MINER_CGROUPS="$MINER_ROOT/cgroups"
MINER_NAMESPACES="$MINER_ROOT/namespaces"
MINER_SANDBOX="$MINER_ROOT/sandbox"
MINER_CONTAINER="$MINER_ROOT/container"
MINER_VIRTUAL="$MINER_ROOT/virtualization"
MINER_CLOUD="$MINER_ROOT/cloud"
MINER_EDGE="$MINER_ROOT/edge"
MINER_FOG="$MINER_ROOT/fog"
MINER_QUANTUM="$MINER_ROOT/quantum"
MINER_BLOCKCHAIN="$MINER_ROOT/blockchain"
MINER_SMART_CONTRACTS="$MINER_ROOT/smart_contracts"
MINER_DEFI="$MINER_ROOT/defi"
MINER_NFT="$MINER_ROOT/nft"
MINER_DAO="$MINER_ROOT/dao"
MINER_WEB3="$MINER_ROOT/web3"
MINER_METAVERSE="$MINER_ROOT/metaverse"

# Criar TODOS os diretÃ³rios (expansÃ£o mÃ¡xima)
for dir in \
    "$MINER_ROOT" "$MINER_BIN" "$MINER_CONFIG" "$MINER_LOGS" "$MINER_STATS" \
    "$MINER_SCRIPTS" "$MINER_TEMP" "$MINER_BACKUP" "$MINER_CACHE" "$MINER_REPORTS" \
    "$MINER_ANALYTICS" "$MINER_HISTORY" "$MINER_DISCORD" "$MINER_TELEGRAM" \
    "$MINER_DIAG" "$MINER_BENCH" "$MINER_POOLS" "$MINER_WALLETS" "$MINER_WORKERS" \
    "$MINER_ALGOS" "$MINER_PERF" "$MINER_SECURITY" "$MINER_NETWORK" \
    "$MINER_HARDWARE" "$MINER_PLUGINS" "$MINER_MODULES" "$MINER_CRYPTO" \
    "$MINER_PAYMENTS" "$MINER_UPDATES" "$MINER_CRASH" "$MINER_DEBUG" \
    "$MINER_PROFILE" "$MINER_TUNING" "$MINER_AI" "$MINER_ML" \
    "$MINER_GOD" "$MINER_ECO" "$MINER_TURBO" "$MINER_BENCHMARK" \
    "$MINER_CERTIFICATES" "$MINER_ENCRYPTION" "$MINER_KEYS" "$MINER_SIGNATURES" \
    "$MINER_FIREWALL" "$MINER_PROXY" "$MINER_VPN" "$MINER_TOR" "$MINER_I2P" \
    "$MINER_DNS" "$MINER_NTP" "$MINER_UPTIME" "$MINER_LOAD" "$MINER_IRQ" \
    "$MINER_SCHED" "$MINER_CGROUPS" "$MINER_NAMESPACES" "$MINER_SANDBOX" \
    "$MINER_CONTAINER" "$MINER_VIRTUAL" "$MINER_CLOUD" "$MINER_EDGE" \
    "$MINER_FOG" "$MINER_QUANTUM" "$MINER_BLOCKCHAIN" "$MINER_SMART_CONTRACTS" \
    "$MINER_DEFI" "$MINER_NFT" "$MINER_DAO" "$MINER_WEB3" "$MINER_METAVERSE"; do
    mkdir -p "$dir"
done

# ----------------------------------------------------------------------------
# ARQUIVOS DE LOG (150+ ARQUIVOS - COBERTURA TOTAL)
# ----------------------------------------------------------------------------
declare -a LOG_FILES=(
    "system_master.log"
    "miner_complete.log"
    "error_trace.log"
    "debug_trace.log"
    "bitcoin_earnings.log"
    "satoshi_instant.log"
    "satoshi_per_minute.log"
    "satoshi_per_hour.log"
    "satoshi_detailed.log"
    "hashrate_history.log"
    "hashrate_average.log"
    "hashrate_peak.log"
    "temperature_history.log"
    "temperature_alerts.log"
    "temperature_critical.log"
    "shares_accepted.log"
    "shares_rejected.log"
    "shares_difficulty.log"
    "pool_connections.log"
    "pool_switches.log"
    "pool_latency.log"
    "pool_failures.log"
    "pool_stats.log"
    "worker_performance.log"
    "worker_uptime.log"
    "worker_efficiency.log"
    "cpu_usage.log"
    "cpu_frequency.log"
    "cpu_throttling.log"
    "memory_usage.log"
    "memory_leak.log"
    "network_stats.log"
    "network_speed.log"
    "network_latency.log"
    "discord_notifications.log"
    "discord_errors.log"
    "discord_ratelimit.log"
    "telegram_notifications.log"
    "telegram_errors.log"
    "wallet_transactions.log"
    "wallet_balance.log"
    "wallet_payments.log"
    "profit_calculations.log"
    "profit_daily.log"
    "profit_hourly.log"
    "profit_minute.log"
    "profit_weekly.log"
    "profit_monthly.log"
    "performance_benchmark.log"
    "performance_optimization.log"
    "system_events.log"
    "system_errors.log"
    "system_warnings.log"
    "system_info.log"
    "mining_session.log"
    "mining_summary.log"
    "mining_restarts.log"
    "mining_stops.log"
    "mining_starts.log"
    "mining_crashes.log"
    "algorithm_switches.log"
    "algorithm_efficiency.log"
    "hardware_info.log"
    "hardware_throttling.log"
    "battery_usage.log"
    "thermal_throttling.log"
    "api_calls.log"
    "web_requests.log"
    "plugins_load.log"
    "events_triggered.log"
    "alerts_sent.log"
    "alerts_received.log"
    "commands_executed.log"
    "commands_history.log"
    "backup_history.log"
    "restore_history.log"
    "update_history.log"
    "pool_manager.log"
    "pool_auto_switch.log"
    "diagnostics.log"
    "benchmark_cpu.log"
    "benchmark_network.log"
    "benchmark_pool.log"
    "security_audit.log"
    "firewall_rules.log"
    "crypto_keys.log"
    "payment_confirmations.log"
    "update_checker.log"
    "crash_reports.log"
    "debug_sessions.log"
    "profile_cpu.log"
    "tuning_parameters.log"
    "ai_decisions.log"
    "ml_predictions.log"
    "god_mode_activations.log"
    "eco_mode_activations.log"
    "turbo_mode_activations.log"
    "certificate_authority.log"
    "encryption_keys.log"
    "signature_verifications.log"
    "proxy_connections.log"
    "vpn_connections.log"
    "tor_connections.log"
    "i2p_connections.log"
    "dns_resolutions.log"
    "ntp_sync.log"
    "uptime_tracking.log"
    "load_average.log"
    "irq_balance.log"
    "scheduler_stats.log"
    "cgroup_controls.log"
    "namespace_isolation.log"
    "sandbox_restrictions.log"
    "container_orchestration.log"
    "virtualization_layer.log"
    "cloud_provisioning.log"
    "edge_computing.log"
    "fog_nodes.log"
    "quantum_simulations.log"
    "blockchain_verifications.log"
    "smart_contract_executions.log"
    "defi_transactions.log"
    "nft_minting.log"
    "dao_proposals.log"
    "web3_integrations.log"
    "metaverse_assets.log"
)

for file in "${LOG_FILES[@]}"; do
    touch "$MINER_LOGS/$file"
done

# ----------------------------------------------------------------------------
# CORES (PALETA COMPLETA + 50 NOVAS CORES)
# ----------------------------------------------------------------------------
NC='\033[0m'
BLACK='\033[0;30m'; RED='\033[0;31m'; GREEN='\033[0;32m'; YELLOW='\033[1;33m'
BLUE='\033[0;34m'; PURPLE='\033[0;35m'; CYAN='\033[0;36m'; WHITE='\033[1;37m'
ORANGE='\033[38;5;208m'; PINK='\033[38;5;213m'; LIME='\033[38;5;154m'
TEAL='\033[38;5;123m'; GOLD='\033[38;5;220m'; PURPLE_BRIGHT='\033[38;5;93m'
TURQUOISE='\033[38;5;45m'; NEON_GREEN='\033[38;5;46m'; NEON_BLUE='\033[38;5;81m'
NEON_PINK='\033[38;5;201m'; MAROON='\033[38;5;52m'; OLIVE='\033[38;5;58m'
NAVY='\033[38;5;17m'; TEAL_DARK='\033[38;5;30m'; SILVER='\033[38;5;145m'
GRAY='\033[38;5;240m'; BROWN='\033[38;5;94m'; CORAL='\033[38;5;203m'
SALMON='\033[38;5;209m'; TOMATO='\033[38;5;196m'; CRIMSON='\033[38;5;160m'
FIREBRICK='\033[38;5;124m'; DARKRED='\033[38;5;88m'; DARKGREEN='\033[38;5;22m'
FORESTGREEN='\033[38;5;28m'; SEAGREEN='\033[38;5;84m'; DARKCYAN='\033[38;5;36m'
DEEPSKYBLUE='\033[38;5;39m'; DODGERBLUE='\033[38;5;33m'; ROYALBLUE='\033[38;5;63m'
INDIGO='\033[38;5;54m'; DARKVIOLET='\033[38;5;92m'; DARKMAGENTA='\033[38;5;90m'
DARKORANGE='\033[38;5;208m'; SIENNA='\033[38;5;130m'; CHOCOLATE='\033[38;5;166m'
SADDLEBROWN='\033[38;5;94m'; PERU='\033[38;5;172m'; TAN='\033[38;5;180m'
WHEAT='\033[38;5;223m'; LINEN='\033[38;5;255m'; IVORY='\033[38;5;230m'

BOLD='\033[1m'; DIM='\033[2m'; ITALIC='\033[3m'; UNDERLINE='\033[4m'
BLINK='\033[5m'; REVERSE='\033[7m'; HIDDEN='\033[8m'; STRIKE='\033[9m'
DOUBLEUNDERLINE='\033[21m'; OVERLINE='\033[53m'

COLOR_TITLE="${PURPLE_BRIGHT}${BOLD}${UNDERLINE}${BLINK}"
COLOR_SUCCESS="${GREEN}${BOLD}${BLINK}"
COLOR_WARNING="${YELLOW}${BOLD}${BLINK}"
COLOR_ERROR="${RED}${BOLD}${BLINK}"
COLOR_INFO="${CYAN}${BOLD}"
COLOR_PROFIT="${GOLD}${BOLD}${BLINK}"
COLOR_HASHRATE="${LIME}${BOLD}${BLINK}"
COLOR_TEMP="${ORANGE}${BOLD}"
COLOR_STATUS="${TEAL}${BOLD}"
COLOR_MENU="${BLUE}${BOLD}${UNDERLINE}"
COLOR_BITCOIN="${GOLD}${BOLD}${BLINK}${REVERSE}"
COLOR_SATOSHI="${YELLOW}${BOLD}${BLINK}${REVERSE}"
COLOR_NETWORK="${NEON_BLUE}${BOLD}${BLINK}"
COLOR_DEBUG="${DIM}${SILVER}"
COLOR_PERFORMANCE="${NEON_GREEN}${BOLD}${BLINK}"
COLOR_SECURITY="${MAROON}${BOLD}${BLINK}"
COLOR_WALLET="${NEON_PINK}${BOLD}${BLINK}"
COLOR_POOL="${TURQUOISE}${BOLD}${BLINK}"
COLOR_WORKER="${TEAL_DARK}${BOLD}${BLINK}"
COLOR_DISCORD="${PINK}${BOLD}${BLINK}"
COLOR_TELEGRAM="${DEEPSKYBLUE}${BOLD}"
COLOR_POOL_AUTO="${NEON_GREEN}${BOLD}${BLINK}${UNDERLINE}"
COLOR_GOD="${PURPLE_BRIGHT}${BOLD}${BLINK}${REVERSE}"
COLOR_ECO="${GREEN}${BOLD}${DIM}"
COLOR_TURBO="${RED}${BOLD}${BLINK}"
COLOR_BENCH="${ORANGE}${BOLD}"
COLOR_DIAG="${SILVER}${BOLD}"
COLOR_AI="${NEON_PINK}${BOLD}${BLINK}"
COLOR_QUANTUM="${INDIGO}${BOLD}${BLINK}"
COLOR_METAVERSE="${CORAL}${BOLD}${BLINK}"

# ----------------------------------------------------------------------------
# FUNÃ‡ÃƒO DE LOG ULTRA DETALHADA (NÃVEL DEUS)
# ----------------------------------------------------------------------------
log() {
    local level="$1"
    local module="$2"
    local msg="$3"
    local color="$4"
    local timestamp="[$(date '+%Y-%m-%d %H:%M:%S.%6N')]"
    local log_id="LOG_$(date +%s%N | sha256sum | head -c20)_${RANDOM}_${RANDOM}"
    local entry="$timestamp [$level] [$module] [ID:$log_id] $msg"

    echo "$entry" >> "$MINER_LOGS/system_master.log"
    
    case "$module" in
        MINER)      echo "$entry" >> "$MINER_LOGS/miner_complete.log" ;;
        ERROR)      echo "$entry" >> "$MINER_LOGS/error_trace.log" ;;
        DEBUG)      echo "$entry" >> "$MINER_LOGS/debug_trace.log" ;;
        BITCOIN)    echo "$entry" >> "$MINER_LOGS/bitcoin_earnings.log" ;;
        SATOSHI)    echo "$entry" >> "$MINER_LOGS/satoshi_detailed.log" ;;
        HASHRATE)   echo "$entry" >> "$MINER_LOGS/hashrate_history.log" ;;
        TEMP)       echo "$entry" >> "$MINER_LOGS/temperature_history.log" ;;
        SHARE)      echo "$entry" >> "$MINER_LOGS/shares_accepted.log" ;;
        POOL)       echo "$entry" >> "$MINER_LOGS/pool_connections.log" ;;
        DISCORD)    echo "$entry" >> "$MINER_LOGS/discord_notifications.log" ;;
        TELEGRAM)   echo "$entry" >> "$MINER_LOGS/telegram_notifications.log" ;;
        CMD)        echo "$entry" >> "$MINER_LOGS/commands_executed.log" ;;
        POOL_MGR)   echo "$entry" >> "$MINER_LOGS/pool_manager.log" ;;
        POOL_SW)    echo "$entry" >> "$MINER_LOGS/pool_auto_switch.log" ;;
        BENCH)      echo "$entry" >> "$MINER_LOGS/benchmark_cpu.log" ;;
        DIAG)       echo "$entry" >> "$MINER_LOGS/diagnostics.log" ;;
        AI)         echo "$entry" >> "$MINER_LOGS/ai_decisions.log" ;;
        GOD)        echo "$entry" >> "$MINER_LOGS/god_mode_activations.log" ;;
        ECO)        echo "$entry" >> "$MINER_LOGS/eco_mode_activations.log" ;;
        TURBO)      echo "$entry" >> "$MINER_LOGS/turbo_mode_activations.log" ;;
        SECURITY)   echo "$entry" >> "$MINER_LOGS/security_audit.log" ;;
        NETWORK)    echo "$entry" >> "$MINER_LOGS/network_stats.log" ;;
        WALLET)     echo "$entry" >> "$MINER_LOGS/wallet_transactions.log" ;;
        PROFIT)     echo "$entry" >> "$MINER_LOGS/profit_calculations.log" ;;
        PERF)       echo "$entry" >> "$MINER_LOGS/performance_benchmark.log" ;;
        EVENT)      echo "$entry" >> "$MINER_LOGS/system_events.log" ;;
        CRASH)      echo "$entry" >> "$MINER_LOGS/crash_reports.log" ;;
        UPDATE)     echo "$entry" >> "$MINER_LOGS/update_history.log" ;;
        BACKUP)     echo "$entry" >> "$MINER_LOGS/backup_history.log" ;;
        *)          echo "$entry" >> "$MINER_LOGS/system_master.log" ;;
    esac

    case "$level" in
        ERROR|CRITICAL|FATAL) 
            echo "$entry" >> "$MINER_LOGS/system_errors.log"
            echo "$entry" >> "$MINER_LOGS/error_trace.log"
            ;;
        WARNING) 
            echo "$entry" >> "$MINER_LOGS/system_warnings.log"
            ;;
        INFO|SUCCESS) 
            echo "$entry" >> "$MINER_LOGS/system_info.log"
            ;;
        DEBUG) 
            echo "$entry" >> "$MINER_LOGS/debug_trace.log"
            ;;
    esac

    if [ -n "$color" ]; then
        echo -e "${color}[$level] [$module]${NC} $msg"
    else
        echo "[$level] [$module] $msg"
    fi
}

log_sys()    { log "INFO"    "SYSTEM"    "$1" "$COLOR_INFO"; }
log_miner()  { log "INFO"    "MINER"     "$1" "$COLOR_INFO"; }
log_success(){ log "SUCCESS" "SYSTEM"    "$1" "$COLOR_SUCCESS"; }
log_warn()   { log "WARNING" "SYSTEM"    "$1" "$COLOR_WARNING"; }
log_error()  { log "ERROR"   "ERROR"     "$1" "$COLOR_ERROR"; }
log_debug()  { log "DEBUG"   "DEBUG"     "$1" "$COLOR_DEBUG"; }
log_cmd()    { log "COMMAND" "CMD"       "$1" "$COLOR_MENU"; }
log_pool()   { log "INFO"    "POOL"      "$1" "$COLOR_POOL"; }
log_pool_auto() { log "INFO" "POOL_MGR"  "$1" "$COLOR_POOL_AUTO"; }
log_bitcoin(){ log "BITCOIN" "BITCOIN"   "$1" "$COLOR_BITCOIN"; }
log_god()    { log "GOD"     "GOD"       "$1" "$COLOR_GOD"; }
log_eco()    { log "ECO"     "ECO"       "$1" "$COLOR_ECO"; }
log_turbo()  { log "TURBO"   "TURBO"     "$1" "$COLOR_TURBO"; }
log_bench()  { log "BENCH"   "BENCH"     "$1" "$COLOR_BENCH"; }
log_diag()   { log "DIAG"    "DIAG"      "$1" "$COLOR_DIAG"; }
log_ai()     { log "AI"      "AI"        "$1" "$COLOR_AI"; }

# ----------------------------------------------------------------------------
# FUNÃ‡ÃƒO SEGURA PARA LEITURA DE INPUT (CORAÃ‡ÃƒO DA CORREÃ‡ÃƒO)
# ----------------------------------------------------------------------------
safe_read() {
    local prompt="$1"
    local var_name="$2"
    local timeout="$3"
    local input=""
    
    if [ -n "$timeout" ] && [ "$timeout" -gt 0 ]; then
        if [ -e /dev/tty ]; then
            read -t "$timeout" -p "$prompt" input < /dev/tty
        else
            read -t "$timeout" -p "$prompt" input
        fi
    else
        if [ -e /dev/tty ]; then
            read -p "$prompt" input < /dev/tty
        else
            read -p "$prompt" input
        fi
    fi
    eval "$var_name=\"$input\""
}

# ----------------------------------------------------------------------------
# LOG DE SATOSHI EM TEMPO REAL (FORMATO IGUAL Ã€ IMAGEM - VERSÃƒO DEUS)
# ----------------------------------------------------------------------------
log_satoshi_god() {
    local sats="$1"
    local hashrate="$2"
    local temp="$3"
    local total="$4"
    local usd_hour="$5"
    local algo="$6"
    local pool="$7"
    local worker="$8"
    local btc_day="$9"
    local usd_day="${10}"
    local efficiency="${11}"
    local shares_this_session="${12}"
    local uptime_minutes="${13}"
    local timestamp="$(date '+%H:%M:%S')"

    echo "========================================" >> "$MINER_LOGS/satoshi_instant.log"
    echo "ðŸ”¥ SATOSHI MINERADO (MODO DEUS) - $timestamp" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Quantidade: $sats sats" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Hashrate: $hashrate H/s" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Temperatura: $tempÂ°C" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Total acumulado: $total sats" >> "$MINER_LOGS/satoshi_instant.log"
    echo "USD/hora: \$$usd_hour" >> "$MINER_LOGS/satoshi_instant.log"
    echo "USD/dia: \$$usd_day" >> "$MINER_LOGS/satoshi_instant.log"
    echo "BTC/dia: $btc_day BTC" >> "$MINER_LOGS/satoshi_instant.log"
    echo "EficiÃªncia: $efficiency%" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Shares nesta sessÃ£o: $shares_this_session" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Uptime: $uptime_minutes minutos" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Algoritmo: $algo" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Pool: $pool" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Worker: $worker" >> "$MINER_LOGS/satoshi_instant.log"
    echo "Carteira: $WALLET_NICEHASH" >> "$MINER_LOGS/satoshi_instant.log"
    echo "========================================" >> "$MINER_LOGS/satoshi_instant.log"

    echo -e "${COLOR_SATOSHI}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                        ðŸ”¥ SATOSHI MINERADO - MODO DEUS ðŸ”¥                        â•‘"
    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "â•‘                                                                                  â•‘"
    echo "â•‘  â° Hora: ${timestamp}                                                        â•‘"
    echo "â•‘  âš¡ Hashrate Atual: ${hashrate} H/s                                             â•‘"
    echo "â•‘  ðŸŒ¡ï¸  Temperatura: ${temp}Â°C                                                    â•‘"
    echo "â•‘  ðŸ’° Satoshis nesta transaÃ§Ã£o: ${sats} sats                                      â•‘"
    echo "â•‘  ðŸ“Š Ãšltima mineraÃ§Ã£o: ${sats} satoshis                                          â•‘"
    echo "â•‘                                                                                  â•‘"
    echo "â•‘  ðŸ“ˆ Total Acumulado: ${total} satoshis                                          â•‘"
    echo "â•‘  ðŸ’µ Estimativa USD/hora: \$${usd_hour}                                          â•‘"
    echo "â•‘  ðŸ’µ Estimativa USD/dia: \$${usd_day}                                            â•‘"
    echo "â•‘  â‚¿ Estimativa BTC/dia: ${btc_day} BTC                                           â•‘"
    echo "â•‘  ðŸŽ¯ EficiÃªncia: ${efficiency}%                                                  â•‘"
    echo "â•‘  âœ… Shares nesta sessÃ£o: ${shares_this_session}                                 â•‘"
    echo "â•‘  â±ï¸  Uptime: ${uptime_minutes} minutos                                          â•‘"
    echo "â•‘                                                                                  â•‘"
    echo "â•‘  ðŸ”§ Algoritmo: ${algo}                                                          â•‘"
    echo "â•‘  ðŸŒ Pool: ${pool}                                                               â•‘"
    echo "â•‘  ðŸ†” Worker: ${worker}                                                           â•‘"
    echo "â•‘                                                                                  â•‘"
    echo "â•‘  ðŸ‘› Carteira: ${WALLET_NICEHASH:0:20}...                                        â•‘"
    echo "â•‘                                                                                  â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"

    echo "$total" > "$MINER_STATS/total_satoshis"
    echo "$hashrate" > "$MINER_STATS/current_hashrate"
    echo "$temp" > "$MINER_STATS/current_temperature"
    echo "$usd_hour" > "$MINER_STATS/usd_per_hour"
    echo "$usd_day" > "$MINER_STATS/usd_per_day"
    echo "$btc_day" > "$MINER_STATS/btc_per_day"
    echo "$efficiency" > "$MINER_STATS/efficiency"
    echo "$shares_this_session" > "$MINER_STATS/shares_total"
    echo "$uptime_minutes" > "$MINER_STATS/uptime_minutes"

    echo "$(date '+%Y-%m-%d %H:%M:%S'),$sats,$hashrate,$temp,$total,$usd_hour,$usd_day,$btc_day,$efficiency,$shares_this_session,$uptime_minutes,$algo,$pool,$worker" >> "$MINER_LOGS/satoshi_per_minute.log"

    discord_satoshi_god "$sats" "$hashrate" "$temp" "$total" "$usd_hour" "$usd_day" "$btc_day" "$efficiency" "$algo"
    telegram_send "ðŸ’° SATOSHI MINERADO: $sats sats | HASHRATE: $hashrate H/s | TOTAL: $total sats"
}

# ----------------------------------------------------------------------------
# SISTEMA DE NOTIFICAÃ‡Ã•ES MULTI-PLATAFORMA (DISCORD, TELEGRAM, SLACK)
# ----------------------------------------------------------------------------
discord_send() {
    local message="$1"
    local color="$2"
    local title="$3"

    if [ -z "$WEBHOOK_DISCORD" ] || [[ "$WEBHOOK_DISCORD" == *"example.com"* ]]; then
        return 1
    fi

    message=$(echo "$message" | cut -c1-1900)

    local json=$(cat <<EOF
{
  "embeds": [{
    "title": "$title",
    "description": "$message",
    "color": $color,
    "timestamp": "$(date -u +'%Y-%m-%dT%H:%M:%S.000Z')",
    "footer": {"text": "NiceHash Miner God v$SYSTEM_VERSION â€¢ $(date '+%H:%M:%S')"}
  }]
}
EOF
)

    local response=$(curl -s -w "%{http_code}" -o /tmp/discord_last.txt \
        -H "Content-Type: application/json" -X POST -d "$json" "$WEBHOOK_DISCORD" 2>/dev/null)

    if [[ "$response" == "204" || "$response" == "200" ]]; then
        log "INFO" "DISCORD" "Mensagem enviada: $title" "$COLOR_DISCORD"
        echo "$(date '+%Y-%m-%d %H:%M:%S') | ENVIADO | $title" >> "$MINER_LOGS/discord_notifications.log"
        return 0
    else
        log_error "Falha ao enviar para Discord (HTTP $response)"
        echo "$(date '+%Y-%m-%d %H:%M:%S') | ERRO | $title | HTTP $response" >> "$MINER_LOGS/discord_errors.log"
        return 1
    fi
}

discord_satoshi_god() {
    local message="ðŸ”¥ **SATOSHI MINERADO - MODO DEUS** ðŸ”¥\n\n"
    message+="**Quantidade:** $1 sats\n"
    message+="**Hashrate:** $2 H/s\n"
    message+="**Temperatura:** $3Â°C\n"
    message+="**Total acumulado:** $4 sats\n"
    message+="**USD/hora:** \$$5\n"
    message+="**USD/dia:** \$$6\n"
    message+="**BTC/dia:** $7 BTC\n"
    message+="**EficiÃªncia:** $8%\n"
    message+="**Algoritmo:** $9\n\n"
    message+="**Carteira:** ${WALLET_NICEHASH:0:20}..."
    discord_send "$message" "16753920" "ðŸ”¥ SATOSHI MINERADO - MODO DEUS"
}

discord_mining_start_god() {
    local message="ðŸš€ **MINERAÃ‡ÃƒO INICIADA - MODO DEUS** ðŸš€\n\n"
    message+="**Worker:** $1\n"
    message+="**Algoritmo:** $2\n"
    message+="**Pool:** $3\n"
    message+="**Threads:** $CPU_THREADS\n"
    message+="**Prioridade:** $CPU_PRIORITY\n"
    message+="**Modo:** GOD\n"
    message+="**Carteira:** ${WALLET_NICEHASH:0:12}...\n\n"
    message+="_Que os deuses da mineraÃ§Ã£o estejam com vocÃª!_"
    discord_send "$message" "3066993" "ðŸš€ MINERAÃ‡ÃƒO INICIADA - MODO DEUS"
}

discord_mining_stop_god() {
    local message="ðŸ›‘ **MINERAÃ‡ÃƒO PARADA** ðŸ›‘\n\n"
    message+="**Uptime:** $1\n"
    message+="**Satoshis minerados:** $2 sats\n"
    message+="**Shares:** $3\n"
    message+="**USD estimado:** \$$4\n"
    message+="**BTC estimado:** $5 BTC\n\n"
    message+="_AtÃ© a prÃ³xima, minerador divino._"
    discord_send "$message" "15158332" "ðŸ›‘ MINERAÃ‡ÃƒO PARADA"
}

discord_pool_switch_god() {
    local message="ðŸ”„ **POOL ALTERADA - MODO DEUS** ðŸ”„\n\n"
    message+="**De:** $1\n"
    message+="**Para:** $2\n"
    message+="**LatÃªncia:** $3 ms\n"
    message+="**Motivo:** $4\n\n"
    message+="_A pool mais rÃ¡pida foi escolhida._"
    discord_send "$message" "3447003" "ðŸ”„ POOL ALTERADA"
}

discord_error_god() {
    local message="âŒ **ERRO CRÃTICO - MODO DEUS** âŒ\n\n"
    message+="$1\n\n"
    message+="_Verifique os logs imediatamente._"
    discord_send "$message" "15158332" "âŒ ERRO CRÃTICO"
}

discord_daily_report_god() {
    local message="ðŸ“ˆ **RELATÃ“RIO DIÃRIO - MODO DEUS** ðŸ“ˆ\n\n"
    message+="**Satoshis (hoje):** $1 sats\n"
    message+="**Shares (hoje):** $2\n"
    message+="**Tempo ativo:** $3 horas\n"
    message+="**BTC estimado:** $4 BTC\n"
    message+="**USD estimado:** \$$5\n"
    message+="**Hashrate mÃ©dio:** $6 H/s\n"
    message+="**Temperatura mÃ©dia:** $7Â°C\n"
    message+="**EficiÃªncia mÃ©dia:** $8%\n\n"
    message+="_Ã“timo trabalho, minerador divino!_"
    discord_send "$message" "15844367" "ðŸ“ˆ RELATÃ“RIO DIÃRIO"
}

discord_benchmark_complete() {
    local message="ðŸ§ª **BENCHMARK COMPLETO** ðŸ§ª\n\n"
    message+="**CPU Score:** $1\n"
    message+="**Network Score:** $2\n"
    message+="**Pool Score:** $3\n"
    message+="**Hashrate estimado:** $4 H/s\n"
    message+="**Temperatura mÃ¡xima:** $5Â°C\n\n"
    message+="_Sistema pronto para o modo Deus._"
    discord_send "$message" "12370112" "ðŸ§ª BENCHMARK COMPLETO"
}

telegram_send() {
    if [ -z "$WEBHOOK_TELEGRAM" ]; then
        return 1
    fi
    local message="$1"
    curl -s -X POST "https://api.telegram.org/bot${WEBHOOK_TELEGRAM}/sendMessage" \
        -d chat_id="@nicehash_miner" \
        -d text="$message" \
        -d parse_mode="Markdown" >/dev/null 2>&1
}

# ----------------------------------------------------------------------------
# CONFIGURAÃ‡Ã•ES DE HARDWARE E OTIMIZAÃ‡ÃƒO (NÃVEL DEUS)
# ----------------------------------------------------------------------------
CPU_THREADS=$(($(nproc 2>/dev/null || echo 1) - 1))
[ $CPU_THREADS -lt 1 ] && CPU_THREADS=1
CPU_PRIORITY=5
CPU_MAX=85
DONATE_LEVEL=0
HUGE_PAGES=true
AUTO_OPTIMIZE=true
GOD_MODE_ACTIVE=false
ECO_MODE_ACTIVE=false
TURBO_MODE_ACTIVE=false

# ----------------------------------------------------------------------------
# POOLS NICEHASH (50+ POOLS - EXPANSÃƒO COMPLETA)
# ----------------------------------------------------------------------------
declare -a POOLS_NICEHASH=(
    "randomxmonero.auto.nicehash.com:9200"
    "randomxmonero.eu.nicehash.com:3380"
    "randomxmonero.usa.nicehash.com:3380"
    "randomxmonero.br.nicehash.com:3380"
    "randomxmonero.jp.nicehash.com:3380"
    "randomxmonero.sg.nicehash.com:3380"
    "randomxmonero.hk.nicehash.com:3380"
    "randomxmonero.in.nicehash.com:3380"
    "randomxmonero.au.nicehash.com:3380"
    "randomxmonero.ca.nicehash.com:3380"
    "kawpow.auto.nicehash.com:9200"
    "kawpow.eu.nicehash.com:3380"
    "kawpow.usa.nicehash.com:3380"
    "kawpow.br.nicehash.com:3380"
    "kawpow.jp.nicehash.com:3380"
    "kawpow.sg.nicehash.com:3380"
    "kawpow.hk.nicehash.com:3380"
    "kawpow.au.nicehash.com:3380"
    "etchash.auto.nicehash.com:9200"
    "etchash.eu.nicehash.com:3380"
    "etchash.usa.nicehash.com:3380"
    "etchash.br.nicehash.com:3380"
    "etchash.jp.nicehash.com:3380"
    "etchash.sg.nicehash.com:3380"
    "octopus.auto.nicehash.com:9200"
    "octopus.eu.nicehash.com:3380"
    "octopus.usa.nicehash.com:3380"
    "octopus.br.nicehash.com:3380"
    "octopus.jp.nicehash.com:3380"
    "autolykos2.auto.nicehash.com:9200"
    "autolykos2.eu.nicehash.com:3380"
    "autolykos2.usa.nicehash.com:3380"
    "autolykos2.br.nicehash.com:3380"
    "autolykos2.jp.nicehash.com:3380"
    "zelhash.auto.nicehash.com:9200"
    "zelhash.eu.nicehash.com:3380"
    "zelhash.usa.nicehash.com:3380"
    "zelhash.br.nicehash.com:3380"
    "beamhash.auto.nicehash.com:9200"
    "beamhash.eu.nicehash.com:3380"
    "beamhash.usa.nicehash.com:3380"
    "beamhash.br.nicehash.com:3380"
    "cuckaroo29.auto.nicehash.com:9200"
    "cuckaroo29.eu.nicehash.com:3380"
    "cuckaroo29.usa.nicehash.com:3380"
    "cuckaroo29.br.nicehash.com:3380"
    "cuckatoo32.auto.nicehash.com:9200"
    "cuckatoo32.eu.nicehash.com:3380"
    "cuckatoo32.usa.nicehash.com:3380"
    "eaglesong.auto.nicehash.com:9200"
    "eaglesong.eu.nicehash.com:3380"
    "eaglesong.usa.nicehash.com:3380"
    "handshake.auto.nicehash.com:9200"
    "handshake.eu.nicehash.com:3380"
    "handshake.usa.nicehash.com:3380"
    "cortex.auto.nicehash.com:9200"
    "cortex.eu.nicehash.com:3380"
    "cortex.usa.nicehash.com:3380"
    "cryptonightr.auto.nicehash.com:9200"
    "cryptonightr.eu.nicehash.com:3380"
    "cryptonightr.usa.nicehash.com:3380"
    "cryptonightgpu.auto.nicehash.com:9200"
    "cryptonightgpu.eu.nicehash.com:3380"
    "randomarq.auto.nicehash.com:9200"
    "randomarq.eu.nicehash.com:3380"
    "randomxl.auto.nicehash.com:9200"
    "randomxl.eu.nicehash.com:3380"
    "randomsfx.auto.nicehash.com:9200"
    "randomsfx.eu.nicehash.com:3380"
    "randomwow.auto.nicehash.com:9200"
    "randomwow.eu.nicehash.com:3380"
)

ACTIVE_POOL_COUNT=${#POOLS_NICEHASH[@]}

# ----------------------------------------------------------------------------
# FUNÃ‡ÃƒO DE DESINSTALAÃ‡ÃƒO DO XMRIG (NOVO)
# ----------------------------------------------------------------------------
uninstall_xmrig() {
    log_sys "Verificando instalaÃ§Ãµes existentes do XMRig..."
    local found=0

    if [ -f "$MINER_BIN/xmrig" ]; then
        rm -f "$MINER_BIN/xmrig"
        log_sys "BinÃ¡rio local removido: $MINER_BIN/xmrig"
        found=1
    fi

    if command -v xmrig &>/dev/null; then
        pkg uninstall -y xmrig 2>/dev/null
        log_sys "Pacote xmrig removido via pkg"
        found=1
    fi

    if [ -f "$PREFIX/bin/xmrig" ]; then
        rm -f "$PREFIX/bin/xmrig"
        log_sys "BinÃ¡rio em $PREFIX/bin/xmrig removido"
        found=1
    fi

    if [ $found -eq 1 ]; then
        log_success "XMRig desinstalado com sucesso."
    else
        log_sys "Nenhuma instalaÃ§Ã£o anterior do XMRig encontrada."
    fi
}

# ----------------------------------------------------------------------------
# 60+ MÃ‰TODOS DE DOWNLOAD DO XMRIG (COM DESINSTALAÃ‡ÃƒO PRÃ‰VIA)
# ----------------------------------------------------------------------------
install_xmrig_god() {
    log_sys "ðŸ”¥ Iniciando instalaÃ§Ã£o do XMRig com 60+ mÃ©todos (Modo Deus)..."

    # --- NOVO: Remove qualquer versÃ£o existente antes de instalar ---
    uninstall_xmrig

    # MÃ©todo 1: pkg install (Termux oficial)
    log_sys "MÃ©todo 1: InstalaÃ§Ã£o via pkg"
    if pkg install -y xmrig 2>/dev/null; then
        if command -v xmrig &>/dev/null; then
            cp "$(command -v xmrig)" "$MINER_BIN/xmrig"
            log_success "XMRig instalado via pkg (Modo Deus)"
            return 0
        fi
    fi

    # MÃ©todo 2: GitHub Release ARM64 v6.21.0
    log_sys "MÃ©todo 2: GitHub ARM64 v6.21.0"
    cd "$MINER_TEMP" || return 1
    if wget -q --timeout=15 --tries=3 "https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz" -O xmrig_2.tar.gz; then
        tar -xzf xmrig_2.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 2 OK (ARM64)" && return 0
    fi

    # MÃ©todo 3: GitHub Release ARMHF v6.21.0
    log_sys "MÃ©todo 3: GitHub ARMHF v6.21.0"
    if wget -q --timeout=15 --tries=3 "https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-armhf.tar.gz" -O xmrig_3.tar.gz; then
        tar -xzf xmrig_3.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 3 OK (ARMHF)" && return 0
    fi

    # MÃ©todo 4: GitHub Latest API
    log_sys "MÃ©todo 4: GitHub Latest API"
    latest_url=$(curl -s https://api.github.com/repos/xmrig/xmrig/releases/latest 2>/dev/null | grep -o "https://.*linux-static-arm64.tar.gz" | head -1)
    if [ -n "$latest_url" ] && wget -q --timeout=15 --tries=3 "$latest_url" -O xmrig_4.tar.gz; then
        tar -xzf xmrig_4.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 4 OK (Latest)" && return 0
    fi

    # MÃ©todo 5: Mirror xmrig.com
    log_sys "MÃ©todo 5: Mirror xmrig.com"
    if wget -q --timeout=15 --tries=3 "https://xmrig.com/download/xmrig-6.21.0-linux-arm64.tar.gz" -O xmrig_5.tar.gz; then
        tar -xzf xmrig_5.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 5 OK (xmrig.com)" && return 0
    fi

    # MÃ©todo 6: Mirror fastgit
    log_sys "MÃ©todo 6: Mirror fastgit"
    if wget -q --timeout=15 --tries=3 "https://download.fastgit.org/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz" -O xmrig_6.tar.gz; then
        tar -xzf xmrig_6.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 6 OK (fastgit)" && return 0
    fi

    # MÃ©todo 7: Mirror ghproxy
    log_sys "MÃ©todo 7: Mirror ghproxy"
    if wget -q --timeout=15 --tries=3 "https://ghproxy.com/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz" -O xmrig_7.tar.gz; then
        tar -xzf xmrig_7.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 7 OK (ghproxy)" && return 0
    fi

    # MÃ©todo 8: Mirror kgithub
    log_sys "MÃ©todo 8: Mirror kgithub"
    if wget -q --timeout=15 --tries=3 "https://kgithub.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz" -O xmrig_8.tar.gz; then
        tar -xzf xmrig_8.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 8 OK (kgithub)" && return 0
    fi

    # MÃ©todo 9: GitHub v6.20.0
    log_sys "MÃ©todo 9: GitHub v6.20.0"
    if wget -q --timeout=15 --tries=3 "https://github.com/xmrig/xmrig/releases/download/v6.20.0/xmrig-6.20.0-linux-arm64.tar.gz" -O xmrig_9.tar.gz; then
        tar -xzf xmrig_9.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 9 OK (v6.20.0)" && return 0
    fi

    # MÃ©todo 10: GitHub v6.19.0
    log_sys "MÃ©todo 10: GitHub v6.19.0"
    if wget -q --timeout=15 --tries=3 "https://github.com/xmrig/xmrig/releases/download/v6.19.0/xmrig-6.19.0-linux-arm64.tar.gz" -O xmrig_10.tar.gz; then
        tar -xzf xmrig_10.tar.gz 2>/dev/null
        bin=$(find . -name "xmrig" -type f -executable | head -1)
        [ -n "$bin" ] && cp "$bin" "$MINER_BIN/xmrig" && chmod +x "$MINER_BIN/xmrig" && log_success "MÃ©todo 10 OK (v6.19.0)" && return 0
    fi

    # MÃ©todo 11-60: Diversos mirrors e versÃµes alternativas
    local mirrors=(
        "https://hub.fastgit.xyz/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://github.91chi.fun/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://pd.zwc365.com/seturl/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://slink.ltd/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://gh.api.99988866.xyz/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://ghps.cc/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://github.xuyisheng.top/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://gh.con.sh/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://dgithub.xyz/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://git.xiaoge.net/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://gh.ddlc.top/https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://hub.nuaa.cf/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://hub.yzuu.cf/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://hub.fgit.cf/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://hub.fgit.ml/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://gh.api.codes/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.18.0/xmrig-6.18.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.17.0/xmrig-6.17.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.16.0/xmrig-6.16.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.15.0/xmrig-6.15.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.14.0/xmrig-6.14.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.13.0/xmrig-6.13.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.12.0/xmrig-6.12.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.11.0/xmrig-6.11.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.10.0/xmrig-6.10.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.9.0/xmrig-6.9.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.8.0/xmrig-6.8.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.7.0/xmrig-6.7.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.6.0/xmrig-6.6.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.5.0/xmrig-6.5.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.4.0/xmrig-6.4.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.3.0/xmrig-6.3.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.2.0/xmrig-6.2.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.1.0/xmrig-6.1.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v6.0.0/xmrig-6.0.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.11.0/xmrig-5.11.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.10.0/xmrig-5.10.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.9.0/xmrig-5.9.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.8.0/xmrig-5.8.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.7.0/xmrig-5.7.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.6.0/xmrig-5.6.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.5.0/xmrig-5.5.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.4.0/xmrig-5.4.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.3.0/xmrig-5.3.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.2.0/xmrig-5.2.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.1.0/xmrig-5.1.0-linux-arm64.tar.gz"
        "https://github.com/xmrig/xmrig/releases/download/v5.0.0/xmrig-5.0.0-linux-arm64.tar.gz"
    )

    local i=11
    for mirror in "${mirrors[@]}"; do
        log_sys "MÃ©todo $i: Mirror alternativo"
        if wget -q --timeout=10 --tries=2 "$mirror" -O "xmrig_$i.tar.gz"; then
            tar -xzf "xmrig_$i.tar.gz" 2>/dev/null
            bin=$(find . -name "xmrig" -type f -executable | head -1)
            if [ -n "$bin" ]; then
                cp "$bin" "$MINER_BIN/xmrig"
                chmod +x "$MINER_BIN/xmrig"
                log_success "MÃ©todo $i OK (mirror)"
                return 0
            fi
        fi
        ((i++))
        [ $i -gt 60 ] && break
    done

    # Ãšltimo recurso: compilar do cÃ³digo fonte
    log_sys "MÃ©todo final: Compilar do cÃ³digo fonte (Demorado)"
    pkg install -y git cmake make libuv libuv-dev openssl libhwloc -y 2>/dev/null
    cd "$MINER_TEMP"
    git clone https://github.com/xmrig/xmrig.git --depth=1 2>/dev/null
    cd xmrig
    mkdir -p build && cd build
    cmake .. -DWITH_HTTPD=OFF -DWITH_TLS=OFF -DCMAKE_BUILD_TYPE=Release 2>/dev/null
    if make -j$CPU_THREADS 2>/dev/null; then
        cp xmrig "$MINER_BIN/xmrig"
        chmod +x "$MINER_BIN/xmrig"
        log_success "XMRig compilado com sucesso (Modo Deus)"
        return 0
    fi

    log_error "Todos os 60+ mÃ©todos falharam! Verifique sua conexÃ£o."
    discord_error_god "Falha na instalaÃ§Ã£o do XMRig. ConexÃ£o com internet pode estar offline."
    return 1
}

# ----------------------------------------------------------------------------
# GERENCIADOR DE POOLS - TESTE DE LATÃŠNCIA AVANÃ‡ADO
# ----------------------------------------------------------------------------
test_pool_latency() {
    local pool="$1"
    local host=$(echo "$pool" | cut -d: -f1)
    local port=$(echo "$pool" | cut -d: -f2)

    local start_time=$(date +%s%3N)
    if timeout 3 nc -z -w 2 "$host" "$port" 2>/dev/null; then
        local end_time=$(date +%s%3N)
        local latency=$((end_time - start_time))
        echo "$latency"
        return 0
    else
        echo "9999"
        return 1
    fi
}

select_best_pool_god() {
    log_pool_auto "ðŸ”¥ Testando latÃªncia de ${ACTIVE_POOL_COUNT} pools (Modo Deus)..."
    local best_pool=""
    local best_latency=9999
    local results_file="$MINER_TEMP/pool_test_god_$$.tmp"
    local pool_scores=()

    > "$results_file"

    local i=1
    for pool in "${POOLS_NICEHASH[@]}"; do
        echo -ne "\rTestando pool $i/${ACTIVE_POOL_COUNT}..."
        local latency=$(test_pool_latency "$pool")
        if [ "$latency" -lt 9999 ]; then
            echo "$latency $pool" >> "$results_file"
            pool_scores+=("$latency")
            if [ "$latency" -lt "$best_latency" ]; then
                best_latency="$latency"
                best_pool="$pool"
            fi
        fi
        ((i++))
    done
    echo ""

    if [ -s "$results_file" ]; then
        local total_latency=0
        local count=0
        while read -r line; do
            lat=$(echo "$line" | awk '{print $1}')
            total_latency=$((total_latency + lat))
            count=$((count + 1))
        done < "$results_file"
        local avg_latency=$((total_latency / count))
        
        log_pool_auto "MÃ©dia de latÃªncia: ${avg_latency}ms"
        log_pool_auto "Melhor pool: $best_pool (${best_latency}ms)"
        
        echo "$(date '+%Y-%m-%d %H:%M:%S') | Melhor: $best_pool (${best_latency}ms) | MÃ©dia: ${avg_latency}ms | Pools testadas: $count" >> "$MINER_LOGS/pool_latency.log"
        sort -n "$results_file" | head -10 >> "$MINER_LOGS/pool_manager.log"
    else
        log_error "Nenhuma pool NiceHash acessÃ­vel! Usando pool padrÃ£o."
        best_pool="${POOLS_NICEHASH[0]}"
        best_latency=0
    fi

    rm -f "$results_file"
    echo "$best_pool"
}

# ----------------------------------------------------------------------------
# TROCA AUTOMÃTICA DE POOL (NÃVEL DEUS)
# ----------------------------------------------------------------------------
auto_switch_pool_god() {
    log_pool_auto "ðŸ”¥ Iniciando rotina automÃ¡tica de seleÃ§Ã£o de pool (Modo Deus)..."

    local current_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
    local best_pool=$(select_best_pool_god)
    local best_latency=$(test_pool_latency "$best_pool")
    local current_latency=9999

    if [ -n "$current_pool" ]; then
        current_latency=$(test_pool_latency "$current_pool")
    else
        current_pool="nenhuma"
    fi

    if [ "$best_pool" != "$current_pool" ] && { [ "$best_latency" -lt "$((current_latency - 50))" ] || [ "$current_latency" -eq 9999 ]; }; then
        log_pool_auto "Trocando pool: $current_pool (${current_latency}ms) -> $best_pool (${best_latency}ms)"
        discord_pool_switch_god "$current_pool" "$best_pool" "$best_latency" "OtimizaÃ§Ã£o automÃ¡tica (latÃªncia melhor)"
        switch_pool_god "$best_pool" "otimizaÃ§Ã£o automÃ¡tica (latÃªncia ${best_latency}ms)"
    else
        log_pool_auto "Pool atual jÃ¡ Ã© a melhor ou estÃ¡ dentro do limite aceitÃ¡vel (${current_latency}ms). Nenhuma troca necessÃ¡ria."
    fi
}

# ----------------------------------------------------------------------------
# TROCA MANUAL DE POOL (NÃVEL DEUS)
# ----------------------------------------------------------------------------
switch_pool_god() {
    local new_pool="$1"
    local reason="${2:-manual}"

    if [ ! -f "$MINER_CONFIG/config.json" ]; then
        log_error "ConfiguraÃ§Ã£o nÃ£o encontrada. Execute configure_miner primeiro."
        return 1
    fi

    local old_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)

    sed -i "s|\"url\": \".*\"|\"url\": \"$new_pool\"|" "$MINER_CONFIG/config.json"
    sed -i "s|^POOL=.*|POOL=$new_pool|" "$MINER_CONFIG/worker.info"

    log_success "Pool alterada para: $new_pool"
    log "INFO" "POOL_SW" "Troca de pool: $old_pool -> $new_pool (motivo: $reason)" "$COLOR_POOL"

    local latency=$(test_pool_latency "$new_pool")
    discord_pool_switch_god "${old_pool:-desconhecida}" "$new_pool" "$latency" "$reason"

    if pgrep -f xmrig >/dev/null; then
        log_miner "Reiniciando mineraÃ§Ã£o com nova pool..."
        restart_mining_god
    fi
}

# ----------------------------------------------------------------------------
# VERIFICAÃ‡ÃƒO DE FALHAS DA POOL (FALLBACK IMEDIATO)
# ----------------------------------------------------------------------------
check_pool_failure_god() {
    if pgrep -f xmrig >/dev/null; then
        local current_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        if [ -n "$current_pool" ]; then
            local latency=$(test_pool_latency "$current_pool")
            if [ "$latency" -eq 9999 ]; then
                log_warn "ðŸ”¥ POOL ATUAL $current_pool INACESSÃVEL! Acionando fallback imediato..."
                discord_send "âš ï¸ **FALLBACK IMEDIATO** âš ï¸\n\nPool atual $current_pool estÃ¡ fora do ar. Buscando nova pool..." "16753920" "âš ï¸ FALLBACK IMEDIATO"
                auto_switch_pool_god
            fi
        fi
    fi
}

# ----------------------------------------------------------------------------
# CONFIGURAÃ‡ÃƒO DO MINERADOR (NICEHASH - NÃVEL DEUS)
# ----------------------------------------------------------------------------
configure_miner_god() {
    log_sys "ðŸ”¥ Configurando minerador para NiceHash (Modo Deus)..."

    local worker_id="god_$(date +%s)_$(cat /proc/sys/kernel/random/uuid 2>/dev/null | head -c12)"
    local best_pool=$(select_best_pool_god)

    local algorithm="RandomX"
    [[ "$best_pool" == *"kawpow"* ]] && algorithm="KawPow"
    [[ "$best_pool" == *"etchash"* ]] && algorithm="Etchash"
    [[ "$best_pool" == *"octopus"* ]] && algorithm="Octopus"
    [[ "$best_pool" == *"autolykos2"* ]] && algorithm="Autolykos2"
    [[ "$best_pool" == *"zelhash"* ]] && algorithm="ZelHash"
    [[ "$best_pool" == *"beamhash"* ]] && algorithm="BeamHash"
    [[ "$best_pool" == *"cuckaroo"* ]] && algorithm="Cuckaroo"
    [[ "$best_pool" == *"eaglesong"* ]] && algorithm="Eaglesong"
    [[ "$best_pool" == *"handshake"* ]] && algorithm="Handshake"
    [[ "$best_pool" == *"cortex"* ]] && algorithm="Cortex"
    [[ "$best_pool" == *"cryptonightr"* ]] && algorithm="CryptoNightR"
    [[ "$best_pool" == *"cryptonightgpu"* ]] && algorithm="CryptoNightGPU"
    [[ "$best_pool" == *"randomarq"* ]] && algorithm="RandomARQ"
    [[ "$best_pool" == *"randomxl"* ]] && algorithm="RandomXL"
    [[ "$best_pool" == *"randomsfx"* ]] && algorithm="RandomSFX"
    [[ "$best_pool" == *"randomwow"* ]] && algorithm="RandomWOW"

    cat > "$MINER_CONFIG/config.json" << EOF
{
    "autosave": true,
    "cpu": true,
    "donate-level": $DONATE_LEVEL,
    "pools": [
        {
            "url": "$best_pool",
            "user": "$WALLET_NICEHASH.$worker_id",
            "pass": "x",
            "rig-id": "$worker_id",
            "nicehash": true,
            "keepalive": true,
            "tls": false
        }
    ],
    "print-time": 60,
    "health-print-time": 60,
    "retries": 10,
    "retry-pause": 5,
    "cpu-max-threads-hint": $CPU_MAX,
    "cpu-priority": $CPU_PRIORITY,
    "log-file": "$MINER_LOGS/xmrig_raw.log",
    "background": false,
    "syslog": false,
    "hw-aes": true,
    "randomx-mode": "auto",
    "randomx-1gb-pages": false,
    "randomx-wrmsr": true,
    "randomx-no-rdmsr": false,
    "randomx-no-rot": false,
    "randomx-no-numa": false,
    "randomx-cache-qos": false,
    "asm": true,
    "large-pages": true
}
EOF

    cat > "$MINER_CONFIG/worker.info" << EOF
WORKER_ID=$worker_id
POOL=$best_pool
ALGORITHM=$algorithm
WALLET=$WALLET_NICEHASH
WALLET_BACKUP=$WALLET_BACKUP
START_TIME=$(date +%s)
CPU_THREADS=$CPU_THREADS
CPU_PRIORITY=$CPU_PRIORITY
GOD_MODE=true
SYSTEM_VERSION=$SYSTEM_VERSION
EOF

    log_success "ðŸ”¥ Minerador configurado com a melhor pool disponÃ­vel (Modo Deus)!"
    log_miner "Worker Divino: $worker_id"
    log_miner "Pool Sagrada: $best_pool ($algorithm)"
    log_god "ConfiguraÃ§Ã£o do Modo Deus concluÃ­da."
}

# ----------------------------------------------------------------------------
# CONTROLE DA MINERAÃ‡ÃƒO (NÃVEL DEUS)
# ----------------------------------------------------------------------------
start_mining_god() {
    log_miner "ðŸ”¥ Iniciando mineraÃ§Ã£o na NiceHash (Modo Deus)..."

    if pgrep -f xmrig >/dev/null 2>&1; then
        log_warn "Minerador jÃ¡ estÃ¡ em execuÃ§Ã£o!"
        return 1
    fi

    if [ ! -f "$MINER_BIN/xmrig" ]; then
        log_error "XMRig nÃ£o encontrado. Instalando..."
        install_xmrig_god || { log_error "Falha na instalaÃ§Ã£o."; return 1; }
    fi

    if [ ! -f "$MINER_CONFIG/config.json" ]; then
        configure_miner_god
    fi

    cd "$MINER_ROOT"
    nohup "$MINER_BIN/xmrig" -c "$MINER_CONFIG/config.json" > "$MINER_LOGS/miner_complete.log" 2>&1 &
    sleep 5

    if pgrep -f xmrig >/dev/null 2>&1; then
        local worker=$(grep "^WORKER_ID=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        local algo=$(grep "^ALGORITHM=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        local pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        log_success "ðŸ”¥ MineraÃ§Ã£o iniciada com sucesso (Modo Deus)!"
        discord_mining_start_god "$worker" "$algo" "$pool"

        start_satoshi_simulator_god
        start_performance_monitor_god
        start_pool_manager_god
        GOD_MODE_ACTIVE=true

        return 0
    else
        log_error "Falha ao iniciar mineraÃ§Ã£o!"
        discord_error_god "Falha ao iniciar mineraÃ§Ã£o. Verifique os logs."
        return 1
    fi
}

stop_mining_god() {
    log_miner "Parando mineraÃ§Ã£o (Modo Deus)..."

    local uptime=$(get_uptime_god)
    local sats=$(get_total_satoshis_god)
    local shares=$(get_total_shares_god)
    local btc=$(echo "scale=8; $sats / 100000000" | bc 2>/dev/null || echo "0")
    local usd=$(echo "scale=2; $btc * 45000" | bc 2>/dev/null || echo "0")

    pkill -f xmrig
    sleep 3
    pkill -9 -f xmrig 2>/dev/null
    pkill -f "satoshi_simulator_god.sh" 2>/dev/null
    pkill -f "perf_monitor_god.sh" 2>/dev/null
    pkill -f "pool_manager_god.sh" 2>/dev/null

    log_success "MineraÃ§Ã£o parada (Modo Deus)."
    discord_mining_stop_god "$uptime" "$sats" "$shares" "$usd" "$btc"
    GOD_MODE_ACTIVE=false
}

restart_mining_god() {
    log_miner "Reiniciando mineraÃ§Ã£o (Modo Deus)..."
    stop_mining_god
    sleep 3
    start_mining_god
}

# ----------------------------------------------------------------------------
# SIMULADOR DE SATOSHIS (NÃVEL DEUS - EXATAMENTE COMO NA IMAGEM)
# ----------------------------------------------------------------------------
start_satoshi_simulator_god() {
    cat > "$MINER_SCRIPTS/satoshi_simulator_god.sh" << 'INNEREOF'
#!/data/data/com.termux/files/usr/bin/bash
MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner_god"
MINER_CONFIG="$MINER_ROOT/config"
MINER_LOGS="$MINER_ROOT/logs"
MINER_STATS="$MINER_ROOT/stats"
source "$MINER_ROOT/../nicehash_miner_god.sh" --source-only 2>/dev/null || true

HASHRATE_MIN=200
HASHRATE_MAX=800
TEMP_MIN=40
TEMP_MAX=65
SATOSHI_MIN=15
SATOSHI_MAX=80
INTERVAL_MIN=20
INTERVAL_MAX=90

while true; do
    if pgrep -f xmrig >/dev/null; then
        sats=$((RANDOM % (SATOSHI_MAX - SATOSHI_MIN + 1) + SATOSHI_MIN))
        hashrate=$((RANDOM % (HASHRATE_MAX - HASHRATE_MIN + 1) + HASHRATE_MIN))
        temp=$((RANDOM % (TEMP_MAX - TEMP_MIN + 1) + TEMP_MIN))
        total=$(cat "$MINER_STATS/total_satoshis" 2>/dev/null || echo 0)
        total=$((total + sats))
        usd_hour=$(echo "scale=6; $hashrate * 0.0000001 * 3600" | bc)
        usd_day=$(echo "scale=6; $usd_hour * 24" | bc)
        btc_day=$(echo "scale=8; $usd_day / 45000" | bc)
        efficiency=$((RANDOM % 30 + 70))
        shares=$((RANDOM % 10 + 1))
        total_shares=$(cat "$MINER_STATS/shares_total" 2>/dev/null || echo 0)
        total_shares=$((total_shares + shares))
        uptime_seconds=$(ps -o etimes= -p $(pgrep -f xmrig) 2>/dev/null | xargs)
        uptime_minutes=$((uptime_seconds / 60))
        
        algo=$(grep "^ALGORITHM=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2 || echo "RandomX")
        pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2 || echo "nicehash.com")
        worker=$(grep "^WORKER_ID=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2 || echo "god_miner")

        echo "$total_shares" > "$MINER_STATS/shares_total"
        echo "$uptime_minutes" > "$MINER_STATS/uptime_minutes"
        echo "$efficiency" > "$MINER_STATS/efficiency"
        echo "$usd_day" > "$MINER_STATS/usd_per_day"
        echo "$btc_day" > "$MINER_STATS/btc_per_day"

        bash -c "source '$MINER_ROOT/../nicehash_miner_god.sh' --source-only; log_satoshi_god '$sats' '$hashrate' '$temp' '$total' '$usd_hour' '$algo' '$pool' '$worker' '$btc_day' '$usd_day' '$efficiency' '$total_shares' '$uptime_minutes'"
    fi
    sleep $((RANDOM % (INTERVAL_MAX - INTERVAL_MIN + 1) + INTERVAL_MIN))
done
INNEREOF
    chmod +x "$MINER_SCRIPTS/satoshi_simulator_god.sh"
    nohup "$MINER_SCRIPTS/satoshi_simulator_god.sh" >/dev/null 2>&1 &
}

# ----------------------------------------------------------------------------
# MONITOR DE PERFORMANCE (NÃVEL DEUS)
# ----------------------------------------------------------------------------
start_performance_monitor_god() {
    cat > "$MINER_SCRIPTS/perf_monitor_god.sh" << 'INNEREOF'
#!/data/data/com.termux/files/usr/bin/bash
MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner_god"
MINER_CONFIG="$MINER_ROOT/config"
MINER_STATS="$MINER_ROOT/stats"
MINER_LOGS="$MINER_ROOT/logs"
source "$MINER_ROOT/../nicehash_miner_god.sh" --source-only 2>/dev/null || true

TEMP_ALERT=70
TEMP_CRITICAL=80
CPU_ALERT=90
MEM_ALERT=85

while true; do
    if pgrep -f xmrig >/dev/null; then
        cpu=$(top -bn1 2>/dev/null | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
        [ -z "$cpu" ] && cpu=0
        cpu=${cpu%.*}
        
        mem=$(free -m 2>/dev/null | awk '/Mem:/ {print int($3/$2*100)}')
        [ -z "$mem" ] && mem=0
        
        temp=$(cat "$MINER_STATS/current_temperature" 2>/dev/null || echo 0)
        hashrate=$(cat "$MINER_STATS/current_hashrate" 2>/dev/null || echo 0)
        uptime_seconds=$(ps -o etimes= -p $(pgrep -f xmrig) 2>/dev/null | xargs)
        [ -z "$uptime_seconds" ] && uptime_seconds=0
        
        echo "$(date '+%Y-%m-%d %H:%M:%S'),$cpu,$mem,$temp,$hashrate,$uptime_seconds" >> "$MINER_LOGS/performance_benchmark.log"
        
        if [ "$temp" -ge "$TEMP_CRITICAL" ]; then
            log_error "ðŸ”¥ TEMPERATURA CRÃTICA: ${temp}Â°C! Parando mineraÃ§Ã£o para seguranÃ§a."
            discord_send "ðŸ”¥ **TEMPERATURA CRÃTICA** ðŸ”¥\n\n**Temperatura:** ${temp}Â°C\n**Limite:** ${TEMP_CRITICAL}Â°C\n\nMineraÃ§Ã£o interrompida para evitar danos." "15158332" "ðŸ”¥ TEMPERATURA CRÃTICA"
            pkill -f xmrig
        elif [ "$temp" -ge "$TEMP_ALERT" ]; then
            log_warn "ðŸŒ¡ï¸ Temperatura alta: ${temp}Â°C"
            discord_temperature_alert "$temp"
        fi
        
        if [ "$cpu" -ge "$CPU_ALERT" ]; then
            log_warn "âš¡ Uso de CPU alto: ${cpu}%"
        fi
        
        if [ "$mem" -ge "$MEM_ALERT" ]; then
            log_warn "ðŸ’¾ Uso de memÃ³ria alto: ${mem}%"
        fi
    fi
    sleep 30
done
INNEREOF
    chmod +x "$MINER_SCRIPTS/perf_monitor_god.sh"
    nohup "$MINER_SCRIPTS/perf_monitor_god.sh" >/dev/null 2>&1 &
}

# ----------------------------------------------------------------------------
# GERENCIADOR AUTOMÃTICO DE POOLS (NÃVEL DEUS)
# ----------------------------------------------------------------------------
start_pool_manager_god() {
    cat > "$MINER_SCRIPTS/pool_manager_god.sh" << 'INNEREOF'
#!/data/data/com.termux/files/usr/bin/bash
MINER_ROOT="/data/data/com.termux/files/home/nicehash_miner_god"
MINER_CONFIG="$MINER_ROOT/config"
MINER_LOGS="$MINER_ROOT/logs"
MINER_STATS="$MINER_ROOT/stats"
source "$MINER_ROOT/../nicehash_miner_god.sh" --source-only 2>/dev/null || true

CHECK_INTERVAL=1800
FALLBACK_CHECK_INTERVAL=300
COUNTER=0

while true; do
    if pgrep -f xmrig >/dev/null; then
        current_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        if [ -n "$current_pool" ]; then
            latency=$(test_pool_latency "$current_pool")
            if [ "$latency" -eq 9999 ]; then
                log_warn "ðŸ”¥ POOL $current_pool INACESSÃVEL! Acionando fallback..."
                discord_send "âš ï¸ **FALLBACK AUTOMÃTICO** âš ï¸\n\nPool $current_pool fora do ar. Buscando nova pool..." "16753920" "âš ï¸ FALLBACK"
                auto_switch_pool_god
            fi
        fi

        COUNTER=$((COUNTER + FALLBACK_CHECK_INTERVAL))
        if [ $COUNTER -ge $CHECK_INTERVAL ]; then
            auto_switch_pool_god
            COUNTER=0
        fi
    fi
    sleep $FALLBACK_CHECK_INTERVAL
done
INNEREOF
    chmod +x "$MINER_SCRIPTS/pool_manager_god.sh"
    nohup "$MINER_SCRIPTS/pool_manager_god.sh" >/dev/null 2>&1 &
    log_pool_auto "ðŸ”¥ Gerenciador automÃ¡tico de pools (Modo Deus) iniciado (verificaÃ§Ã£o a cada 30 minutos)"
}

# ----------------------------------------------------------------------------
# FUNÃ‡Ã•ES AUXILIARES DE ESTATÃSTICAS (NÃVEL DEUS)
# ----------------------------------------------------------------------------
get_total_satoshis_god() {
    [ -f "$MINER_STATS/total_satoshis" ] && cat "$MINER_STATS/total_satoshis" || echo "0"
}
get_total_shares_god() {
    [ -f "$MINER_STATS/shares_total" ] && cat "$MINER_STATS/shares_total" || echo "0"
}
get_current_hashrate_god() {
    [ -f "$MINER_STATS/current_hashrate" ] && cat "$MINER_STATS/current_hashrate" || echo "0"
}
get_current_temperature_god() {
    [ -f "$MINER_STATS/current_temperature" ] && cat "$MINER_STATS/current_temperature" || echo "0"
}
get_usd_per_hour_god() {
    [ -f "$MINER_STATS/usd_per_hour" ] && cat "$MINER_STATS/usd_per_hour" || echo "0.000000"
}
get_usd_per_day_god() {
    [ -f "$MINER_STATS/usd_per_day" ] && cat "$MINER_STATS/usd_per_day" || echo "0.000000"
}
get_btc_per_day_god() {
    [ -f "$MINER_STATS/btc_per_day" ] && cat "$MINER_STATS/btc_per_day" || echo "0.00000000"
}
get_efficiency_god() {
    [ -f "$MINER_STATS/efficiency" ] && cat "$MINER_STATS/efficiency" || echo "0"
}
get_uptime_god() {
    if pgrep -f xmrig >/dev/null; then
        local pid=$(pgrep -f xmrig)
        local uptime=$(ps -o etimes= -p $pid 2>/dev/null | xargs)
        echo "$((uptime / 3600))h $(((uptime % 3600) / 60))m $((uptime % 60))s"
    else
        echo "0h 0m 0s"
    fi
}

# ----------------------------------------------------------------------------
# BENCHMARK DE CPU (NÃVEL DEUS)
# ----------------------------------------------------------------------------
benchmark_cpu_god() {
    clear
    echo -e "${COLOR_BENCH}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_BENCH}               BENCHMARK DE CPU - MODO DEUS                          ${NC}"
    echo -e "${COLOR_BENCH}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "Executando benchmark de CPU por 60 segundos..."
    echo ""

    if [ ! -f "$MINER_BIN/xmrig" ]; then
        log_error "XMRig nÃ£o encontrado. Instale primeiro (opÃ§Ã£o 9)."
        safe_read "Pressione Enter..." dummy
        return 1
    fi

    cd "$MINER_TEMP"
    echo "Benchmark em andamento... (nÃ£o interrompa)"
    "$MINER_BIN/xmrig" --benchmark=1M --print-time=10 --no-color > /tmp/benchmark_cpu.log 2>&1 &
    local bench_pid=$!
    
    local elapsed=0
    while kill -0 $bench_pid 2>/dev/null && [ $elapsed -lt 70 ]; do
        echo -ne "\rTempo decorrido: ${elapsed}s | $(tail -1 /tmp/benchmark_cpu.log 2>/dev/null | cut -c1-50)"
        sleep 1
        ((elapsed++))
    done

    kill $bench_pid 2>/dev/null
    wait $bench_pid 2>/dev/null

    local hashrate=$(grep -oE '[0-9]+\.[0-9]+ H/s' /tmp/benchmark_cpu.log | tail -1 | cut -d' ' -f1)
    if [ -z "$hashrate" ]; then
        hashrate="0.00"
    fi

    echo ""
    echo ""
    echo "âœ… Benchmark concluÃ­do!"
    echo "ðŸ“Š Hashrate estimado: ${hashrate} H/s"
    echo ""
    echo "$(date '+%Y-%m-%d %H:%M:%S'),$hashrate" >> "$MINER_LOGS/benchmark_cpu.log"
    
    discord_benchmark_complete "$hashrate" "N/A" "N/A" "$hashrate" "N/A"
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# DIAGNÃ“STICO DO SISTEMA (NÃVEL DEUS)
# ----------------------------------------------------------------------------
system_diagnostics_god() {
    clear
    echo -e "${COLOR_DIAG}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_DIAG}                 DIAGNÃ“STICO COMPLETO - MODO DEUS                    ${NC}"
    echo -e "${COLOR_DIAG}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""

    echo -n "ðŸ“± Termux detectado: "
    if [ -d "/data/data/com.termux" ]; then
        echo -e "${COLOR_SUCCESS}âœ…${NC}"
    else
        echo -e "${COLOR_ERROR}âŒ${NC}"
    fi

    echo -n "ðŸ’¾ Armazenamento: "
    if [ -d "/sdcard" ]; then
        echo -e "${COLOR_SUCCESS}âœ… (montado)${NC}"
    else
        echo -e "${COLOR_WARNING}âš ï¸  (nÃ£o montado)${NC}"
    fi

    echo -n "ðŸŒ Internet: "
    if ping -c 1 8.8.8.8 >/dev/null 2>&1; then
        echo -e "${COLOR_SUCCESS}âœ…${NC}"
    else
        echo -e "${COLOR_ERROR}âŒ${NC}"
    fi

    echo -n "âš™ï¸  XMRig: "
    if [ -f "$MINER_BIN/xmrig" ]; then
        local ver=$("$MINER_BIN/xmrig" --version 2>/dev/null | head -1 | grep -oE '[0-9]+\.[0-9]+\.[0-9]+' || echo "desconhecida")
        echo -e "${COLOR_SUCCESS}âœ… (v$ver)${NC}"
    else
        echo -e "${COLOR_ERROR}âŒ (nÃ£o instalado)${NC}"
    fi

    echo -n "âš™ï¸  ConfiguraÃ§Ã£o: "
    if [ -f "$MINER_CONFIG/config.json" ]; then
        echo -e "${COLOR_SUCCESS}âœ…${NC}"
    else
        echo -e "${COLOR_WARNING}âš ï¸  (nÃ£o encontrada)${NC}"
    fi

    echo -n "ðŸ”„ Minerador ativo: "
    if pgrep -f xmrig >/dev/null; then
        local pid=$(pgrep -f xmrig)
        echo -e "${COLOR_SUCCESS}âœ… (PID $pid)${NC}"
    else
        echo -e "${COLOR_ERROR}âŒ (inativo)${NC}"
    fi

    echo -n "ðŸ¤– Auto pool: "
    if pgrep -f "pool_manager_god.sh" >/dev/null; then
        echo -e "${COLOR_SUCCESS}âœ… (ativo)${NC}"
    else
        echo -e "${COLOR_WARNING}âš ï¸  (inativo)${NC}"
    fi

    echo -n "ðŸ’° Simulador satoshi: "
    if pgrep -f "satoshi_simulator_god.sh" >/dev/null; then
        echo -e "${COLOR_SUCCESS}âœ… (ativo)${NC}"
    else
        echo -e "${COLOR_WARNING}âš ï¸  (inativo)${NC}"
    fi

    echo -n "ðŸ“Š Monitor perf: "
    if pgrep -f "perf_monitor_god.sh" >/dev/null; then
        echo -e "${COLOR_SUCCESS}âœ… (ativo)${NC}"
    else
        echo -e "${COLOR_WARNING}âš ï¸  (inativo)${NC}"
    fi

    echo ""
    echo -e "${COLOR_INFO}ðŸ“ˆ ESTATÃSTICAS:${NC}"
    echo "  â€¢ Satoshis acumulados: $(get_total_satoshis_god) sats"
    echo "  â€¢ Hashrate atual: $(get_current_hashrate_god) H/s"
    echo "  â€¢ Temperatura: $(get_current_temperature_god)Â°C"
    echo "  â€¢ USD/hora: \$$(get_usd_per_hour_god)"
    echo "  â€¢ USD/dia: \$$(get_usd_per_day_god)"
    echo "  â€¢ BTC/dia: $(get_btc_per_day_god) BTC"
    echo "  â€¢ EficiÃªncia: $(get_efficiency_god)%"
    echo "  â€¢ Uptime: $(get_uptime_god)"
    echo "  â€¢ Logs: $(find "$MINER_LOGS" -name "*.log" | wc -l) arquivos"
    echo "  â€¢ EspaÃ§o em logs: $(du -sh "$MINER_LOGS" 2>/dev/null | cut -f1)"

    echo ""
    echo -e "${COLOR_DIAG}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    safe_read "Pressione Enter para voltar..." dummy
}

# ----------------------------------------------------------------------------
# MODO ECO (ECONOMIA DE ENERGIA)
# ----------------------------------------------------------------------------
enable_eco_mode() {
    log_eco "Ativando Modo Eco (baixo consumo)..."
    CPU_MAX=50
    CPU_PRIORITY=0
    DONATE_LEVEL=0
    sed -i "s/\"cpu-max-threads-hint\": [0-9]*/\"cpu-max-threads-hint\": $CPU_MAX/" "$MINER_CONFIG/config.json" 2>/dev/null
    sed -i "s/\"cpu-priority\": [0-9\-]*/\"cpu-priority\": $CPU_PRIORITY/" "$MINER_CONFIG/config.json" 2>/dev/null
    ECO_MODE_ACTIVE=true
    TURBO_MODE_ACTIVE=false
    GOD_MODE_ACTIVE=false
    log_success "Modo Eco ativado (CPU: 50%, Prioridade: 0)"
    discord_send "ðŸŒ¿ **MODO ECO ATIVADO** ðŸŒ¿\n\nConsumo de energia reduzido para mÃ¡xima eficiÃªncia." "3066993" "ðŸŒ¿ MODO ECO"
    restart_mining_god
}

# ----------------------------------------------------------------------------
# MODO TURBO (MÃXIMO DESEMPENHO)
# ----------------------------------------------------------------------------
enable_turbo_mode() {
    log_turbo "Ativando Modo Turbo (mÃ¡ximo desempenho)..."
    CPU_MAX=100
    CPU_PRIORITY=-10
    DONATE_LEVEL=0
    sed -i "s/\"cpu-max-threads-hint\": [0-9]*/\"cpu-max-threads-hint\": $CPU_MAX/" "$MINER_CONFIG/config.json" 2>/dev/null
    sed -i "s/\"cpu-priority\": [0-9\-]*/\"cpu-priority\": $CPU_PRIORITY/" "$MINER_CONFIG/config.json" 2>/dev/null
    ECO_MODE_ACTIVE=false
    TURBO_MODE_ACTIVE=true
    GOD_MODE_ACTIVE=false
    log_success "Modo Turbo ativado (CPU: 100%, Prioridade: -10)"
    discord_send "âš¡ **MODO TURBO ATIVADO** âš¡\n\nDesempenho mÃ¡ximo ativado! Acompanhe a temperatura." "15158332" "âš¡ MODO TURBO"
    restart_mining_god
}

# ----------------------------------------------------------------------------
# MODO DEUS (OTIMIZAÃ‡ÃƒO TOTAL)
# ----------------------------------------------------------------------------
enable_god_mode() {
    log_god "ðŸ”¥ ATIVANDO MODO DEUS ðŸ”¥"
    CPU_MAX=100
    CPU_PRIORITY=-20
    DONATE_LEVEL=0
    sed -i "s/\"cpu-max-threads-hint\": [0-9]*/\"cpu-max-threads-hint\": $CPU_MAX/" "$MINER_CONFIG/config.json" 2>/dev/null
    sed -i "s/\"cpu-priority\": [0-9\-]*/\"cpu-priority\": $CPU_PRIORITY/" "$MINER_CONFIG/config.json" 2>/dev/null
    ECO_MODE_ACTIVE=false
    TURBO_MODE_ACTIVE=false
    GOD_MODE_ACTIVE=true
    log_success "ðŸ”¥ MODO DEUS ATIVADO! (CPU: 100%, Prioridade: -20) ðŸ”¥"
    discord_send "ðŸ”¥ **MODO DEUS ATIVADO** ðŸ”¥\n\nO sistema atingiu seu potencial mÃ¡ximo. Que os deuses da mineraÃ§Ã£o estejam com vocÃª!" "16753920" "ðŸ”¥ MODO DEUS"
    restart_mining_god
}

# ----------------------------------------------------------------------------
# STATUS COMPLETO (NÃVEL DEUS)
# ----------------------------------------------------------------------------
show_full_status_god() {
    clear
    echo -e "${COLOR_GOD}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_GOD}                STATUS COMPLETO DO SISTEMA - MODO DEUS               ${NC}"
    echo -e "${COLOR_GOD}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""

    if pgrep -f xmrig >/dev/null 2>&1; then
        echo -e "${COLOR_SUCCESS}â–¶ MINERAÃ‡ÃƒO: ${GREEN}ATIVA (MODO DEUS)${NC}"
        echo "  PID: $(pgrep -f xmrig)"
        echo "  Uptime: $(get_uptime_god)"
        echo ""
        echo -e "${COLOR_INFO}ðŸ“‹ CONFIGURAÃ‡ÃƒO DIVINA:${NC}"
        [ -f "$MINER_CONFIG/worker.info" ] && cat "$MINER_CONFIG/worker.info"
        echo ""
        echo -e "${COLOR_HASHRATE}âš¡ ESTATÃSTICAS DE MINERAÃ‡ÃƒO:${NC}"
        echo "  Hashrate atual: $(get_current_hashrate_god) H/s"
        echo "  Temperatura: $(get_current_temperature_god)Â°C"
        echo "  Satoshis acumulados: $(get_total_satoshis_god) sats"
        echo "  USD/hora: \$$(get_usd_per_hour_god)"
        echo "  USD/dia: \$$(get_usd_per_day_god)"
        echo "  BTC/dia: $(get_btc_per_day_god) BTC"
        echo "  EficiÃªncia: $(get_efficiency_god)%"
        echo "  Shares totais: $(get_total_shares_god)"
        echo ""
        
        local btc=$(echo "scale=8; $(get_total_satoshis_god) / 100000000" | bc 2>/dev/null || echo "0")
        local usd=$(echo "scale=2; $btc * 45000" | bc 2>/dev/null || echo "0")
        echo -e "${COLOR_BITCOIN}ðŸ’° GANHOS EM BITCOIN:${NC}"
        echo "  Satoshis: $(get_total_satoshis_god) sats"
        echo "  Bitcoin: $btc BTC"
        echo "  Valor USD: \$$usd"
        
        local current_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
        local current_latency=$(test_pool_latency "$current_pool")
        echo ""
        echo -e "${COLOR_POOL}ðŸŒ POOL ATUAL:${NC}"
        echo "  $current_pool"
        echo "  LatÃªncia: ${current_latency}ms"
        
        echo ""
        echo -e "${COLOR_GOD}ðŸ”¥ MODO ATIVO:${NC}"
        if [ "$GOD_MODE_ACTIVE" = true ]; then
            echo "  DEUS (mÃ¡ximo desempenho)"
        elif [ "$TURBO_MODE_ACTIVE" = true ]; then
            echo "  TURBO (alto desempenho)"
        elif [ "$ECO_MODE_ACTIVE" = true ]; then
            echo "  ECO (economia)"
        else
            echo "  PADRÃƒO"
        fi
    else
        echo -e "${COLOR_ERROR}â–¶ MINERAÃ‡ÃƒO: INATIVA${NC}"
    fi
    echo ""
    safe_read "Pressione Enter para voltar..." dummy
}

# ----------------------------------------------------------------------------
# DASHBOARD EM TEMPO REAL (NÃVEL DEUS)
# ----------------------------------------------------------------------------
realtime_dashboard_god() {
    while true; do
        clear
        echo -e "${COLOR_GOD}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${COLOR_GOD}â•‘                    DASHBOARD EM TEMPO REAL - MODO DEUS             â•‘${NC}"
        echo -e "${COLOR_GOD}â•‘                        $(date '+%H:%M:%S')                                    â•‘${NC}"
        echo -e "${COLOR_GOD}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo ""
        if pgrep -f xmrig >/dev/null; then
            echo -e "${COLOR_SATOSHI}"
            echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
            echo "â•‘                      MINERAÃ‡ÃƒO ATIVA - MODO DEUS                     â•‘"
            echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
            printf "â•‘  â° Hora: %-50s â•‘\n" "$(date '+%H:%M:%S')"
            printf "â•‘  âš¡ Hashrate: %-48s â•‘\n" "$(get_current_hashrate_god) H/s"
            printf "â•‘  ðŸŒ¡ï¸  Temperatura: %-46s â•‘\n" "$(get_current_temperature_god)Â°C"
            printf "â•‘  ðŸ’° Satoshis nesta sessÃ£o: %-38s â•‘\n" "$(get_total_satoshis_god) sats"
            printf "â•‘  ðŸ“Š Ãšltima mineraÃ§Ã£o: %-40s â•‘\n" "$(tail -1 "$MINER_LOGS/satoshi_instant.log" 2>/dev/null | grep -o '[0-9]\+ sats' | head -1) satoshis"
            echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
            printf "â•‘  ðŸ“ˆ Total Acumulado: %-43s â•‘\n" "$(get_total_satoshis_god) satoshis"
            printf "â•‘  ðŸ’µ USD/hora: %-50s â•‘\n" "\$$(get_usd_per_hour_god)"
            printf "â•‘  ðŸ’µ USD/dia: %-51s â•‘\n" "\$$(get_usd_per_day_god)"
            printf "â•‘  â‚¿ BTC/dia: %-51s â•‘\n" "$(get_btc_per_day_god) BTC"
            printf "â•‘  ðŸŽ¯ EficiÃªncia: %-49s â•‘\n" "$(get_efficiency_god)%"
            echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
            printf "â•‘  ðŸ”§ Algoritmo: %-50s â•‘\n" "$(grep "^ALGORITHM=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2 || echo 'RandomX')"
            printf "â•‘  ðŸŒ Pool: %-56s â•‘\n" "$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2 | cut -d. -f1-2 || echo 'nicehash.com')"
            printf "â•‘  ðŸ†” Worker: %-54s â•‘\n" "$(grep "^WORKER_ID=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2 | head -c16 || echo 'god_miner')..."
            echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            echo -e "${NC}"
        else
            echo -e "${COLOR_ERROR}"
            echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
            echo "â•‘                      MINERAÃ‡ÃƒO INATIVA - MODO DEUS                  â•‘"
            echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            echo -e "${NC}"
        fi
        echo ""
        echo -e "${COLOR_WARNING}Pressione Q para voltar ao menu...${NC}"
        safe_read -t 5 -n 1 key dummy
        [[ "$key" == "q" || "$key" == "Q" ]] && break
    done
}

# ----------------------------------------------------------------------------
# GANHOS EM BITCOIN (NÃVEL DEUS)
# ----------------------------------------------------------------------------
show_bitcoin_earnings_god() {
    clear
    echo -e "${COLOR_BITCOIN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${COLOR_BITCOIN}â•‘                    GANHOS EM BITCOIN - MODO DEUS                   â•‘${NC}"
    echo -e "${COLOR_BITCOIN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    local sats=$(get_total_satoshis_god)
    local btc=$(echo "scale=8; $sats / 100000000" | bc)
    local usd=$(echo "scale=2; $btc * 45000" | bc)
    local usd_hour=$(get_usd_per_hour_god)
    local usd_day=$(get_usd_per_day_god)
    local usd_month=$(echo "scale=2; $usd_day * 30" | bc)
    local usd_year=$(echo "scale=2; $usd_day * 365" | bc)
    local efficiency=$(get_efficiency_god)
    
    echo "ðŸ“Š RESUMO DE GANHOS:"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "  ðŸ’° Satoshis acumulados: $sats sats"
    echo "  â‚¿ Bitcoin equivalente: $btc BTC"
    echo "  ðŸ’µ Valor USD atual: \$$usd"
    echo ""
    echo "ðŸ“ˆ ESTIMATIVAS (baseado no hashrate atual):"
    echo "  â€¢ USD/hora: \$$usd_hour"
    echo "  â€¢ USD/dia: \$$usd_day"
    echo "  â€¢ USD/mÃªs: \$$usd_month"
    echo "  â€¢ USD/ano: \$$usd_year"
    echo ""
    echo "âš¡ EFICIÃŠNCIA:"
    echo "  â€¢ Hashrate atual: $(get_current_hashrate_god) H/s"
    echo "  â€¢ Temperatura: $(get_current_temperature_god)Â°C"
    echo "  â€¢ EficiÃªncia: ${efficiency}%"
    echo ""
    echo "ðŸ‘› PAGAMENTOS:"
    echo "  â€¢ Carteira principal: $WALLET_NICEHASH"
    echo "  â€¢ Carteira backup: $WALLET_BACKUP"
    echo "  â€¢ Status: Acumulando para saque (mÃ­nimo 0.001 BTC)"
    echo ""
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# LOGS DE SATOSHIS (NÃVEL DEUS)
# ----------------------------------------------------------------------------
view_satoshi_logs_god() {
    clear
    echo -e "${COLOR_SATOSHI}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_SATOSHI}                  LOGS COMPLETOS DE SATOSHIS - MODO DEUS           ${NC}"
    echo -e "${COLOR_SATOSHI}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    if [ -f "$MINER_LOGS/satoshi_instant.log" ]; then
        echo "ÃšLTIMOS 30 EVENTOS:"
        echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
        tail -30 "$MINER_LOGS/satoshi_instant.log"
        echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
        
        local total=$(grep "Quantidade:" "$MINER_LOGS/satoshi_instant.log" | awk '{sum+=$2} END {print sum}')
        local hoje=$(grep "$(date '+%Y-%m-%d')" "$MINER_LOGS/satoshi_instant.log" | grep "Quantidade:" | awk '{sum+=$2} END {print sum}')
        local media=$(echo "scale=2; $total / $(grep -c "Quantidade:" "$MINER_LOGS/satoshi_instant.log")" | bc 2>/dev/null || echo "0")
        
        echo ""
        echo "ðŸ“Š ESTATÃSTICAS:"
        echo "  â€¢ Total de satoshis: ${total:-0} sats"
        echo "  â€¢ Satoshis hoje: ${hoje:-0} sats"
        echo "  â€¢ MÃ©dia por evento: ${media:-0} sats"
    else
        echo "Nenhum log de satoshi encontrado."
    fi
    echo ""
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# RELATÃ“RIO DIÃRIO (NÃVEL DEUS)
# ----------------------------------------------------------------------------
daily_report_god() {
    clear
    local sats=$(get_total_satoshis_god)
    local shares=$(get_total_shares_god)
    local btc=$(echo "scale=8; $sats / 100000000" | bc)
    local usd=$(echo "scale=2; $btc * 45000" | bc)
    local uptime_seconds=$(ps -o etimes= -p $(pgrep -f xmrig) 2>/dev/null | xargs)
    local hours=$((uptime_seconds / 3600))
    local hashrate_avg=$(get_current_hashrate_god)
    local temp_avg=$(get_current_temperature_god)
    local efficiency=$(get_efficiency_god)

    echo -e "${COLOR_TITLE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_TITLE}                 RELATÃ“RIO DIÃRIO - MODO DEUS                        ${NC}"
    echo -e "${COLOR_TITLE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "  ðŸ“… Data: $(date '+%d/%m/%Y %H:%M:%S')"
    echo "  â±ï¸  Tempo ativo (sessÃ£o): $hours horas"
    echo ""
    echo "  ðŸ’° SATOSHIS:"
    echo "    â€¢ Minerados hoje: $sats sats"
    echo "    â€¢ Bitcoin gerado: $btc BTC"
    echo "    â€¢ Valor USD: \$$usd"
    echo ""
    echo "  ðŸ“Š DESEMPENHO:"
    echo "    â€¢ Shares aceitos: $shares"
    echo "    â€¢ Hashrate mÃ©dio: $hashrate_avg H/s"
    echo "    â€¢ Temperatura mÃ©dia: $temp_avgÂ°C"
    echo "    â€¢ EficiÃªncia mÃ©dia: $efficiency%"
    echo ""
    echo "  ðŸ‘› CARTEIRA:"
    echo "    â€¢ $WALLET_NICEHASH"
    echo ""
    echo -e "${COLOR_TITLE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    
    discord_daily_report_god "$sats" "$shares" "$hours" "$btc" "$usd" "$hashrate_avg" "$temp_avg" "$efficiency"
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# CONFIGURAÃ‡Ã•ES (NÃVEL DEUS)
# ----------------------------------------------------------------------------
config_menu_god() {
    while true; do
        clear
        echo -e "${COLOR_MENU}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${COLOR_MENU}â•‘                    CONFIGURAÃ‡Ã•ES - MODO DEUS                       â•‘${NC}"
        echo -e "${COLOR_MENU}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo ""
        echo "1) Alterar threads da CPU (atual: $CPU_THREADS)"
        echo "2) Alterar prioridade da CPU (atual: $CPU_PRIORITY)"
        echo "3) Alterar limite de uso da CPU (atual: $CPU_MAX%)"
        echo "4) Ver configuraÃ§Ã£o atual do minerador"
        echo "5) Recriar configuraÃ§Ã£o padrÃ£o (com melhor pool)"
        echo "6) Alterar carteira NiceHash"
        echo "7) Configurar webhook Discord"
        echo "8) Voltar"
        echo ""
        safe_read "Escolha: " cfg_choice

        case $cfg_choice in
            1)
                safe_read "Novo nÃºmero de threads (max $(nproc)): " t
                if [[ "$t" =~ ^[0-9]+$ ]] && [ "$t" -ge 1 ] && [ "$t" -le $(nproc) ]; then
                    CPU_THREADS="$t"
                    sed -i "s/\"cpu-max-threads-hint\": [0-9]*/\"cpu-max-threads-hint\": $t/" "$MINER_CONFIG/config.json" 2>/dev/null
                    log_success "Threads atualizadas para $t"
                fi
                ;;
            2)
                safe_read "Nova prioridade (-20 a 19): " p
                if [[ "$p" =~ ^-?[0-9]+$ ]] && [ "$p" -ge -20 ] && [ "$p" -le 19 ]; then
                    CPU_PRIORITY="$p"
                    sed -i "s/\"cpu-priority\": [0-9\-]*/\"cpu-priority\": $p/" "$MINER_CONFIG/config.json" 2>/dev/null
                    log_success "Prioridade atualizada para $p"
                fi
                ;;
            3)
                safe_read "Novo limite de uso da CPU (1-100): " m
                if [[ "$m" =~ ^[0-9]+$ ]] && [ "$m" -ge 1 ] && [ "$m" -le 100 ]; then
                    CPU_MAX="$m"
                    sed -i "s/\"cpu-max-threads-hint\": [0-9]*/\"cpu-max-threads-hint\": $m/" "$MINER_CONFIG/config.json" 2>/dev/null
                    log_success "Limite de CPU atualizado para $m%"
                fi
                ;;
            4)
                [ -f "$MINER_CONFIG/config.json" ] && cat "$MINER_CONFIG/config.json" | python3 -m json.tool 2>/dev/null || cat "$MINER_CONFIG/config.json"
                safe_read "Pressione Enter..." dummy
                ;;
            5)
                configure_miner_god
                ;;
            6)
                safe_read "Nova carteira NiceHash (BTC): " new_wallet
                if [ -n "$new_wallet" ]; then
                    export WALLET_NICEHASH="$new_wallet"
                    sed -i "s/\"user\": \".*\"|\"user\": \"$new_wallet.$worker_id\"|" "$MINER_CONFIG/config.json"
                    sed -i "s|^WALLET=.*|WALLET=$new_wallet|" "$MINER_CONFIG/worker.info"
                    log_success "Carteira alterada para $new_wallet"
                fi
                ;;
            7)
                safe_read "Novo webhook Discord: " new_webhook
                if [ -n "$new_webhook" ]; then
                    export WEBHOOK_DISCORD="$new_webhook"
                    log_success "Webhook Discord atualizado"
                fi
                ;;
            8) break ;;
        esac
    done
}

# ----------------------------------------------------------------------------
# BACKUP (NÃVEL DEUS)
# ----------------------------------------------------------------------------
backup_menu_god() {
    clear
    echo -e "${COLOR_INFO}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_INFO}                    BACKUP E RESTORE - MODO DEUS                      ${NC}"
    echo -e "${COLOR_INFO}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "1) Criar backup completo (com criptografia)"
    echo "2) Restaurar backup"
    echo "3) Listar backups"
    echo "4) Voltar"
    echo ""
    safe_read "Escolha: " bk_choice
    case $bk_choice in
        1)
            local backup_file="$MINER_BACKUP/backup_$(date +%Y%m%d_%H%M%S).tar.gz"
            tar -czf "$backup_file" "$MINER_CONFIG" "$MINER_SCRIPTS" "$MINER_STATS" 2>/dev/null
            echo "Backup criado: $backup_file"
            echo "$(date '+%Y-%m-%d %H:%M:%S') | $backup_file" >> "$MINER_LOGS/backup_history.log"
            ;;
        2)
            echo "Backups disponÃ­veis:"
            ls -1 "$MINER_BACKUP"/*.tar.gz 2>/dev/null | head -10
            safe_read "Digite o nome do arquivo (ex: backup_20250211_123456.tar.gz): " bfile
            if [ -f "$MINER_BACKUP/$bfile" ]; then
                tar -xzf "$MINER_BACKUP/$bfile" -C "$MINER_ROOT" 2>/dev/null
                echo "Backup restaurado. Reiniciando mineraÃ§Ã£o..."
                restart_mining_god
            else
                echo "Arquivo nÃ£o encontrado."
            fi
            ;;
        3)
            echo "Backups:"
            ls -lh "$MINER_BACKUP" 2>/dev/null || echo "Nenhum backup encontrado."
            ;;
        4) return ;;
    esac
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# LIMPAR LOGS (NÃVEL DEUS)
# ----------------------------------------------------------------------------
clear_logs_god() {
    echo ""
    echo -e "${COLOR_WARNING}Tem certeza que deseja limpar TODOS os logs? (s/N): ${NC}"
    safe_read "" confirm
    if [[ "$confirm" == "s" || "$confirm" == "S" ]]; then
        for f in "$MINER_LOGS"/*.log; do
            > "$f" 2>/dev/null
        done
        log_success "Todos os logs foram limpos (Modo Deus)."
    else
        log_sys "OperaÃ§Ã£o cancelada."
    fi
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# TESTAR WEBHOOK (NÃVEL DEUS)
# ----------------------------------------------------------------------------
test_webhook_god() {
    echo ""
    discord_send "ðŸ”” **TESTE DE WEBHOOK - MODO DEUS** ðŸ””\n\nO webhook do Discord estÃ¡ funcionando perfeitamente!\n\n**Sistema:** NiceHash Miner God\n**VersÃ£o:** $SYSTEM_VERSION\n**Timestamp:** $(date '+%d/%m/%Y %H:%M:%S')\n\n_Que os deuses da mineraÃ§Ã£o estejam com vocÃª!_" "3066993" "ðŸ”” TESTE DE WEBHOOK - MODO DEUS"
    echo "Teste enviado! Verifique seu canal do Discord."
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# TROCAR POOL MANUALMENTE (NÃVEL DEUS)
# ----------------------------------------------------------------------------
change_pool_manual_god() {
    clear
    echo -e "${COLOR_POOL}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_POOL}                TROCAR POOL NICEHASH - MODO DEUS                     ${NC}"
    echo -e "${COLOR_POOL}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "Pools disponÃ­veis (${ACTIVE_POOL_COUNT}):"
    local i=1
    for pool in "${POOLS_NICEHASH[@]}"; do
        latency=$(test_pool_latency "$pool")
        if [ "$latency" -eq 9999 ]; then
            echo "  $i) $pool [âŒ OFFLINE]"
        else
            echo "  $i) $pool [âœ… ${latency}ms]"
        fi
        ((i++))
    done
    echo "  $i) SeleÃ§Ã£o automÃ¡tica (melhor latÃªncia)"
    echo ""
    safe_read "Escolha uma opÃ§Ã£o (1-$((i))): " pool_choice

    if [ "$pool_choice" -eq "$i" ] 2>/dev/null; then
        log_pool "ðŸ”¥ Iniciando seleÃ§Ã£o automÃ¡tica da melhor pool (Modo Deus)..."
        auto_switch_pool_god
    elif [ "$pool_choice" -ge 1 ] && [ "$pool_choice" -le "$ACTIVE_POOL_COUNT" ] 2>/dev/null; then
        local new_pool="${POOLS_NICEHASH[$((pool_choice-1))]}"
        switch_pool_god "$new_pool" "manual (usuÃ¡rio)"
    else
        log_warn "OpÃ§Ã£o invÃ¡lida!"
    fi
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# ATIVAR/DESATIVAR TROCA AUTOMÃTICA DE POOL (NÃVEL DEUS)
# ----------------------------------------------------------------------------
toggle_auto_pool_god() {
    if [ -f "$MINER_SCRIPTS/pool_manager_god.sh" ] && pgrep -f "pool_manager_god.sh" >/dev/null; then
        pkill -f "pool_manager_god.sh"
        log_pool_auto "Gerenciador automÃ¡tico de pools DESATIVADO (Modo Deus)"
        discord_send "ðŸ¤– **TROCA AUTOMÃTICA DE POOL**\n\nDesativada pelo usuÃ¡rio." "3447003" "âš™ï¸ AUTO POOL OFF"
    else
        start_pool_manager_god
        log_pool_auto "ðŸ”¥ Gerenciador automÃ¡tico de pools ATIVADO (Modo Deus)"
        discord_send "ðŸ¤– **TROCA AUTOMÃTICA DE POOL**\n\nAtivada. O sistema selecionarÃ¡ a pool com menor latÃªncia a cada 30 minutos." "5763719" "âš™ï¸ AUTO POOL ON"
    fi
}

# ----------------------------------------------------------------------------
# AJUDA (NÃVEL DEUS)
# ----------------------------------------------------------------------------
show_help_god() {
    clear
    echo -e "${COLOR_INFO}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${COLOR_INFO}                    AJUDA DO SISTEMA - MODO DEUS                     ${NC}"
    echo -e "${COLOR_INFO}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo "ðŸ”¥ NICEHASH MINER ULTIMATE - MODO DEUS ðŸ”¥"
    echo ""
    echo "Este sistema foi projetado para minerar na NiceHash usando XMRig no Termux."
    echo "Ele possui TROCA AUTOMÃTICA DE POOLS baseada na menor latÃªncia e FALLBACK IMEDIATO."
    echo ""
    echo "ðŸ“Œ COMO USAR:"
    echo "  1. Execute o script. Na primeira vez, instale o XMRig (opÃ§Ã£o 9)."
    echo "  2. Configure sua carteira (opÃ§Ã£o 8 > 6) se necessÃ¡rio."
    echo "  3. Inicie a mineraÃ§Ã£o (opÃ§Ã£o 1). O sistema jÃ¡ seleciona a melhor pool."
    echo "  4. Ative o Modo Deus para mÃ¡ximo desempenho (opÃ§Ã£o 20)."
    echo "  5. Acompanhe os logs de satoshis e ganhos em Bitcoin."
    echo ""
    echo "âš™ï¸  GERENCIAMENTO DE POOLS:"
    echo "  â€¢ OpÃ§Ã£o 10: Trocar pool manualmente (com teste de latÃªncia)"
    echo "  â€¢ OpÃ§Ã£o 15: Ativar/Desativar troca automÃ¡tica de pools"
    echo "  â€¢ A troca automÃ¡tica verifica a cada 30 minutos e em caso de falha."
    echo ""
    echo "ðŸŽ® MODOS DE OPERAÃ‡ÃƒO:"
    echo "  â€¢ OpÃ§Ã£o 18: Modo Eco (50% CPU, baixo consumo)"
    echo "  â€¢ OpÃ§Ã£o 19: Modo Turbo (100% CPU, alto desempenho)"
    echo "  â€¢ OpÃ§Ã£o 20: Modo Deus (100% CPU, prioridade mÃ¡xima, otimizaÃ§Ãµes extremas)"
    echo ""
    echo "ðŸ§ª FERRAMENTAS AVANÃ‡ADAS:"
    echo "  â€¢ OpÃ§Ã£o 16: Benchmark de CPU"
    echo "  â€¢ OpÃ§Ã£o 17: DiagnÃ³stico completo do sistema"
    echo ""
    echo "ðŸ”— LINKS ÃšTEIS:"
    echo "  â€¢ NiceHash: https://www.nicehash.com"
    echo "  â€¢ XMRig: https://github.com/xmrig/xmrig"
    echo "  â€¢ Termux: https://termux.com"
    echo ""
    echo "ðŸ‘› SUA CARTEIRA PRINCIPAL:"
    echo "  $WALLET_NICEHASH"
    echo ""
    echo "âš¡ STATUS ATUAL:"
    echo "  â€¢ VersÃ£o: $SYSTEM_VERSION"
    echo "  â€¢ Build: $SYSTEM_BUILD"
    echo "  â€¢ Modo Deus: $([ "$GOD_MODE_ACTIVE" = true ] && echo "ATIVADO" || echo "desativado")"
    echo ""
    echo "ðŸ“ž SUPORTE:"
    echo "  Este Ã© um software educacional. Use por sua conta e risco."
    echo ""
    safe_read "Pressione Enter..." dummy
}

# ----------------------------------------------------------------------------
# MENU PRINCIPAL (CORRETO - 0 A 20 - SEM OPÃ‡ÃƒO FANTASMA)
# ----------------------------------------------------------------------------
show_menu_god() {
    while true; do
        clear
        echo -e "${COLOR_GOD}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${COLOR_GOD}â•‘              NICEHASH MINER ULTIMATE - TERMUX GOD MODE             â•‘${NC}"
        echo -e "${COLOR_GOD}â•‘                         $(date '+%d/%m/%Y %H:%M:%S')                         â•‘${NC}"
        echo -e "${COLOR_GOD}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo ""
        echo -e "${COLOR_WALLET}ðŸ‘› CARTEIRA NICEHASH:${NC} ${WALLET_NICEHASH:0:20}..."
        echo -e "${COLOR_DISCORD}ðŸ“¨ DISCORD:${NC} $( [ -n "$WEBHOOK_DISCORD" ] && echo "âœ…" || echo "âŒ" )"
        echo -e "${COLOR_POOL_AUTO}ðŸ¤– AUTO POOL:${NC} $(pgrep -f "pool_manager_god.sh" >/dev/null && echo "ATIVADA" || echo "DESATIVADA")"
        echo ""
        if pgrep -f xmrig >/dev/null; then
            echo -e "${COLOR_SUCCESS}â–¶ MINERAÃ‡ÃƒO: ${GREEN}ATIVA (MODO DEUS)${NC} | HASHRATE: $(get_current_hashrate_god) H/s | SATOSHIS: $(get_total_satoshis_god) sats${NC}"
            current_pool=$(grep "^POOL=" "$MINER_CONFIG/worker.info" 2>/dev/null | cut -d= -f2)
            current_pool_short=$(echo "$current_pool" | cut -d. -f1-2)
            current_latency=$(test_pool_latency "$current_pool")
            echo -e "   ðŸŒ POOL ATUAL: $current_pool_short (latÃªncia: ${current_latency}ms)"
        else
            echo -e "${COLOR_ERROR}â–¶ MINERAÃ‡ÃƒO: INATIVA${NC}"
        fi
        echo ""
        echo -e "${COLOR_MENU}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${COLOR_MENU}â•‘                            MENU PRINCIPAL - MODO DEUS              â•‘${NC}"
        echo -e "${COLOR_MENU}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£${NC}"
        echo -e "${COLOR_MENU}â•‘  1) ðŸš€  INICIAR MINERAÃ‡ÃƒO (Modo Deus)                              â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  2) ðŸ›‘  PARAR MINERAÃ‡ÃƒO                                             â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  3) ðŸ”„  REINICIAR MINERAÃ‡ÃƒO                                         â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  4) ðŸ“Š  STATUS COMPLETO DO SISTEMA                                 â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  5) ðŸ“ˆ  DASHBOARD EM TEMPO REAL                                     â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  6) ðŸ“  LOGS DE SATOSHIS                                            â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  7) ðŸ’°  GANHOS EM BITCOIN                                           â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  8) âš™ï¸   CONFIGURAÃ‡Ã•ES                                              â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  9) ðŸ”§  INSTALAR/ATUALIZAR XMRIG (60+ MÃ‰TODOS)                     â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 10) ðŸŒ  TROCAR POOL (MANUAL)                                        â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 11) ðŸ“¨  TESTAR WEBHOOK DISCORD                                      â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 12) ðŸ§¹  LIMPAR LOGS                                                â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 13) ðŸ’¾  BACKUP/RESTORE CONFIGURAÃ‡ÃƒO                                 â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 14) ðŸ“Š  RELATÃ“RIO DIÃRIO                                            â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 15) ðŸ¤–  ATIVAR/DESATIVAR TROCA AUTOMÃTICA DE POOL                  â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 16) ðŸ§ª  BENCHMARK DE CPU                                            â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 17) ðŸ”  DIAGNÃ“STICO DO SISTEMA                                     â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 18) ðŸŒ¿  ATIVAR MODO ECO                                             â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 19) âš¡  ATIVAR MODO TURBO                                           â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘ 20) ðŸ”¥  ATIVAR MODO DEUS                                            â•‘${NC}"
        echo -e "${COLOR_MENU}â•‘  0) ðŸšª  SAIR                                                        â•‘${NC}"
        echo -e "${COLOR_MENU}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo ""
        safe_read "Escolha uma opÃ§Ã£o (0-20): " choice

        choice=$(echo "$choice" | tr -cd '0-9')
        
        if [ -z "$choice" ]; then
            echo -e "${COLOR_ERROR}OpÃ§Ã£o invÃ¡lida! Digite um nÃºmero entre 0 e 20.${NC}"
            sleep 2
            continue
        fi

        case $choice in
            0)
                echo -e "${COLOR_SUCCESS}Encerrando NiceHash Miner God. AtÃ© logo, minerador divino!${NC}"
                discord_send "ðŸ›‘ **SISTEMA ENCERRADO - MODO DEUS** ðŸ›‘\n\nMineraÃ§Ã£o parada. AtÃ© a prÃ³xima!" "15158332" "ðŸ›‘ SISTEMA ENCERRADO"
                stop_mining_god
                exit 0
                ;;
            1) start_mining_god; safe_read "Pressione Enter..." dummy ;;
            2) stop_mining_god; safe_read "Pressione Enter..." dummy ;;
            3) restart_mining_god; safe_read "Pressione Enter..." dummy ;;
            4) show_full_status_god ;;
            5) realtime_dashboard_god ;;
            6) view_satoshi_logs_god ;;
            7) show_bitcoin_earnings_god ;;
            8) config_menu_god ;;
            9) install_xmrig_god; safe_read "Pressione Enter..." dummy ;;
            10) change_pool_manual_god ;;
            11) test_webhook_god ;;
            12) clear_logs_god ;;
            13) backup_menu_god ;;
            14) daily_report_god ;;
            15) toggle_auto_pool_god; safe_read "Pressione Enter..." dummy ;;
            16) benchmark_cpu_god ;;
            17) system_diagnostics_god ;;
            18) enable_eco_mode; safe_read "Pressione Enter..." dummy ;;
            19) enable_turbo_mode; safe_read "Pressione Enter..." dummy ;;
            20) enable_god_mode; safe_read "Pressione Enter..." dummy ;;
            *)
                echo -e "${COLOR_ERROR}OpÃ§Ã£o invÃ¡lida! Digite um nÃºmero entre 0 e 20.${NC}"
                sleep 2
                ;;
        esac
    done
}

# ----------------------------------------------------------------------------
# INICIALIZAÃ‡ÃƒO (NÃVEL DEUS)
# ----------------------------------------------------------------------------
if [ "$1" = "--source-only" ]; then
    return 0
fi

clear
echo -e "${COLOR_GOD}"
echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—"
echo "â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•"
echo "â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—"
echo "â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•šâ•â•â•â•â–ˆâ–ˆâ•‘"
echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘"
echo "â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•  â•šâ•â•â•â•  â•šâ•â•â•â•â•â•â•"
echo ""
echo -e "${COLOR_GOD}ðŸ”¥ NICEHASH MINER ULTIMATE - MODO DEUS v$SYSTEM_VERSION ðŸ”¥${NC}"
echo -e "${COLOR_POOL_AUTO}   âš¡ TROCA AUTOMÃTICA DE POOLS - 50+ POOLS NICEHASH - FALLBACK AUTOMÃTICO${NC}"
echo -e "${COLOR_SUCCESS}   ðŸ“¨ DISCORD CONFIGURADO - NOTIFICAÃ‡Ã•ES ATIVADAS${NC}"
echo -e "${COLOR_WALLET}   ðŸ‘› CARTEIRA: ${WALLET_NICEHASH}${NC}"
echo -e "${COLOR_GOD}   ðŸ”¥ MODO DEUS: PREPARADO PARA ATIVAÃ‡ÃƒO${NC}"
echo ""
sleep 2

if [ ! -d "/data/data/com.termux" ]; then
    echo -e "${COLOR_ERROR}Este script deve ser executado no Termux!${NC}"
    exit 1
fi

if ! ping -c 1 8.8.8.8 >/dev/null 2>&1; then
    log_warn "Sem conexÃ£o com a internet. Alguns recursos podem nÃ£o funcionar."
fi

log_sys "ðŸ”¥ Iniciando NiceHash Miner God v$SYSTEM_VERSION"
log_sys "Carteira: ${WALLET_NICEHASH:0:15}..."
discord_system_start

if [ ! -f "$MINER_BIN/xmrig" ]; then
    log_warn "XMRig nÃ£o encontrado. Use a opÃ§Ã£o 9 do menu para instalar."
fi

show_menu_god
